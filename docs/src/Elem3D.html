<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE BangPatterns #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE RecordWildCards #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE InstanceSigs #-}</span><span>
</span><span id="line-4"></span><span>
</span><span id="line-5"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Elem3D</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-6"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Binary</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Binary</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">get</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">put</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Debug.Trace</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">trace</span></span><span class="hs-special">)</span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Binary.Put</span></span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Binary</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Data.Binary.Get.Internal</span></span><span>
</span><span id="line-10"></span><span>
</span><span id="line-11"></span><span class="hs-comment">-- |Tipo b&#225;sico empleado por todo el c&#243;digo, este representa un punto en un espacio tridimensional, en su interior contiene un punto en el eje X otro en el Y e otro en el Z.</span><span>
</span><span id="line-12"></span><span class="hs-keyword">data</span><span> </span><span id="Point3D"><span class="annot"><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-var">Point3D</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Point3D"><span class="annot"><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-var">Point3D</span></a></span></span><span> </span><span class="hs-special">{</span><span id="xP"><span class="annot"><span class="annottext">Point3D -&gt; Float
</span><a href="Elem3D.html#xP"><span class="hs-identifier hs-var hs-var">xP</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span class="hs-special">,</span><span> </span><span id="yP"><span class="annot"><span class="annottext">Point3D -&gt; Float
</span><a href="Elem3D.html#yP"><span class="hs-identifier hs-var hs-var">yP</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span class="hs-special">,</span><span> </span><span id="zP"><span class="annot"><span class="annottext">Point3D -&gt; Float
</span><a href="Elem3D.html#zP"><span class="hs-identifier hs-var hs-var">zP</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679076076"><span id="local-6989586621679076081"><span class="annot"><span class="annottext">Point3D -&gt; Point3D -&gt; Bool
(Point3D -&gt; Point3D -&gt; Bool)
-&gt; (Point3D -&gt; Point3D -&gt; Bool) -&gt; Eq Point3D
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Point3D -&gt; Point3D -&gt; Bool
$c/= :: Point3D -&gt; Point3D -&gt; Bool
== :: Point3D -&gt; Point3D -&gt; Bool
$c== :: Point3D -&gt; Point3D -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- |Tipo b&#225;sico, representa una direcci&#243;n, de la misma forma que el punto contiene 3 valores en su interior, uno para cada eje.</span><span>
</span><span id="line-14"></span><span class="hs-keyword">data</span><span> </span><span id="Direction"><span class="annot"><a href="Elem3D.html#Direction"><span class="hs-identifier hs-var">Direction</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Direction"><span class="annot"><a href="Elem3D.html#Direction"><span class="hs-identifier hs-var">Direction</span></a></span></span><span> </span><span class="hs-special">{</span><span id="xD"><span class="annot"><span class="annottext">Direction -&gt; Float
</span><a href="Elem3D.html#xD"><span class="hs-identifier hs-var hs-var">xD</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span class="hs-special">,</span><span> </span><span id="yD"><span class="annot"><span class="annottext">Direction -&gt; Float
</span><a href="Elem3D.html#yD"><span class="hs-identifier hs-var hs-var">yD</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span class="hs-special">,</span><span> </span><span id="zD"><span class="annot"><span class="annottext">Direction -&gt; Float
</span><a href="Elem3D.html#zD"><span class="hs-identifier hs-var hs-var">zD</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679076064"><span id="local-6989586621679076069"><span class="annot"><span class="annottext">Direction -&gt; Direction -&gt; Bool
(Direction -&gt; Direction -&gt; Bool)
-&gt; (Direction -&gt; Direction -&gt; Bool) -&gt; Eq Direction
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Direction -&gt; Direction -&gt; Bool
$c/= :: Direction -&gt; Direction -&gt; Bool
== :: Direction -&gt; Direction -&gt; Bool
$c== :: Direction -&gt; Direction -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- |Tipo compuesto, representa un tayo, este se forma de su punto de origen y la direcci&#243;n en la que este se desplaza.</span><span>
</span><span id="line-16"></span><span class="hs-keyword">data</span><span> </span><span id="Ray"><span class="annot"><a href="Elem3D.html#Ray"><span class="hs-identifier hs-var">Ray</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Ray"><span class="annot"><a href="Elem3D.html#Ray"><span class="hs-identifier hs-var">Ray</span></a></span></span><span> </span><span class="hs-special">{</span><span id="oR"><span class="annot"><span class="annottext">Ray -&gt; Point3D
</span><a href="Elem3D.html#oR"><span class="hs-identifier hs-var hs-var">oR</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-type">Point3D</span></a></span><span class="hs-special">,</span><span> </span><span id="dR"><span class="annot"><span class="annottext">Ray -&gt; Direction
</span><a href="Elem3D.html#dR"><span class="hs-identifier hs-var hs-var">dR</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elem3D.html#Direction"><span class="hs-identifier hs-type">Direction</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-17"></span><span class="hs-comment">-- |Tipo compuesto, representa la base de un espacio, se conforma por 3 direcciones.</span><span>
</span><span id="line-18"></span><span class="hs-keyword">data</span><span> </span><span id="Base"><span class="annot"><a href="Elem3D.html#Base"><span class="hs-identifier hs-var">Base</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Base"><span class="annot"><a href="Elem3D.html#Base"><span class="hs-identifier hs-var">Base</span></a></span></span><span> </span><span class="hs-special">{</span><span id="d0"><span class="annot"><span class="annottext">Base -&gt; Direction
</span><a href="Elem3D.html#d0"><span class="hs-identifier hs-var hs-var">d0</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elem3D.html#Direction"><span class="hs-identifier hs-type">Direction</span></a></span><span class="hs-special">,</span><span> </span><span id="d1"><span class="annot"><span class="annottext">Base -&gt; Direction
</span><a href="Elem3D.html#d1"><span class="hs-identifier hs-var hs-var">d1</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elem3D.html#Direction"><span class="hs-identifier hs-type">Direction</span></a></span><span class="hs-special">,</span><span> </span><span id="d2"><span class="annot"><span class="annottext">Base -&gt; Direction
</span><a href="Elem3D.html#d2"><span class="hs-identifier hs-var hs-var">d2</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elem3D.html#Direction"><span class="hs-identifier hs-type">Direction</span></a></span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679076046"><span id="local-6989586621679076048"><span id="local-6989586621679076055"><span class="annot"><span class="annottext">Int -&gt; Base -&gt; ShowS
[Base] -&gt; ShowS
Base -&gt; String
(Int -&gt; Base -&gt; ShowS)
-&gt; (Base -&gt; String) -&gt; ([Base] -&gt; ShowS) -&gt; Show Base
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Base] -&gt; ShowS
$cshowList :: [Base] -&gt; ShowS
show :: Base -&gt; String
$cshow :: Base -&gt; String
showsPrec :: Int -&gt; Base -&gt; ShowS
$cshowsPrec :: Int -&gt; Base -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span class="hs-comment">-- |Tipo b&#225;sico, representa la tripleta de color RGB, la conforman por tres valores float(uno para cada canal de color) que pertenecen al rango [0,1]</span><span>
</span><span id="line-20"></span><span class="hs-keyword">data</span><span> </span><span id="RGB"><span class="annot"><a href="Elem3D.html#RGB"><span class="hs-identifier hs-var">RGB</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="RGB"><span class="annot"><a href="Elem3D.html#RGB"><span class="hs-identifier hs-var">RGB</span></a></span></span><span> </span><span class="hs-special">{</span><span id="red"><span class="annot"><span class="annottext">RGB -&gt; Float
</span><a href="Elem3D.html#red"><span class="hs-identifier hs-var hs-var">red</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span class="hs-special">,</span><span> </span><span id="green"><span class="annot"><span class="annottext">RGB -&gt; Float
</span><a href="Elem3D.html#green"><span class="hs-identifier hs-var hs-var">green</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span class="hs-special">,</span><span> </span><span id="blue"><span class="annot"><span class="annottext">RGB -&gt; Float
</span><a href="Elem3D.html#blue"><span class="hs-identifier hs-var hs-var">blue</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679076034"><span id="local-6989586621679076039"><span class="annot"><span class="annottext">RGB -&gt; RGB -&gt; Bool
(RGB -&gt; RGB -&gt; Bool) -&gt; (RGB -&gt; RGB -&gt; Bool) -&gt; Eq RGB
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: RGB -&gt; RGB -&gt; Bool
$c/= :: RGB -&gt; RGB -&gt; Bool
== :: RGB -&gt; RGB -&gt; Bool
$c== :: RGB -&gt; RGB -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span class="hs-comment">-- |Tipo compuesto, representa una fuente de luz, esta se encuentra en un punto del espacio por lo que tiene un punto3D, emite una cierta tonalidad de luz por lo que tiene un RGB y emite una cierta intensidad de luz por lo que tiene el Float.</span><span>
</span><span id="line-22"></span><span class="hs-keyword">data</span><span> </span><span id="Luz"><span class="annot"><a href="Elem3D.html#Luz"><span class="hs-identifier hs-var">Luz</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Luz"><span class="annot"><a href="Elem3D.html#Luz"><span class="hs-identifier hs-var">Luz</span></a></span></span><span> </span><span class="annot"><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-type">Point3D</span></a></span><span> </span><span class="annot"><a href="Elem3D.html#RGB"><span class="hs-identifier hs-type">RGB</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span>
</span><span id="line-23"></span><span class="hs-comment">-- |Tipo compuesto, representa una part&#237;cula de fot&#243;n, esta tiene un punto3D, una intensidad(float), una tonalidad(RGB), por &#250;ltimo tiene un id(Entero) para identificarlo.</span><span>
</span><span id="line-24"></span><span class="hs-keyword">data</span><span> </span><span id="Foton"><span class="annot"><a href="Elem3D.html#Foton"><span class="hs-identifier hs-var">Foton</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Foton"><span class="annot"><a href="Elem3D.html#Foton"><span class="hs-identifier hs-var">Foton</span></a></span></span><span> </span><span class="hs-special">{</span><span id="pFot"><span class="annot"><span class="annottext">Foton -&gt; Point3D
</span><a href="Elem3D.html#pFot"><span class="hs-identifier hs-var hs-var">pFot</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-type">Point3D</span></a></span><span class="hs-special">,</span><span> </span><span id="iFot"><span class="annot"><span class="annottext">Foton -&gt; Float
</span><a href="Elem3D.html#iFot"><span class="hs-identifier hs-var hs-var">iFot</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span class="hs-special">,</span><span> </span><span id="rgbFot"><span class="annot"><span class="annottext">Foton -&gt; RGB
</span><a href="Elem3D.html#rgbFot"><span class="hs-identifier hs-var hs-var">rgbFot</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elem3D.html#RGB"><span class="hs-identifier hs-type">RGB</span></a></span><span class="hs-special">,</span><span> </span><span id="idFot"><span class="annot"><span class="annottext">Foton -&gt; Int
</span><a href="Elem3D.html#idFot"><span class="hs-identifier hs-var hs-var">idFot</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">}</span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679076023"><span class="annot"><span class="hs-identifier hs-type">Binary</span></span><span> </span><span class="annot"><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-type">Point3D</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-27"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">put</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-type">Point3D</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Data.Binary.Put.Put</span></span><span>
</span><span id="line-28"></span><span>  </span><span id="local-6989586621679076014"><span class="annot"><span class="annottext">put :: Point3D -&gt; Put
</span><a href="#local-6989586621679076014"><span class="hs-identifier hs-var hs-var hs-var hs-var">put</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-type">Point3D</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679076011"><span id="local-6989586621679076012"><span id="local-6989586621679076013"><span class="annot"><span class="annottext">Float
zP :: Float
yP :: Float
xP :: Float
zP :: Point3D -&gt; Float
yP :: Point3D -&gt; Float
xP :: Point3D -&gt; Float
</span><a href="#local-6989586621679076011"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Put
forall t. Binary t =&gt; t -&gt; Put
</span><span class="hs-identifier hs-var">put</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679076013"><span class="hs-identifier hs-var">xP</span></a></span><span> </span><span class="annot"><span class="annottext">Put -&gt; Put -&gt; Put
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Put
forall t. Binary t =&gt; t -&gt; Put
</span><span class="hs-identifier hs-var">put</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679076012"><span class="hs-identifier hs-var">yP</span></a></span><span> </span><span class="annot"><span class="annottext">Put -&gt; Put -&gt; Put
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Put
forall t. Binary t =&gt; t -&gt; Put
</span><span class="hs-identifier hs-var">put</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679076011"><span class="hs-identifier hs-var">zP</span></a></span><span>
</span><span id="line-29"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">get</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Data.Binary.Get.Internal.Get</span></span><span> </span><span class="annot"><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-type">Point3D</span></a></span><span>
</span><span id="line-30"></span><span>  </span><span id="local-6989586621679076002"><span class="annot"><span class="annottext">get :: Get Point3D
</span><a href="#local-6989586621679076002"><span class="hs-identifier hs-var hs-var hs-var hs-var">get</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-31"></span><span>    </span><span id="local-6989586621679076001"><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679076001"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get Float
forall t. Binary t =&gt; Get t
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-32"></span><span>    </span><span id="local-6989586621679076000"><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679076000"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get Float
forall t. Binary t =&gt; Get t
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-33"></span><span>    </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float -&gt; Point3D
</span><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-var">Point3D</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679076001"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679076000"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">(Float -&gt; Point3D) -&gt; Get Float -&gt; Get Point3D
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Get Float
forall t. Binary t =&gt; Get t
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679075995"><span class="annot"><span class="hs-identifier hs-type">Binary</span></span><span> </span><span class="annot"><a href="Elem3D.html#Direction"><span class="hs-identifier hs-type">Direction</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-36"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">put</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elem3D.html#Direction"><span class="hs-identifier hs-type">Direction</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Data.Binary.Get.Internal.Put</span></span><span>
</span><span id="line-37"></span><span>  </span><span id="local-6989586621679075989"><span class="annot"><span class="annottext">put :: Direction -&gt; Put
</span><a href="#local-6989586621679075989"><span class="hs-identifier hs-var hs-var hs-var hs-var">put</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elem3D.html#Direction"><span class="hs-identifier hs-type">Direction</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679075986"><span id="local-6989586621679075987"><span id="local-6989586621679075988"><span class="annot"><span class="annottext">Float
zD :: Float
yD :: Float
xD :: Float
zD :: Direction -&gt; Float
yD :: Direction -&gt; Float
xD :: Direction -&gt; Float
</span><a href="#local-6989586621679075986"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Put
forall t. Binary t =&gt; t -&gt; Put
</span><span class="hs-identifier hs-var">put</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075988"><span class="hs-identifier hs-var">xD</span></a></span><span> </span><span class="annot"><span class="annottext">Put -&gt; Put -&gt; Put
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Put
forall t. Binary t =&gt; t -&gt; Put
</span><span class="hs-identifier hs-var">put</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075987"><span class="hs-identifier hs-var">yD</span></a></span><span> </span><span class="annot"><span class="annottext">Put -&gt; Put -&gt; Put
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Put
forall t. Binary t =&gt; t -&gt; Put
</span><span class="hs-identifier hs-var">put</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075986"><span class="hs-identifier hs-var">zD</span></a></span><span>
</span><span id="line-38"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">get</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Data.Binary.Get.Internal.Get</span></span><span> </span><span class="annot"><a href="Elem3D.html#Direction"><span class="hs-identifier hs-type">Direction</span></a></span><span>
</span><span id="line-39"></span><span>  </span><span id="local-6989586621679075979"><span class="annot"><span class="annottext">get :: Get Direction
</span><a href="#local-6989586621679075979"><span class="hs-identifier hs-var hs-var hs-var hs-var">get</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-40"></span><span>    </span><span id="local-6989586621679075978"><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075978"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get Float
forall t. Binary t =&gt; Get t
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-41"></span><span>    </span><span id="local-6989586621679075977"><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075977"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get Float
forall t. Binary t =&gt; Get t
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-42"></span><span>    </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float -&gt; Direction
</span><a href="Elem3D.html#Direction"><span class="hs-identifier hs-var">Direction</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075978"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075977"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">(Float -&gt; Direction) -&gt; Get Float -&gt; Get Direction
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Get Float
forall t. Binary t =&gt; Get t
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679075973"><span class="annot"><span class="hs-identifier hs-type">Binary</span></span><span> </span><span class="annot"><a href="Elem3D.html#RGB"><span class="hs-identifier hs-type">RGB</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-45"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">put</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elem3D.html#RGB"><span class="hs-identifier hs-type">RGB</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Data.Binary.Get.Internal.Put</span></span><span>
</span><span id="line-46"></span><span>  </span><span id="local-6989586621679075967"><span class="annot"><span class="annottext">put :: RGB -&gt; Put
</span><a href="#local-6989586621679075967"><span class="hs-identifier hs-var hs-var hs-var hs-var">put</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elem3D.html#RGB"><span class="hs-identifier hs-type">RGB</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679075964"><span id="local-6989586621679075965"><span id="local-6989586621679075966"><span class="annot"><span class="annottext">Float
blue :: Float
green :: Float
red :: Float
blue :: RGB -&gt; Float
green :: RGB -&gt; Float
red :: RGB -&gt; Float
</span><a href="#local-6989586621679075964"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Put
forall t. Binary t =&gt; t -&gt; Put
</span><span class="hs-identifier hs-var">put</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075966"><span class="hs-identifier hs-var">red</span></a></span><span> </span><span class="annot"><span class="annottext">Put -&gt; Put -&gt; Put
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Put
forall t. Binary t =&gt; t -&gt; Put
</span><span class="hs-identifier hs-var">put</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075965"><span class="hs-identifier hs-var">green</span></a></span><span> </span><span class="annot"><span class="annottext">Put -&gt; Put -&gt; Put
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Put
forall t. Binary t =&gt; t -&gt; Put
</span><span class="hs-identifier hs-var">put</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075964"><span class="hs-identifier hs-var">blue</span></a></span><span>
</span><span id="line-47"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">get</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Data.Binary.Get.Internal.Get</span></span><span> </span><span class="annot"><a href="Elem3D.html#RGB"><span class="hs-identifier hs-type">RGB</span></a></span><span>
</span><span id="line-48"></span><span>  </span><span id="local-6989586621679075957"><span class="annot"><span class="annottext">get :: Get RGB
</span><a href="#local-6989586621679075957"><span class="hs-identifier hs-var hs-var hs-var hs-var">get</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-49"></span><span>    </span><span id="local-6989586621679075956"><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075956"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get Float
forall t. Binary t =&gt; Get t
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-50"></span><span>    </span><span id="local-6989586621679075955"><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075955"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get Float
forall t. Binary t =&gt; Get t
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-51"></span><span>    </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float -&gt; RGB
</span><a href="Elem3D.html#RGB"><span class="hs-identifier hs-var">RGB</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075956"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075955"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">(Float -&gt; RGB) -&gt; Get Float -&gt; Get RGB
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Get Float
forall t. Binary t =&gt; Get t
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679075951"><span class="annot"><span class="hs-identifier hs-type">Binary</span></span><span> </span><span class="annot"><a href="Elem3D.html#Foton"><span class="hs-identifier hs-type">Foton</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-54"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">put</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elem3D.html#Foton"><span class="hs-identifier hs-type">Foton</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Data.Binary.Get.Internal.Put</span></span><span>
</span><span id="line-55"></span><span>  </span><span id="local-6989586621679075942"><span class="annot"><span class="annottext">put :: Foton -&gt; Put
</span><a href="#local-6989586621679075942"><span class="hs-identifier hs-var hs-var hs-var hs-var">put</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elem3D.html#Foton"><span class="hs-identifier hs-type">Foton</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679075938"><span id="local-6989586621679075939"><span id="local-6989586621679075940"><span id="local-6989586621679075941"><span class="annot"><span class="annottext">Float
Int
RGB
Point3D
idFot :: Int
rgbFot :: RGB
iFot :: Float
pFot :: Point3D
idFot :: Foton -&gt; Int
rgbFot :: Foton -&gt; RGB
iFot :: Foton -&gt; Float
pFot :: Foton -&gt; Point3D
</span><a href="#local-6989586621679075938"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point3D -&gt; Put
forall t. Binary t =&gt; t -&gt; Put
</span><span class="hs-identifier hs-var">put</span></span><span> </span><span class="annot"><span class="annottext">Point3D
</span><a href="#local-6989586621679075941"><span class="hs-identifier hs-var">pFot</span></a></span><span> </span><span class="annot"><span class="annottext">Put -&gt; Put -&gt; Put
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Put
forall t. Binary t =&gt; t -&gt; Put
</span><span class="hs-identifier hs-var">put</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075940"><span class="hs-identifier hs-var">iFot</span></a></span><span>  </span><span class="annot"><span class="annottext">Put -&gt; Put -&gt; Put
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">RGB -&gt; Put
forall t. Binary t =&gt; t -&gt; Put
</span><span class="hs-identifier hs-var">put</span></span><span> </span><span class="annot"><span class="annottext">RGB
</span><a href="#local-6989586621679075939"><span class="hs-identifier hs-var">rgbFot</span></a></span><span> </span><span class="annot"><span class="annottext">Put -&gt; Put -&gt; Put
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Put
forall t. Binary t =&gt; t -&gt; Put
</span><span class="hs-identifier hs-var">put</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679075938"><span class="hs-identifier hs-var">idFot</span></a></span><span>
</span><span id="line-56"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">get</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Data.Binary.Get.Internal.Get</span></span><span> </span><span class="annot"><a href="Elem3D.html#Foton"><span class="hs-identifier hs-type">Foton</span></a></span><span>
</span><span id="line-57"></span><span>  </span><span id="local-6989586621679075929"><span class="annot"><span class="annottext">get :: Get Foton
</span><a href="#local-6989586621679075929"><span class="hs-identifier hs-var hs-var hs-var hs-var">get</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-58"></span><span>    </span><span id="local-6989586621679075928"><span class="annot"><span class="annottext">Point3D
</span><a href="#local-6989586621679075928"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get Point3D
forall t. Binary t =&gt; Get t
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-59"></span><span>    </span><span id="local-6989586621679075927"><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075927"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get Float
forall t. Binary t =&gt; Get t
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-60"></span><span>    </span><span id="local-6989586621679075926"><span class="annot"><span class="annottext">RGB
</span><a href="#local-6989586621679075926"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get RGB
forall t. Binary t =&gt; Get t
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-61"></span><span>    </span><span class="annot"><span class="annottext">Point3D -&gt; Float -&gt; RGB -&gt; Int -&gt; Foton
</span><a href="Elem3D.html#Foton"><span class="hs-identifier hs-var">Foton</span></a></span><span> </span><span class="annot"><span class="annottext">Point3D
</span><a href="#local-6989586621679075928"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075927"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">RGB
</span><a href="#local-6989586621679075926"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Foton) -&gt; Get Int -&gt; Get Foton
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Get Int
forall t. Binary t =&gt; Get t
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679075921"><span id="local-6989586621679075924"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-type">Point3D</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-64"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">show</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-type">Point3D</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-65"></span><span>    </span><span id="local-6989586621679075915"><span class="annot"><span class="annottext">show :: Point3D -&gt; String
</span><a href="#local-6989586621679075915"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-type">Point3D</span></a></span><span class="hs-special">{</span><span id="local-6989586621679075912"><span id="local-6989586621679075913"><span id="local-6989586621679075914"><span class="annot"><span class="annottext">Float
zP :: Float
yP :: Float
xP :: Float
zP :: Point3D -&gt; Float
yP :: Point3D -&gt; Float
xP :: Point3D -&gt; Float
</span><a href="#local-6989586621679075912"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Point3D &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Float -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075914"><span class="hs-identifier hs-var">xP</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Float -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075913"><span class="hs-identifier hs-var">yP</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Float -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075912"><span class="hs-identifier hs-var">zP</span></a></span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679075907"><span id="local-6989586621679075910"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="Elem3D.html#Direction"><span class="hs-identifier hs-type">Direction</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-68"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">show</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elem3D.html#Direction"><span class="hs-identifier hs-type">Direction</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-69"></span><span>    </span><span id="local-6989586621679075903"><span class="annot"><span class="annottext">show :: Direction -&gt; String
</span><a href="#local-6989586621679075903"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elem3D.html#Direction"><span class="hs-identifier hs-type">Direction</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679075900"><span id="local-6989586621679075901"><span id="local-6989586621679075902"><span class="annot"><span class="annottext">Float
zD :: Float
yD :: Float
xD :: Float
zD :: Direction -&gt; Float
yD :: Direction -&gt; Float
xD :: Direction -&gt; Float
</span><a href="#local-6989586621679075900"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Direction &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Float -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075902"><span class="hs-identifier hs-var">xD</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Float -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075901"><span class="hs-identifier hs-var">yD</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Float -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075900"><span class="hs-identifier hs-var">zD</span></a></span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679075895"><span id="local-6989586621679075898"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="Elem3D.html#Ray"><span class="hs-identifier hs-type">Ray</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-72"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">show</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elem3D.html#Ray"><span class="hs-identifier hs-type">Ray</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-73"></span><span>    </span><span id="local-6989586621679075893"><span class="annot"><span class="annottext">show :: Ray -&gt; String
</span><a href="#local-6989586621679075893"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elem3D.html#Ray"><span class="hs-identifier hs-type">Ray</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679075891"><span id="local-6989586621679075892"><span class="annot"><span class="annottext">Direction
Point3D
dR :: Direction
oR :: Point3D
dR :: Ray -&gt; Direction
oR :: Ray -&gt; Point3D
</span><a href="#local-6989586621679075891"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Rayo hasta &quot;</span></span><span>  </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Direction -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679075891"><span class="hs-identifier hs-var">dR</span></a></span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679075886"><span id="local-6989586621679075889"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="Elem3D.html#RGB"><span class="hs-identifier hs-type">RGB</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-76"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">show</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elem3D.html#RGB"><span class="hs-identifier hs-type">RGB</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-77"></span><span>    </span><span id="local-6989586621679075882"><span class="annot"><span class="annottext">show :: RGB -&gt; String
</span><a href="#local-6989586621679075882"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elem3D.html#RGB"><span class="hs-identifier hs-type">RGB</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679075879"><span id="local-6989586621679075880"><span id="local-6989586621679075881"><span class="annot"><span class="annottext">Float
blue :: Float
green :: Float
red :: Float
blue :: RGB -&gt; Float
green :: RGB -&gt; Float
red :: RGB -&gt; Float
</span><a href="#local-6989586621679075879"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;R &quot;</span></span><span>  </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Float -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075881"><span class="hs-identifier hs-var">red</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; G &quot;</span></span><span>  </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Float -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075880"><span class="hs-identifier hs-var">green</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; B &quot;</span></span><span>  </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Float -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075879"><span class="hs-identifier hs-var">blue</span></a></span><span>
</span><span id="line-78"></span><span>
</span><span id="line-79"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679075874"><span id="local-6989586621679075877"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="Elem3D.html#Foton"><span class="hs-identifier hs-type">Foton</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-80"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">show</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elem3D.html#Foton"><span class="hs-identifier hs-type">Foton</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-81"></span><span>    </span><span id="local-6989586621679075868"><span class="annot"><span class="annottext">show :: Foton -&gt; String
</span><a href="#local-6989586621679075868"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elem3D.html#Foton"><span class="hs-identifier hs-type">Foton</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679075864"><span id="local-6989586621679075865"><span id="local-6989586621679075866"><span id="local-6989586621679075867"><span class="annot"><span class="annottext">Float
Int
RGB
Point3D
idFot :: Int
rgbFot :: RGB
iFot :: Float
pFot :: Point3D
idFot :: Foton -&gt; Int
rgbFot :: Foton -&gt; RGB
iFot :: Foton -&gt; Float
pFot :: Foton -&gt; Point3D
</span><a href="#local-6989586621679075864"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Foton &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Float -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point3D -&gt; Float
</span><a href="Elem3D.html#xP"><span class="hs-identifier hs-var hs-var">xP</span></a></span><span> </span><span class="annot"><span class="annottext">Point3D
</span><a href="#local-6989586621679075867"><span class="hs-identifier hs-var">pFot</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Float -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point3D -&gt; Float
</span><a href="Elem3D.html#yP"><span class="hs-identifier hs-var hs-var">yP</span></a></span><span> </span><span class="annot"><span class="annottext">Point3D
</span><a href="#local-6989586621679075867"><span class="hs-identifier hs-var">pFot</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Float -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point3D -&gt; Float
</span><a href="Elem3D.html#zP"><span class="hs-identifier hs-var hs-var">zP</span></a></span><span> </span><span class="annot"><span class="annottext">Point3D
</span><a href="#local-6989586621679075867"><span class="hs-identifier hs-var">pFot</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Float -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075866"><span class="hs-identifier hs-var">iFot</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">RGB -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">RGB
</span><a href="#local-6989586621679075865"><span class="hs-identifier hs-var">rgbFot</span></a></span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Elem3D.html#roundTo"><span class="hs-pragma hs-type">roundTo</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-85"></span><span class="hs-comment">-- |Funci&#243;n auxiliar, redondea los valores de las posiciones de un punto hasta n d&#237;gitos.</span><span>
</span><span id="line-86"></span><span class="annot"><a href="Elem3D.html#roundTo"><span class="hs-identifier hs-type">roundTo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-type">Point3D</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-type">Point3D</span></a></span><span>
</span><span id="line-87"></span><span id="roundTo"><span class="annot"><span class="annottext">roundTo :: Int -&gt; Point3D -&gt; Point3D
</span><a href="Elem3D.html#roundTo"><span class="hs-identifier hs-var hs-var">roundTo</span></a></span></span><span> </span><span id="local-6989586621679075862"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679075862"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-type">Point3D</span></a></span><span> </span><span id="local-6989586621679075861"><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075861"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679075860"><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075860"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679075859"><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075859"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float -&gt; Point3D
</span><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-var">Point3D</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075858"><span class="hs-identifier hs-var">a'</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075857"><span class="hs-identifier hs-var">b'</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075856"><span class="hs-identifier hs-var">c'</span></a></span><span>
</span><span id="line-88"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-89"></span><span>        </span><span class="hs-glyph">!</span><span id="local-6989586621679075858"><span class="annot"><span class="annottext">a' :: Float
</span><a href="#local-6989586621679075858"><span class="hs-identifier hs-var hs-var">a'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Float
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Float) -&gt; Integer -&gt; Float
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Integer
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">round</span></span><span> </span><span class="annot"><span class="annottext">(Float -&gt; Integer) -&gt; Float -&gt; Integer
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075861"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">10</span></span><span class="annot"><span class="annottext">Float -&gt; Int -&gt; Float
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679075862"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">10.0</span></span><span class="annot"><span class="annottext">Float -&gt; Int -&gt; Float
forall a b. (Fractional a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^^</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679075862"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span>
</span><span id="line-90"></span><span>        </span><span class="hs-glyph">!</span><span id="local-6989586621679075857"><span class="annot"><span class="annottext">b' :: Float
</span><a href="#local-6989586621679075857"><span class="hs-identifier hs-var hs-var">b'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Float
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Float) -&gt; Integer -&gt; Float
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Integer
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">round</span></span><span> </span><span class="annot"><span class="annottext">(Float -&gt; Integer) -&gt; Float -&gt; Integer
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075860"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">10</span></span><span class="annot"><span class="annottext">Float -&gt; Int -&gt; Float
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679075862"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">10.0</span></span><span class="annot"><span class="annottext">Float -&gt; Int -&gt; Float
forall a b. (Fractional a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^^</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679075862"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span>
</span><span id="line-91"></span><span>        </span><span class="hs-glyph">!</span><span id="local-6989586621679075856"><span class="annot"><span class="annottext">c' :: Float
</span><a href="#local-6989586621679075856"><span class="hs-identifier hs-var hs-var">c'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Float
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Float) -&gt; Integer -&gt; Float
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Integer
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">round</span></span><span> </span><span class="annot"><span class="annottext">(Float -&gt; Integer) -&gt; Float -&gt; Integer
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075859"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">10</span></span><span class="annot"><span class="annottext">Float -&gt; Int -&gt; Float
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679075862"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">10.0</span></span><span class="annot"><span class="annottext">Float -&gt; Int -&gt; Float
forall a b. (Fractional a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^^</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679075862"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span class="hs-comment">-- ************************************************</span><span>
</span><span id="line-94"></span><span class="hs-comment">-- Angulos y transformaciones</span><span>
</span><span id="line-95"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Elem3D.html#radToDeg"><span class="hs-pragma hs-type">radToDeg</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-96"></span><span class="hs-comment">-- |Funci&#243;n auxiliar, convierte de radianes a grados.</span><span>
</span><span id="line-97"></span><span class="annot"><a href="Elem3D.html#radToDeg"><span class="hs-identifier hs-type">radToDeg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span>
</span><span id="line-98"></span><span id="radToDeg"><span class="annot"><span class="annottext">radToDeg :: Float -&gt; Float
</span><a href="Elem3D.html#radToDeg"><span class="hs-identifier hs-var hs-var">radToDeg</span></a></span></span><span> </span><span id="local-6989586621679075813"><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075813"><span class="hs-identifier hs-var">radians</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075813"><span class="hs-identifier hs-var">radians</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">180.0</span></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Float
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Elem3D.html#degToRad"><span class="hs-pragma hs-type">degToRad</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-101"></span><span class="hs-comment">-- |Funci&#243;n auxiliar, convierte de grados a radianes.</span><span>
</span><span id="line-102"></span><span class="annot"><a href="Elem3D.html#degToRad"><span class="hs-identifier hs-type">degToRad</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span>
</span><span id="line-103"></span><span id="degToRad"><span class="annot"><span class="annottext">degToRad :: Float -&gt; Float
</span><a href="Elem3D.html#degToRad"><span class="hs-identifier hs-var hs-var">degToRad</span></a></span></span><span> </span><span id="local-6989586621679075810"><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075810"><span class="hs-identifier hs-var">degree</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075810"><span class="hs-identifier hs-var">degree</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">180.0</span></span><span class="hs-special">)</span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Elem3D.html#angleBetween"><span class="hs-pragma hs-type">angleBetween</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-106"></span><span class="hs-comment">-- |Funci&#243;n auxiliar, calcula el &#225;ngulo que forman 2 direcciones dadas.</span><span>
</span><span id="line-107"></span><span class="annot"><a href="Elem3D.html#angleBetween"><span class="hs-identifier hs-type">angleBetween</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elem3D.html#Direction"><span class="hs-identifier hs-type">Direction</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elem3D.html#Direction"><span class="hs-identifier hs-type">Direction</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span>
</span><span id="line-108"></span><span id="angleBetween"><span class="annot"><span class="annottext">angleBetween :: Direction -&gt; Direction -&gt; Float
</span><a href="Elem3D.html#angleBetween"><span class="hs-identifier hs-var hs-var">angleBetween</span></a></span></span><span> </span><span id="local-6989586621679075808"><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679075808"><span class="hs-identifier hs-var">d1</span></a></span></span><span> </span><span id="local-6989586621679075807"><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679075807"><span class="hs-identifier hs-var">d2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">acos</span></span><span> </span><span class="annot"><span class="annottext">(Float -&gt; Float) -&gt; Float -&gt; Float
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679075808"><span class="hs-identifier hs-var">d1</span></a></span><span> </span><span class="annot"><span class="annottext">Direction -&gt; Direction -&gt; Float
</span><a href="Elem3D.html#.%2A"><span class="hs-operator hs-var">.*</span></a></span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679075807"><span class="hs-identifier hs-var">d2</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Direction -&gt; Float
</span><a href="Elem3D.html#modd"><span class="hs-identifier hs-var">modd</span></a></span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679075808"><span class="hs-identifier hs-var">d1</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Direction -&gt; Float
</span><a href="Elem3D.html#modd"><span class="hs-identifier hs-var">modd</span></a></span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679075807"><span class="hs-identifier hs-var">d2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span class="hs-comment">-- ************************************************</span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span class="hs-comment">-----------------------------------------------------------------------------------------------------------------------------------------------</span><span>
</span><span id="line-113"></span><span class="hs-comment">--Puntos</span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span class="hs-comment">-- |Funci&#243;n auxiliar, rota un punto en uno de los ejes X Y Z, emplea radianes como unidad de rotaci&#243;n.</span><span>
</span><span id="line-116"></span><span class="annot"><a href="Elem3D.html#rotatePoint"><span class="hs-identifier hs-type">rotatePoint</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-type">Point3D</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-type">Point3D</span></a></span><span>
</span><span id="line-117"></span><span id="rotatePoint"><span class="annot"><span class="annottext">rotatePoint :: Char -&gt; Float -&gt; Point3D -&gt; Point3D
</span><a href="Elem3D.html#rotatePoint"><span class="hs-identifier hs-var hs-var">rotatePoint</span></a></span></span><span> </span><span id="local-6989586621679075802"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679075802"><span class="hs-identifier hs-var">axis</span></a></span></span><span> </span><span id="local-6989586621679075801"><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075801"><span class="hs-identifier hs-var">radiant</span></a></span></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-type">Point3D</span></a></span><span> </span><span id="local-6989586621679075800"><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075800"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679075799"><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075799"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span id="local-6989586621679075798"><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075798"><span class="hs-identifier hs-var">z</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075801"><span class="hs-identifier hs-var">radiant</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float -&gt; Point3D
</span><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-var">Point3D</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075800"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075799"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075798"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-119"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679075802"><span class="hs-identifier hs-var">axis</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'X'</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float -&gt; Point3D
</span><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-var">Point3D</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075800"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075797"><span class="hs-identifier hs-var">c</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075799"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075795"><span class="hs-identifier hs-var">s</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075798"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075795"><span class="hs-identifier hs-var">s</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075799"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075797"><span class="hs-identifier hs-var">c</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075798"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679075802"><span class="hs-identifier hs-var">axis</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'Y'</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float -&gt; Point3D
</span><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-var">Point3D</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075795"><span class="hs-identifier hs-var">s</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075798"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075797"><span class="hs-identifier hs-var">c</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075800"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075799"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075795"><span class="hs-identifier hs-var">s</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075800"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075797"><span class="hs-identifier hs-var">c</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075798"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679075802"><span class="hs-identifier hs-var">axis</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'Z'</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float -&gt; Point3D
</span><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-var">Point3D</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075797"><span class="hs-identifier hs-var">c</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075800"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075795"><span class="hs-identifier hs-var">s</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075799"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075795"><span class="hs-identifier hs-var">s</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075800"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075797"><span class="hs-identifier hs-var">c</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075799"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075798"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-122"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float -&gt; Point3D
</span><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-var">Point3D</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span>
</span><span id="line-123"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-124"></span><span>        </span><span class="hs-glyph">!</span><span id="local-6989586621679075797"><span class="annot"><span class="annottext">c :: Float
</span><a href="#local-6989586621679075797"><span class="hs-identifier hs-var hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">cos</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075801"><span class="hs-identifier hs-var">radiant</span></a></span><span>
</span><span id="line-125"></span><span>        </span><span class="hs-glyph">!</span><span id="local-6989586621679075795"><span class="annot"><span class="annottext">s :: Float
</span><a href="#local-6989586621679075795"><span class="hs-identifier hs-var hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sin</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075801"><span class="hs-identifier hs-var">radiant</span></a></span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span class="hs-comment">-- |Funci&#243;n b&#225;sica, rota un punto en uno de los ejes X Y Z, emplea grados como unidad de rotaci&#243;n.</span><span>
</span><span id="line-128"></span><span class="annot"><a href="Elem3D.html#rotatePointt"><span class="hs-identifier hs-type">rotatePointt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-type">Point3D</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-type">Point3D</span></a></span><span>
</span><span id="line-129"></span><span id="rotatePointt"><span class="annot"><span class="annottext">rotatePointt :: Char -&gt; Float -&gt; Point3D -&gt; Point3D
</span><a href="Elem3D.html#rotatePointt"><span class="hs-identifier hs-var hs-var">rotatePointt</span></a></span></span><span> </span><span id="local-6989586621679075789"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679075789"><span class="hs-identifier hs-var">axis</span></a></span></span><span> </span><span id="local-6989586621679075788"><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075788"><span class="hs-identifier hs-var">radiant</span></a></span></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-type">Point3D</span></a></span><span> </span><span id="local-6989586621679075787"><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075787"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679075786"><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075786"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span id="local-6989586621679075785"><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075785"><span class="hs-identifier hs-var">z</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-130"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075788"><span class="hs-identifier hs-var">radiant</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float -&gt; Point3D
</span><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-var">Point3D</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075787"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075786"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075785"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-131"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679075789"><span class="hs-identifier hs-var">axis</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'X'</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float -&gt; Point3D
</span><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-var">Point3D</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075787"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075784"><span class="hs-identifier hs-var">c</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075786"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075783"><span class="hs-identifier hs-var">s</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075785"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075783"><span class="hs-identifier hs-var">s</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075786"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075784"><span class="hs-identifier hs-var">c</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075785"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679075789"><span class="hs-identifier hs-var">axis</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'Y'</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float -&gt; Point3D
</span><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-var">Point3D</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075783"><span class="hs-identifier hs-var">s</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075785"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075784"><span class="hs-identifier hs-var">c</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075787"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075786"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075783"><span class="hs-identifier hs-var">s</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075787"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075784"><span class="hs-identifier hs-var">c</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075785"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679075789"><span class="hs-identifier hs-var">axis</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'Z'</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float -&gt; Point3D
</span><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-var">Point3D</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075784"><span class="hs-identifier hs-var">c</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075787"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075783"><span class="hs-identifier hs-var">s</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075786"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075783"><span class="hs-identifier hs-var">s</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075787"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075784"><span class="hs-identifier hs-var">c</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075786"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075785"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-134"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float -&gt; Point3D
</span><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-var">Point3D</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span>
</span><span id="line-135"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-136"></span><span>        </span><span class="hs-glyph">!</span><span id="local-6989586621679075784"><span class="annot"><span class="annottext">c :: Float
</span><a href="#local-6989586621679075784"><span class="hs-identifier hs-var hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">cos</span></span><span> </span><span class="annot"><span class="annottext">(Float -&gt; Float) -&gt; Float -&gt; Float
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float
</span><a href="Elem3D.html#degToRad"><span class="hs-identifier hs-var">degToRad</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075788"><span class="hs-identifier hs-var">radiant</span></a></span><span>
</span><span id="line-137"></span><span>        </span><span class="hs-glyph">!</span><span id="local-6989586621679075783"><span class="annot"><span class="annottext">s :: Float
</span><a href="#local-6989586621679075783"><span class="hs-identifier hs-var hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sin</span></span><span> </span><span class="annot"><span class="annottext">(Float -&gt; Float) -&gt; Float -&gt; Float
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float
</span><a href="Elem3D.html#degToRad"><span class="hs-identifier hs-var">degToRad</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075788"><span class="hs-identifier hs-var">radiant</span></a></span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span class="hs-comment">-- |Funci&#243;n de rotaci&#243;n inversa, deshace la rotaci&#243;n de un punto en uno de los ejes X Y Z, emplea radianes como unidad de rotaci&#243;n.</span><span>
</span><span id="line-140"></span><span class="annot"><a href="Elem3D.html#rotatePoint%27"><span class="hs-identifier hs-type">rotatePoint'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-type">Point3D</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-type">Point3D</span></a></span><span>
</span><span id="line-141"></span><span id="rotatePoint%27"><span class="annot"><span class="annottext">rotatePoint' :: Char -&gt; Float -&gt; Point3D -&gt; Point3D
</span><a href="Elem3D.html#rotatePoint%27"><span class="hs-identifier hs-var hs-var">rotatePoint'</span></a></span></span><span> </span><span id="local-6989586621679075779"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679075779"><span class="hs-identifier hs-var">axis</span></a></span></span><span> </span><span id="local-6989586621679075778"><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075778"><span class="hs-identifier hs-var">radiant</span></a></span></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-type">Point3D</span></a></span><span> </span><span id="local-6989586621679075777"><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075777"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679075776"><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075776"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span id="local-6989586621679075775"><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075775"><span class="hs-identifier hs-var">z</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-142"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075778"><span class="hs-identifier hs-var">radiant</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float -&gt; Point3D
</span><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-var">Point3D</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075777"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075776"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075775"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-143"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679075779"><span class="hs-identifier hs-var">axis</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'X'</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float -&gt; Point3D
</span><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-var">Point3D</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075777"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075774"><span class="hs-identifier hs-var">c</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075776"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075773"><span class="hs-identifier hs-var">s</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075775"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075773"><span class="hs-identifier hs-var">s</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075776"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075774"><span class="hs-identifier hs-var">c</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075775"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-144"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679075779"><span class="hs-identifier hs-var">axis</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'Y'</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float -&gt; Point3D
</span><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-var">Point3D</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075773"><span class="hs-identifier hs-var">s</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075775"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075774"><span class="hs-identifier hs-var">c</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075777"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075776"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075773"><span class="hs-identifier hs-var">s</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075777"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075774"><span class="hs-identifier hs-var">c</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075775"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679075779"><span class="hs-identifier hs-var">axis</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'Z'</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float -&gt; Point3D
</span><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-var">Point3D</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075774"><span class="hs-identifier hs-var">c</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075777"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075773"><span class="hs-identifier hs-var">s</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075776"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075773"><span class="hs-identifier hs-var">s</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075777"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075774"><span class="hs-identifier hs-var">c</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075776"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075775"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-146"></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float -&gt; Point3D
</span><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-var">Point3D</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span>
</span><span id="line-147"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-148"></span><span>        </span><span id="local-6989586621679075768"><span class="annot"><span class="annottext">radiant' :: Float
</span><a href="#local-6989586621679075768"><span class="hs-identifier hs-var hs-var">radiant'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Float
forall a. Floating a =&gt; a
</span><span class="hs-identifier hs-var">pi</span></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075778"><span class="hs-identifier hs-var">radiant</span></a></span><span>
</span><span id="line-149"></span><span>        </span><span id="local-6989586621679075774"><span class="annot"><span class="annottext">c :: Float
</span><a href="#local-6989586621679075774"><span class="hs-identifier hs-var hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">cos</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075778"><span class="hs-identifier hs-var">radiant</span></a></span><span>
</span><span id="line-150"></span><span>        </span><span id="local-6989586621679075773"><span class="annot"><span class="annottext">s :: Float
</span><a href="#local-6989586621679075773"><span class="hs-identifier hs-var hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sin</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075778"><span class="hs-identifier hs-var">radiant</span></a></span><span>
</span><span id="line-151"></span><span>
</span><span id="line-152"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Elem3D.html#movePoint"><span class="hs-pragma hs-type">movePoint</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-153"></span><span class="hs-comment">-- |Funci&#243;n b&#225;sica, aplica una direcci&#243;n a un punto para desplazarlo en el espacio.</span><span>
</span><span id="line-154"></span><span class="annot"><a href="Elem3D.html#movePoint"><span class="hs-identifier hs-type">movePoint</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elem3D.html#Direction"><span class="hs-identifier hs-type">Direction</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-type">Point3D</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-type">Point3D</span></a></span><span>
</span><span id="line-155"></span><span id="movePoint"><span class="annot"><span class="annottext">movePoint :: Direction -&gt; Point3D -&gt; Point3D
</span><a href="Elem3D.html#movePoint"><span class="hs-identifier hs-var hs-var">movePoint</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elem3D.html#Direction"><span class="hs-identifier hs-type">Direction</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679075762"><span id="local-6989586621679075763"><span id="local-6989586621679075764"><span class="annot"><span class="annottext">Float
zD :: Float
yD :: Float
xD :: Float
zD :: Direction -&gt; Float
yD :: Direction -&gt; Float
xD :: Direction -&gt; Float
</span><a href="#local-6989586621679075762"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-type">Point3D</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679075759"><span id="local-6989586621679075760"><span id="local-6989586621679075761"><span class="annot"><span class="annottext">Float
zP :: Float
yP :: Float
xP :: Float
zP :: Point3D -&gt; Float
yP :: Point3D -&gt; Float
xP :: Point3D -&gt; Float
</span><a href="#local-6989586621679075759"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float -&gt; Point3D
</span><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-var">Point3D</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075764"><span class="hs-identifier hs-var">xD</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075761"><span class="hs-identifier hs-var">xP</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075763"><span class="hs-identifier hs-var">yD</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075760"><span class="hs-identifier hs-var">yP</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075762"><span class="hs-identifier hs-var">zD</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075759"><span class="hs-identifier hs-var">zP</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Elem3D.html#movePoint%27"><span class="hs-pragma hs-type">movePoint'</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-158"></span><span class="hs-comment">-- |Funci&#243;n auxiliar, esta revierte el desplazamiento de una direcci&#243;n a un punto para desplazarlo en el espacio.</span><span>
</span><span id="line-159"></span><span class="annot"><a href="Elem3D.html#movePoint%27"><span class="hs-identifier hs-type">movePoint'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elem3D.html#Direction"><span class="hs-identifier hs-type">Direction</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-type">Point3D</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-type">Point3D</span></a></span><span>
</span><span id="line-160"></span><span id="movePoint%27"><span class="annot"><span class="annottext">movePoint' :: Direction -&gt; Point3D -&gt; Point3D
</span><a href="Elem3D.html#movePoint%27"><span class="hs-identifier hs-var hs-var">movePoint'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elem3D.html#Direction"><span class="hs-identifier hs-type">Direction</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679075755"><span id="local-6989586621679075756"><span id="local-6989586621679075757"><span class="annot"><span class="annottext">Float
zD :: Float
yD :: Float
xD :: Float
zD :: Direction -&gt; Float
yD :: Direction -&gt; Float
xD :: Direction -&gt; Float
</span><a href="#local-6989586621679075755"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-type">Point3D</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679075752"><span id="local-6989586621679075753"><span id="local-6989586621679075754"><span class="annot"><span class="annottext">Float
zP :: Float
yP :: Float
xP :: Float
zP :: Point3D -&gt; Float
yP :: Point3D -&gt; Float
xP :: Point3D -&gt; Float
</span><a href="#local-6989586621679075752"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float -&gt; Point3D
</span><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-var">Point3D</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075757"><span class="hs-identifier hs-var">xD</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075754"><span class="hs-identifier hs-var">xP</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075756"><span class="hs-identifier hs-var">yD</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075753"><span class="hs-identifier hs-var">yP</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075755"><span class="hs-identifier hs-var">zD</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075752"><span class="hs-identifier hs-var">zP</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Elem3D.html#distPoint"><span class="hs-pragma hs-type">distPoint</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-163"></span><span class="hs-comment">-- |Funci&#243;n b&#225;sica, c&#225;lcula la distancia real entre dos puntos en el espacio.</span><span>
</span><span id="line-164"></span><span class="annot"><a href="Elem3D.html#distPoint"><span class="hs-identifier hs-type">distPoint</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-type">Point3D</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-type">Point3D</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span>
</span><span id="line-165"></span><span id="distPoint"><span class="annot"><span class="annottext">distPoint :: Point3D -&gt; Point3D -&gt; Float
</span><a href="Elem3D.html#distPoint"><span class="hs-identifier hs-var hs-var">distPoint</span></a></span></span><span> </span><span id="local-6989586621679075750"><span class="annot"><span class="annottext">Point3D
</span><a href="#local-6989586621679075750"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679075749"><span class="annot"><span class="annottext">Point3D
</span><a href="#local-6989586621679075749"><span class="hs-identifier hs-var">p'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sqrt</span></span><span> </span><span class="annot"><span class="annottext">(Float -&gt; Float) -&gt; Float -&gt; Float
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point3D -&gt; Float
</span><a href="Elem3D.html#xP"><span class="hs-identifier hs-var hs-var">xP</span></a></span><span> </span><span class="annot"><span class="annottext">Point3D
</span><a href="#local-6989586621679075749"><span class="hs-identifier hs-var">p'</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Point3D -&gt; Float
</span><a href="Elem3D.html#xP"><span class="hs-identifier hs-var hs-var">xP</span></a></span><span> </span><span class="annot"><span class="annottext">Point3D
</span><a href="#local-6989586621679075750"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Floating a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">**</span></span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point3D -&gt; Float
</span><a href="Elem3D.html#yP"><span class="hs-identifier hs-var hs-var">yP</span></a></span><span> </span><span class="annot"><span class="annottext">Point3D
</span><a href="#local-6989586621679075749"><span class="hs-identifier hs-var">p'</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Point3D -&gt; Float
</span><a href="Elem3D.html#yP"><span class="hs-identifier hs-var hs-var">yP</span></a></span><span> </span><span class="annot"><span class="annottext">Point3D
</span><a href="#local-6989586621679075750"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Floating a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">**</span></span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point3D -&gt; Float
</span><a href="Elem3D.html#zP"><span class="hs-identifier hs-var hs-var">zP</span></a></span><span> </span><span class="annot"><span class="annottext">Point3D
</span><a href="#local-6989586621679075749"><span class="hs-identifier hs-var">p'</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Point3D -&gt; Float
</span><a href="Elem3D.html#zP"><span class="hs-identifier hs-var hs-var">zP</span></a></span><span> </span><span class="annot"><span class="annottext">Point3D
</span><a href="#local-6989586621679075750"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Floating a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">**</span></span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">2</span></span><span>
</span><span id="line-166"></span><span>
</span><span id="line-167"></span><span class="hs-comment">-- -- Resta de puntos -&gt; Direcci&#243;n del primero al segundo</span><span>
</span><span id="line-168"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">#</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-169"></span><span class="hs-comment">----------------------------------------------------------------------------------------------------------------------------------</span><span>
</span><span id="line-170"></span><span class="hs-comment">----------------------------------------------------------------------------------------------------------------------------------</span><span>
</span><span id="line-171"></span><span class="hs-comment">----------------------------------------------------------------------------------------------------------------------------------</span><span>
</span><span id="line-172"></span><span class="hs-comment">----------------------------------------------------------------------------------------------------------------------------------</span><span>
</span><span id="line-173"></span><span class="hs-comment">----------------------------------------------------------------------------------------------------------------------------------</span><span>
</span><span id="line-174"></span><span class="hs-comment">----------------------------------------------------------------------------------------------------------------------------------</span><span>
</span><span id="line-175"></span><span class="hs-comment">----------------------------------------------------------------------------------------------------------------------------------</span><span>
</span><span id="line-176"></span><span class="hs-comment">----------------------------------------------------------------------------------------------------------------------------------</span><span>
</span><span id="line-177"></span><span class="hs-comment">-- QUE ES ESTO</span><span>
</span><span id="line-178"></span><span class="hs-comment">-- |Funci&#243;n b&#225;sica, c&#225;lcula la direcci&#243;n del primer punto al segundo.</span><span>
</span><span id="line-179"></span><span class="annot"><a href="Elem3D.html#%23"><span class="hs-operator hs-type">(#)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-type">Point3D</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-type">Point3D</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-type">Point3D</span></a></span><span>
</span><span id="line-180"></span><span id="local-6989586621679075745"><span class="annot"><span class="annottext">Point3D
</span><a href="#local-6989586621679075745"><span class="hs-identifier hs-var">p'</span></a></span></span><span> </span><span id="%23"><span class="annot"><span class="annottext"># :: Point3D -&gt; Point3D -&gt; Point3D
</span><a href="Elem3D.html#%23"><span class="hs-operator hs-var hs-var">#</span></a></span></span><span> </span><span id="local-6989586621679075744"><span class="annot"><span class="annottext">Point3D
</span><a href="#local-6989586621679075744"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float -&gt; Point3D
</span><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-var">Point3D</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point3D -&gt; Float
</span><a href="Elem3D.html#xP"><span class="hs-identifier hs-var hs-var">xP</span></a></span><span> </span><span class="annot"><span class="annottext">Point3D
</span><a href="#local-6989586621679075745"><span class="hs-identifier hs-var">p'</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Point3D -&gt; Float
</span><a href="Elem3D.html#xP"><span class="hs-identifier hs-var hs-var">xP</span></a></span><span> </span><span class="annot"><span class="annottext">Point3D
</span><a href="#local-6989586621679075744"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point3D -&gt; Float
</span><a href="Elem3D.html#yP"><span class="hs-identifier hs-var hs-var">yP</span></a></span><span> </span><span class="annot"><span class="annottext">Point3D
</span><a href="#local-6989586621679075745"><span class="hs-identifier hs-var">p'</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Point3D -&gt; Float
</span><a href="Elem3D.html#yP"><span class="hs-identifier hs-var hs-var">yP</span></a></span><span> </span><span class="annot"><span class="annottext">Point3D
</span><a href="#local-6989586621679075744"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point3D -&gt; Float
</span><a href="Elem3D.html#zP"><span class="hs-identifier hs-var hs-var">zP</span></a></span><span> </span><span class="annot"><span class="annottext">Point3D
</span><a href="#local-6989586621679075745"><span class="hs-identifier hs-var">p'</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Point3D -&gt; Float
</span><a href="Elem3D.html#zP"><span class="hs-identifier hs-var hs-var">zP</span></a></span><span> </span><span class="annot"><span class="annottext">Point3D
</span><a href="#local-6989586621679075744"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Elem3D.html#addPoints"><span class="hs-pragma hs-type">addPoints</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-183"></span><span class="hs-comment">-- |Funci&#243;n auxiliar, suma de puntos.</span><span>
</span><span id="line-184"></span><span class="annot"><a href="Elem3D.html#addPoints"><span class="hs-identifier hs-type">addPoints</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-type">Point3D</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-type">Point3D</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-type">Point3D</span></a></span><span>
</span><span id="line-185"></span><span id="addPoints"><span class="annot"><span class="annottext">addPoints :: Point3D -&gt; Point3D -&gt; Point3D
</span><a href="Elem3D.html#addPoints"><span class="hs-identifier hs-var hs-var">addPoints</span></a></span></span><span> </span><span id="local-6989586621679075742"><span class="annot"><span class="annottext">Point3D
</span><a href="#local-6989586621679075742"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679075741"><span class="annot"><span class="annottext">Point3D
</span><a href="#local-6989586621679075741"><span class="hs-identifier hs-var">p'</span></a></span></span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float -&gt; Point3D
</span><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-var">Point3D</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point3D -&gt; Float
</span><a href="Elem3D.html#xP"><span class="hs-identifier hs-var hs-var">xP</span></a></span><span> </span><span class="annot"><span class="annottext">Point3D
</span><a href="#local-6989586621679075741"><span class="hs-identifier hs-var">p'</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Point3D -&gt; Float
</span><a href="Elem3D.html#xP"><span class="hs-identifier hs-var hs-var">xP</span></a></span><span> </span><span class="annot"><span class="annottext">Point3D
</span><a href="#local-6989586621679075742"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point3D -&gt; Float
</span><a href="Elem3D.html#yP"><span class="hs-identifier hs-var hs-var">yP</span></a></span><span> </span><span class="annot"><span class="annottext">Point3D
</span><a href="#local-6989586621679075741"><span class="hs-identifier hs-var">p'</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Point3D -&gt; Float
</span><a href="Elem3D.html#yP"><span class="hs-identifier hs-var hs-var">yP</span></a></span><span> </span><span class="annot"><span class="annottext">Point3D
</span><a href="#local-6989586621679075742"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point3D -&gt; Float
</span><a href="Elem3D.html#zP"><span class="hs-identifier hs-var hs-var">zP</span></a></span><span> </span><span class="annot"><span class="annottext">Point3D
</span><a href="#local-6989586621679075741"><span class="hs-identifier hs-var">p'</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Point3D -&gt; Float
</span><a href="Elem3D.html#zP"><span class="hs-identifier hs-var hs-var">zP</span></a></span><span> </span><span class="annot"><span class="annottext">Point3D
</span><a href="#local-6989586621679075742"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span>
</span><span id="line-188"></span><span class="hs-comment">-- -- Direccion entre puntos -&gt; Direcci&#243;n del primero al segundo</span><span>
</span><span id="line-189"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">#&lt;</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-190"></span><span class="hs-comment">-- |Funci&#243;n b&#225;sica, c&#225;lcula la direcci&#243;n del primer punto al segundo.</span><span>
</span><span id="line-191"></span><span class="annot"><a href="Elem3D.html#%23%3C"><span class="hs-operator hs-type">(#&lt;)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-type">Point3D</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-type">Point3D</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elem3D.html#Direction"><span class="hs-identifier hs-type">Direction</span></a></span><span>
</span><span id="line-192"></span><span id="local-6989586621679075739"><span class="annot"><span class="annottext">Point3D
</span><a href="#local-6989586621679075739"><span class="hs-identifier hs-var">p'</span></a></span></span><span> </span><span id="%23%3C"><span class="annot"><span class="annottext">#&lt; :: Point3D -&gt; Point3D -&gt; Direction
</span><a href="Elem3D.html#%23%3C"><span class="hs-operator hs-var hs-var">#&lt;</span></a></span></span><span> </span><span id="local-6989586621679075738"><span class="annot"><span class="annottext">Point3D
</span><a href="#local-6989586621679075738"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float -&gt; Direction
</span><a href="Elem3D.html#Direction"><span class="hs-identifier hs-var">Direction</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point3D -&gt; Float
</span><a href="Elem3D.html#xP"><span class="hs-identifier hs-var hs-var">xP</span></a></span><span> </span><span class="annot"><span class="annottext">Point3D
</span><a href="#local-6989586621679075739"><span class="hs-identifier hs-var">p'</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Point3D -&gt; Float
</span><a href="Elem3D.html#xP"><span class="hs-identifier hs-var hs-var">xP</span></a></span><span> </span><span class="annot"><span class="annottext">Point3D
</span><a href="#local-6989586621679075738"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point3D -&gt; Float
</span><a href="Elem3D.html#yP"><span class="hs-identifier hs-var hs-var">yP</span></a></span><span> </span><span class="annot"><span class="annottext">Point3D
</span><a href="#local-6989586621679075739"><span class="hs-identifier hs-var">p'</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Point3D -&gt; Float
</span><a href="Elem3D.html#yP"><span class="hs-identifier hs-var hs-var">yP</span></a></span><span> </span><span class="annot"><span class="annottext">Point3D
</span><a href="#local-6989586621679075738"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point3D -&gt; Float
</span><a href="Elem3D.html#zP"><span class="hs-identifier hs-var hs-var">zP</span></a></span><span> </span><span class="annot"><span class="annottext">Point3D
</span><a href="#local-6989586621679075739"><span class="hs-identifier hs-var">p'</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Point3D -&gt; Float
</span><a href="Elem3D.html#zP"><span class="hs-identifier hs-var hs-var">zP</span></a></span><span> </span><span class="annot"><span class="annottext">Point3D
</span><a href="#local-6989586621679075738"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-193"></span><span>
</span><span id="line-194"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Elem3D.html#aproxPoint"><span class="hs-pragma hs-type">aproxPoint</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-195"></span><span class="hs-comment">-- |Funci&#243;n b&#225;sica, dados dos puntos en el espacio comprueba si estos son aproximadamente(0.1 de error de posici&#243;n por eje) el mismo punto.</span><span>
</span><span id="line-196"></span><span class="annot"><a href="Elem3D.html#aproxPoint"><span class="hs-identifier hs-type">aproxPoint</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-type">Point3D</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-type">Point3D</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-197"></span><span id="aproxPoint"><span class="annot"><span class="annottext">aproxPoint :: Point3D -&gt; Point3D -&gt; Bool
</span><a href="Elem3D.html#aproxPoint"><span class="hs-identifier hs-var hs-var">aproxPoint</span></a></span></span><span> </span><span id="local-6989586621679075736"><span class="annot"><span class="annottext">Point3D
</span><a href="#local-6989586621679075736"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679075735"><span class="annot"><span class="annottext">Point3D
</span><a href="#local-6989586621679075735"><span class="hs-identifier hs-var">p'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679075734"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679075732"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679075731"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-198"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-199"></span><span>        </span><span class="hs-glyph">!</span><span id="local-6989586621679075734"><span class="annot"><span class="annottext">a :: Bool
</span><a href="#local-6989586621679075734"><span class="hs-identifier hs-var hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">abs</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point3D -&gt; Float
</span><a href="Elem3D.html#xP"><span class="hs-identifier hs-var hs-var">xP</span></a></span><span> </span><span class="annot"><span class="annottext">Point3D
</span><a href="#local-6989586621679075735"><span class="hs-identifier hs-var">p'</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Point3D -&gt; Float
</span><a href="Elem3D.html#xP"><span class="hs-identifier hs-var hs-var">xP</span></a></span><span> </span><span class="annot"><span class="annottext">Point3D
</span><a href="#local-6989586621679075736"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0.1</span></span><span>
</span><span id="line-200"></span><span>        </span><span class="hs-glyph">!</span><span id="local-6989586621679075732"><span class="annot"><span class="annottext">b :: Bool
</span><a href="#local-6989586621679075732"><span class="hs-identifier hs-var hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">abs</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point3D -&gt; Float
</span><a href="Elem3D.html#yP"><span class="hs-identifier hs-var hs-var">yP</span></a></span><span> </span><span class="annot"><span class="annottext">Point3D
</span><a href="#local-6989586621679075735"><span class="hs-identifier hs-var">p'</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Point3D -&gt; Float
</span><a href="Elem3D.html#yP"><span class="hs-identifier hs-var hs-var">yP</span></a></span><span> </span><span class="annot"><span class="annottext">Point3D
</span><a href="#local-6989586621679075736"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0.1</span></span><span>
</span><span id="line-201"></span><span>        </span><span class="hs-glyph">!</span><span id="local-6989586621679075731"><span class="annot"><span class="annottext">c :: Bool
</span><a href="#local-6989586621679075731"><span class="hs-identifier hs-var hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">abs</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point3D -&gt; Float
</span><a href="Elem3D.html#zP"><span class="hs-identifier hs-var hs-var">zP</span></a></span><span> </span><span class="annot"><span class="annottext">Point3D
</span><a href="#local-6989586621679075735"><span class="hs-identifier hs-var">p'</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Point3D -&gt; Float
</span><a href="Elem3D.html#zP"><span class="hs-identifier hs-var hs-var">zP</span></a></span><span> </span><span class="annot"><span class="annottext">Point3D
</span><a href="#local-6989586621679075736"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0.1</span></span><span>
</span><span id="line-202"></span><span>
</span><span id="line-203"></span><span class="hs-comment">-- -- -- Escalado de puntos</span><span>
</span><span id="line-204"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Elem3D.html#escalatePoint%27"><span class="hs-pragma hs-type">escalatePoint'</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-205"></span><span class="hs-comment">-- |Funci&#243;n auxiliar, revierte el proceso de escalar un punto.</span><span>
</span><span id="line-206"></span><span class="annot"><a href="Elem3D.html#escalatePoint%27"><span class="hs-identifier hs-type">escalatePoint'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-type">Point3D</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-type">Point3D</span></a></span><span>
</span><span id="line-207"></span><span id="escalatePoint%27"><span class="annot"><span class="annottext">escalatePoint' :: Float -&gt; Point3D -&gt; Point3D
</span><a href="Elem3D.html#escalatePoint%27"><span class="hs-identifier hs-var hs-var">escalatePoint'</span></a></span></span><span> </span><span id="local-6989586621679075714"><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075714"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-type">Point3D</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679075711"><span id="local-6989586621679075712"><span id="local-6989586621679075713"><span class="annot"><span class="annottext">Float
zP :: Float
yP :: Float
xP :: Float
zP :: Point3D -&gt; Float
yP :: Point3D -&gt; Float
xP :: Point3D -&gt; Float
</span><a href="#local-6989586621679075711"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float -&gt; Point3D
</span><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-var">Point3D</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075713"><span class="hs-identifier hs-var">xP</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075714"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075712"><span class="hs-identifier hs-var">yP</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075714"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075711"><span class="hs-identifier hs-var">zP</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075714"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span class="hs-comment">-- -- -- Escalado de puntos</span><span>
</span><span id="line-210"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Elem3D.html#escalatePoint"><span class="hs-pragma hs-type">escalatePoint</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-211"></span><span class="hs-comment">-- |Funci&#243;n b&#225;sica, reescala las dimensiones de un punto en el espacio.</span><span>
</span><span id="line-212"></span><span class="annot"><a href="Elem3D.html#escalatePoint"><span class="hs-identifier hs-type">escalatePoint</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-type">Point3D</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-type">Point3D</span></a></span><span>
</span><span id="line-213"></span><span id="escalatePoint"><span class="annot"><span class="annottext">escalatePoint :: Point3D -&gt; Float -&gt; Point3D
</span><a href="Elem3D.html#escalatePoint"><span class="hs-identifier hs-var hs-var">escalatePoint</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-type">Point3D</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679075707"><span id="local-6989586621679075708"><span id="local-6989586621679075709"><span class="annot"><span class="annottext">Float
zP :: Float
yP :: Float
xP :: Float
zP :: Point3D -&gt; Float
yP :: Point3D -&gt; Float
xP :: Point3D -&gt; Float
</span><a href="#local-6989586621679075707"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679075706"><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075706"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float -&gt; Point3D
</span><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-var">Point3D</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075706"><span class="hs-identifier hs-var">s</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075709"><span class="hs-identifier hs-var">xP</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075706"><span class="hs-identifier hs-var">s</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075708"><span class="hs-identifier hs-var">yP</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075706"><span class="hs-identifier hs-var">s</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075707"><span class="hs-identifier hs-var">zP</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-214"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Elem3D.html#escalatePointt"><span class="hs-pragma hs-type">escalatePointt</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-215"></span><span class="hs-comment">-- |Funci&#243;n b&#225;sica, reescala las dimensiones de un punto en el espacio.</span><span>
</span><span id="line-216"></span><span class="annot"><a href="Elem3D.html#escalatePointt"><span class="hs-identifier hs-type">escalatePointt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-type">Point3D</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-type">Point3D</span></a></span><span>
</span><span id="line-217"></span><span id="escalatePointt"><span class="annot"><span class="annottext">escalatePointt :: Float -&gt; Point3D -&gt; Point3D
</span><a href="Elem3D.html#escalatePointt"><span class="hs-identifier hs-var hs-var">escalatePointt</span></a></span></span><span> </span><span id="local-6989586621679075704"><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075704"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-type">Point3D</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679075701"><span id="local-6989586621679075702"><span id="local-6989586621679075703"><span class="annot"><span class="annottext">Float
zP :: Float
yP :: Float
xP :: Float
zP :: Point3D -&gt; Float
yP :: Point3D -&gt; Float
xP :: Point3D -&gt; Float
</span><a href="#local-6989586621679075701"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float -&gt; Point3D
</span><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-var">Point3D</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075704"><span class="hs-identifier hs-var">s</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075703"><span class="hs-identifier hs-var">xP</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075704"><span class="hs-identifier hs-var">s</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075702"><span class="hs-identifier hs-var">yP</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075704"><span class="hs-identifier hs-var">s</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075701"><span class="hs-identifier hs-var">zP</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Elem3D.html#pointDir"><span class="hs-pragma hs-type">pointDir</span></a></span><span class="hs-pragma">#-}</span><span>
</span><span id="line-220"></span><span class="hs-comment">-- |Funci&#243;n b&#225;sica, dado un punto traza una direcci&#243;n desde el origen(0,0,0) hasta dicho punto.</span><span>
</span><span id="line-221"></span><span class="annot"><a href="Elem3D.html#pointDir"><span class="hs-identifier hs-type">pointDir</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-type">Point3D</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elem3D.html#Direction"><span class="hs-identifier hs-type">Direction</span></a></span><span>
</span><span id="line-222"></span><span id="pointDir"><span class="annot"><span class="annottext">pointDir :: Point3D -&gt; Direction
</span><a href="Elem3D.html#pointDir"><span class="hs-identifier hs-var hs-var">pointDir</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-type">Point3D</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679075697"><span id="local-6989586621679075698"><span id="local-6989586621679075699"><span class="annot"><span class="annottext">Float
zP :: Float
yP :: Float
xP :: Float
zP :: Point3D -&gt; Float
yP :: Point3D -&gt; Float
xP :: Point3D -&gt; Float
</span><a href="#local-6989586621679075697"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float -&gt; Direction
</span><a href="Elem3D.html#Direction"><span class="hs-identifier hs-var">Direction</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075699"><span class="hs-identifier hs-var">xP</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075698"><span class="hs-identifier hs-var">yP</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075697"><span class="hs-identifier hs-var">zP</span></a></span><span>
</span><span id="line-223"></span><span>
</span><span id="line-224"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Elem3D.html#dirPoint"><span class="hs-pragma hs-type">dirPoint</span></a></span><span class="hs-pragma">#-}</span><span>
</span><span id="line-225"></span><span class="hs-comment">-- |Funci&#243;n b&#225;sica, dado una direcci&#243;n, la traza desde el origen(0,0,0) y devuelve el punto donde acaba.</span><span>
</span><span id="line-226"></span><span class="annot"><a href="Elem3D.html#dirPoint"><span class="hs-identifier hs-type">dirPoint</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elem3D.html#Direction"><span class="hs-identifier hs-type">Direction</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-type">Point3D</span></a></span><span>
</span><span id="line-227"></span><span id="dirPoint"><span class="annot"><span class="annottext">dirPoint :: Direction -&gt; Point3D
</span><a href="Elem3D.html#dirPoint"><span class="hs-identifier hs-var hs-var">dirPoint</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elem3D.html#Direction"><span class="hs-identifier hs-type">Direction</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679075693"><span id="local-6989586621679075694"><span id="local-6989586621679075695"><span class="annot"><span class="annottext">Float
zD :: Float
yD :: Float
xD :: Float
zD :: Direction -&gt; Float
yD :: Direction -&gt; Float
xD :: Direction -&gt; Float
</span><a href="#local-6989586621679075693"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float -&gt; Point3D
</span><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-var">Point3D</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075695"><span class="hs-identifier hs-var">xD</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075694"><span class="hs-identifier hs-var">yD</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075693"><span class="hs-identifier hs-var">zD</span></a></span><span>
</span><span id="line-228"></span><span>
</span><span id="line-229"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Elem3D.html#pointToPothon"><span class="hs-pragma hs-type">pointToPothon</span></a></span><span class="hs-pragma">#-}</span><span>
</span><span id="line-230"></span><span class="hs-comment">-- |Funci&#243;n auxiliar, dado un punto en el espacio, crea un foton &quot;vac&#237;o&quot; en este punto.</span><span>
</span><span id="line-231"></span><span class="annot"><a href="Elem3D.html#pointToPothon"><span class="hs-identifier hs-type">pointToPothon</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-type">Point3D</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elem3D.html#Foton"><span class="hs-identifier hs-type">Foton</span></a></span><span>
</span><span id="line-232"></span><span id="pointToPothon"><span class="annot"><span class="annottext">pointToPothon :: Point3D -&gt; Foton
</span><a href="Elem3D.html#pointToPothon"><span class="hs-identifier hs-var hs-var">pointToPothon</span></a></span></span><span> </span><span id="local-6989586621679075691"><span class="annot"><span class="annottext">Point3D
</span><a href="#local-6989586621679075691"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Point3D -&gt; Float -&gt; RGB -&gt; Int -&gt; Foton
</span><a href="Elem3D.html#Foton"><span class="hs-identifier hs-var">Foton</span></a></span><span> </span><span class="annot"><span class="annottext">Point3D
</span><a href="#local-6989586621679075691"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float -&gt; RGB
</span><a href="Elem3D.html#RGB"><span class="hs-identifier hs-var">RGB</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-233"></span><span>
</span><span id="line-234"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Elem3D.html#distFot"><span class="hs-pragma hs-type">distFot</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-235"></span><span class="hs-comment">-- |Funci&#243;n b&#225;sica, dados un punto y un fot&#243;n calcula la distancia real entre ambos.</span><span>
</span><span id="line-236"></span><span class="annot"><a href="Elem3D.html#distFot"><span class="hs-identifier hs-type">distFot</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-type">Point3D</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elem3D.html#Foton"><span class="hs-identifier hs-type">Foton</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span>
</span><span id="line-237"></span><span id="distFot"><span class="annot"><span class="annottext">distFot :: Point3D -&gt; Foton -&gt; Float
</span><a href="Elem3D.html#distFot"><span class="hs-identifier hs-var hs-var">distFot</span></a></span></span><span> </span><span id="local-6989586621679075689"><span class="annot"><span class="annottext">Point3D
</span><a href="#local-6989586621679075689"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679075688"><span class="annot"><span class="annottext">Foton
</span><a href="#local-6989586621679075688"><span class="hs-identifier hs-var">fot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">abs</span></span><span> </span><span class="annot"><span class="annottext">(Float -&gt; Float) -&gt; Float -&gt; Float
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Point3D
</span><a href="#local-6989586621679075689"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Point3D -&gt; Point3D -&gt; Float
</span><a href="Elem3D.html#distPoint"><span class="hs-operator hs-var">`distPoint`</span></a></span><span> </span><span class="annot"><span class="annottext">Foton -&gt; Point3D
</span><a href="Elem3D.html#pFot"><span class="hs-identifier hs-var hs-var">pFot</span></a></span><span> </span><span class="annot"><span class="annottext">Foton
</span><a href="#local-6989586621679075688"><span class="hs-identifier hs-var">fot</span></a></span><span>
</span><span id="line-238"></span><span>
</span><span id="line-239"></span><span class="hs-comment">------------------------------------------------------------------------------------------------------------------</span><span>
</span><span id="line-240"></span><span class="hs-comment">--Direcciones</span><span>
</span><span id="line-241"></span><span>
</span><span id="line-242"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679075683"><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="Elem3D.html#Direction"><span class="hs-identifier hs-type">Direction</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-243"></span><span class="hs-comment">-- Suma de direcciones</span><span>
</span><span id="line-244"></span><span> </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">+</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-245"></span><span> </span><span class="annot"><span class="hs-operator hs-type">(+)</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elem3D.html#Direction"><span class="hs-identifier hs-type">Direction</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elem3D.html#Direction"><span class="hs-identifier hs-type">Direction</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elem3D.html#Direction"><span class="hs-identifier hs-type">Direction</span></a></span><span>
</span><span id="line-246"></span><span> </span><span id="local-6989586621679075675"><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679075675"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679075674"><span class="annot"><span class="annottext">+ :: Direction -&gt; Direction -&gt; Direction
</span><a href="#local-6989586621679075674"><span class="hs-operator hs-var hs-var hs-var hs-var">+</span></a></span></span><span> </span><span id="local-6989586621679075673"><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679075673"><span class="hs-identifier hs-var">d'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float -&gt; Direction
</span><a href="Elem3D.html#Direction"><span class="hs-identifier hs-var">Direction</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Direction -&gt; Float
</span><a href="Elem3D.html#xD"><span class="hs-identifier hs-var hs-var">xD</span></a></span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679075675"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Direction -&gt; Float
</span><a href="Elem3D.html#xD"><span class="hs-identifier hs-var hs-var">xD</span></a></span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679075673"><span class="hs-identifier hs-var">d'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Direction -&gt; Float
</span><a href="Elem3D.html#yD"><span class="hs-identifier hs-var hs-var">yD</span></a></span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679075675"><span class="hs-identifier hs-var">d</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Direction -&gt; Float
</span><a href="Elem3D.html#yD"><span class="hs-identifier hs-var hs-var">yD</span></a></span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679075673"><span class="hs-identifier hs-var">d'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Direction -&gt; Float
</span><a href="Elem3D.html#zD"><span class="hs-identifier hs-var hs-var">zD</span></a></span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679075675"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Direction -&gt; Float
</span><a href="Elem3D.html#zD"><span class="hs-identifier hs-var hs-var">zD</span></a></span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679075673"><span class="hs-identifier hs-var">d'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-247"></span><span class="hs-comment">-- Resta de Direcciones</span><span>
</span><span id="line-248"></span><span> </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">-</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-249"></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elem3D.html#Direction"><span class="hs-identifier hs-type">Direction</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elem3D.html#Direction"><span class="hs-identifier hs-type">Direction</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elem3D.html#Direction"><span class="hs-identifier hs-type">Direction</span></a></span><span>
</span><span id="line-250"></span><span> </span><span id="local-6989586621679075669"><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679075669"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679075668"><span class="annot"><span class="annottext">- :: Direction -&gt; Direction -&gt; Direction
</span><span class="hs-glyph hs-var hs-var hs-var hs-var">-</span></span></span><span> </span><span id="local-6989586621679075667"><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679075667"><span class="hs-identifier hs-var">d'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float -&gt; Direction
</span><a href="Elem3D.html#Direction"><span class="hs-identifier hs-var">Direction</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Direction -&gt; Float
</span><a href="Elem3D.html#xD"><span class="hs-identifier hs-var hs-var">xD</span></a></span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679075669"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Direction -&gt; Float
</span><a href="Elem3D.html#xD"><span class="hs-identifier hs-var hs-var">xD</span></a></span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679075667"><span class="hs-identifier hs-var">d'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Direction -&gt; Float
</span><a href="Elem3D.html#yD"><span class="hs-identifier hs-var hs-var">yD</span></a></span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679075669"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Direction -&gt; Float
</span><a href="Elem3D.html#yD"><span class="hs-identifier hs-var hs-var">yD</span></a></span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679075667"><span class="hs-identifier hs-var">d'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Direction -&gt; Float
</span><a href="Elem3D.html#zD"><span class="hs-identifier hs-var hs-var">zD</span></a></span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679075669"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Direction -&gt; Float
</span><a href="Elem3D.html#zD"><span class="hs-identifier hs-var hs-var">zD</span></a></span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679075667"><span class="hs-identifier hs-var">d'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-251"></span><span>
</span><span id="line-252"></span><span> </span><span class="hs-comment">-- Producto vectorial</span><span>
</span><span id="line-253"></span><span> </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">*</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-254"></span><span> </span><span class="annot"><span class="hs-operator hs-type">(*)</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elem3D.html#Direction"><span class="hs-identifier hs-type">Direction</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elem3D.html#Direction"><span class="hs-identifier hs-type">Direction</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elem3D.html#Direction"><span class="hs-identifier hs-type">Direction</span></a></span><span>
</span><span id="line-255"></span><span> </span><span id="local-6989586621679075666"><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679075666"><span class="hs-identifier hs-var">dir0</span></a></span></span><span> </span><span id="local-6989586621679075665"><span class="annot"><span class="annottext">* :: Direction -&gt; Direction -&gt; Direction
</span><a href="#local-6989586621679075665"><span class="hs-operator hs-var hs-var hs-var hs-var">*</span></a></span></span><span> </span><span id="local-6989586621679075664"><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679075664"><span class="hs-identifier hs-var">dir1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float -&gt; Direction
</span><a href="Elem3D.html#Direction"><span class="hs-identifier hs-var">Direction</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075663"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075662"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075661"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-256"></span><span>     </span><span class="hs-keyword">where</span><span>
</span><span id="line-257"></span><span>        </span><span id="local-6989586621679075663"><span class="annot"><span class="annottext">x :: Float
</span><a href="#local-6989586621679075663"><span class="hs-identifier hs-var hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Direction -&gt; Float
</span><a href="Elem3D.html#yD"><span class="hs-identifier hs-var hs-var">yD</span></a></span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679075666"><span class="hs-identifier hs-var">dir0</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Direction -&gt; Float
</span><a href="Elem3D.html#zD"><span class="hs-identifier hs-var hs-var">zD</span></a></span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679075664"><span class="hs-identifier hs-var">dir1</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Direction -&gt; Float
</span><a href="Elem3D.html#zD"><span class="hs-identifier hs-var hs-var">zD</span></a></span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679075666"><span class="hs-identifier hs-var">dir0</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Direction -&gt; Float
</span><a href="Elem3D.html#yD"><span class="hs-identifier hs-var hs-var">yD</span></a></span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679075664"><span class="hs-identifier hs-var">dir1</span></a></span><span>
</span><span id="line-258"></span><span>        </span><span id="local-6989586621679075662"><span class="annot"><span class="annottext">y :: Float
</span><a href="#local-6989586621679075662"><span class="hs-identifier hs-var hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Direction -&gt; Float
</span><a href="Elem3D.html#zD"><span class="hs-identifier hs-var hs-var">zD</span></a></span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679075666"><span class="hs-identifier hs-var">dir0</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Direction -&gt; Float
</span><a href="Elem3D.html#xD"><span class="hs-identifier hs-var hs-var">xD</span></a></span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679075664"><span class="hs-identifier hs-var">dir1</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Direction -&gt; Float
</span><a href="Elem3D.html#xD"><span class="hs-identifier hs-var hs-var">xD</span></a></span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679075666"><span class="hs-identifier hs-var">dir0</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Direction -&gt; Float
</span><a href="Elem3D.html#zD"><span class="hs-identifier hs-var hs-var">zD</span></a></span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679075664"><span class="hs-identifier hs-var">dir1</span></a></span><span>
</span><span id="line-259"></span><span>        </span><span id="local-6989586621679075661"><span class="annot"><span class="annottext">z :: Float
</span><a href="#local-6989586621679075661"><span class="hs-identifier hs-var hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Direction -&gt; Float
</span><a href="Elem3D.html#xD"><span class="hs-identifier hs-var hs-var">xD</span></a></span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679075666"><span class="hs-identifier hs-var">dir0</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Direction -&gt; Float
</span><a href="Elem3D.html#yD"><span class="hs-identifier hs-var hs-var">yD</span></a></span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679075664"><span class="hs-identifier hs-var">dir1</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Direction -&gt; Float
</span><a href="Elem3D.html#yD"><span class="hs-identifier hs-var hs-var">yD</span></a></span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679075666"><span class="hs-identifier hs-var">dir0</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Direction -&gt; Float
</span><a href="Elem3D.html#xD"><span class="hs-identifier hs-var hs-var">xD</span></a></span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679075664"><span class="hs-identifier hs-var">dir1</span></a></span><span>
</span><span id="line-260"></span><span>
</span><span id="line-261"></span><span class="hs-comment">-- -- -- Producto escalar</span><span>
</span><span id="line-262"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">.*</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-263"></span><span class="hs-comment">-- |Funci&#243;n b&#225;sica, calcula el producto escalar de dos direcciones.</span><span>
</span><span id="line-264"></span><span class="annot"><a href="Elem3D.html#.%2A"><span class="hs-operator hs-type">(.*)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elem3D.html#Direction"><span class="hs-identifier hs-type">Direction</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elem3D.html#Direction"><span class="hs-identifier hs-type">Direction</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span>
</span><span id="line-265"></span><span id="local-6989586621679075651"><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679075651"><span class="hs-identifier hs-var">dir0</span></a></span></span><span> </span><span id=".%2A"><span class="annot"><span class="annottext">.* :: Direction -&gt; Direction -&gt; Float
</span><a href="Elem3D.html#.%2A"><span class="hs-operator hs-var hs-var">.*</span></a></span></span><span> </span><span id="local-6989586621679075650"><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679075650"><span class="hs-identifier hs-var">dir1</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Direction -&gt; Float
</span><a href="Elem3D.html#xD"><span class="hs-identifier hs-var hs-var">xD</span></a></span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679075651"><span class="hs-identifier hs-var">dir0</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Direction -&gt; Float
</span><a href="Elem3D.html#xD"><span class="hs-identifier hs-var hs-var">xD</span></a></span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679075650"><span class="hs-identifier hs-var">dir1</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Direction -&gt; Float
</span><a href="Elem3D.html#yD"><span class="hs-identifier hs-var hs-var">yD</span></a></span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679075651"><span class="hs-identifier hs-var">dir0</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Direction -&gt; Float
</span><a href="Elem3D.html#yD"><span class="hs-identifier hs-var hs-var">yD</span></a></span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679075650"><span class="hs-identifier hs-var">dir1</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Direction -&gt; Float
</span><a href="Elem3D.html#zD"><span class="hs-identifier hs-var hs-var">zD</span></a></span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679075651"><span class="hs-identifier hs-var">dir0</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Direction -&gt; Float
</span><a href="Elem3D.html#zD"><span class="hs-identifier hs-var hs-var">zD</span></a></span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679075650"><span class="hs-identifier hs-var">dir1</span></a></span><span>
</span><span id="line-266"></span><span>
</span><span id="line-267"></span><span class="hs-comment">-- -- -- Escalado de direcci&#243;n</span><span>
</span><span id="line-268"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Elem3D.html#escalateDir"><span class="hs-pragma hs-type">escalateDir</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-269"></span><span class="hs-comment">-- |Funci&#243;n b&#225;sica, reescala una direcci&#243;n.</span><span>
</span><span id="line-270"></span><span class="annot"><a href="Elem3D.html#escalateDir"><span class="hs-identifier hs-type">escalateDir</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elem3D.html#Direction"><span class="hs-identifier hs-type">Direction</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elem3D.html#Direction"><span class="hs-identifier hs-type">Direction</span></a></span><span>
</span><span id="line-271"></span><span id="escalateDir"><span class="annot"><span class="annottext">escalateDir :: Float -&gt; Direction -&gt; Direction
</span><a href="Elem3D.html#escalateDir"><span class="hs-identifier hs-var hs-var">escalateDir</span></a></span></span><span> </span><span id="local-6989586621679075648"><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075648"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elem3D.html#Direction"><span class="hs-identifier hs-type">Direction</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679075645"><span id="local-6989586621679075646"><span id="local-6989586621679075647"><span class="annot"><span class="annottext">Float
zD :: Float
yD :: Float
xD :: Float
zD :: Direction -&gt; Float
yD :: Direction -&gt; Float
xD :: Direction -&gt; Float
</span><a href="#local-6989586621679075645"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float -&gt; Direction
</span><a href="Elem3D.html#Direction"><span class="hs-identifier hs-var">Direction</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075648"><span class="hs-identifier hs-var">s</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075647"><span class="hs-identifier hs-var">xD</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075648"><span class="hs-identifier hs-var">s</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075646"><span class="hs-identifier hs-var">yD</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075648"><span class="hs-identifier hs-var">s</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075645"><span class="hs-identifier hs-var">zD</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-272"></span><span>
</span><span id="line-273"></span><span class="hs-comment">-- -- -- Escalado de direcci&#243;n</span><span>
</span><span id="line-274"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Elem3D.html#escalateDir%27"><span class="hs-pragma hs-type">escalateDir'</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-275"></span><span class="hs-comment">-- |Funci&#243;n auxiliar, deshace el reescalado de una direcci&#243;n.</span><span>
</span><span id="line-276"></span><span class="annot"><a href="Elem3D.html#escalateDir%27"><span class="hs-identifier hs-type">escalateDir'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elem3D.html#Direction"><span class="hs-identifier hs-type">Direction</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elem3D.html#Direction"><span class="hs-identifier hs-type">Direction</span></a></span><span>
</span><span id="line-277"></span><span id="escalateDir%27"><span class="annot"><span class="annottext">escalateDir' :: Float -&gt; Direction -&gt; Direction
</span><a href="Elem3D.html#escalateDir%27"><span class="hs-identifier hs-var hs-var">escalateDir'</span></a></span></span><span> </span><span id="local-6989586621679075643"><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075643"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elem3D.html#Direction"><span class="hs-identifier hs-type">Direction</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679075640"><span id="local-6989586621679075641"><span id="local-6989586621679075642"><span class="annot"><span class="annottext">Float
zD :: Float
yD :: Float
xD :: Float
zD :: Direction -&gt; Float
yD :: Direction -&gt; Float
xD :: Direction -&gt; Float
</span><a href="#local-6989586621679075640"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float -&gt; Direction
</span><a href="Elem3D.html#Direction"><span class="hs-identifier hs-var">Direction</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075642"><span class="hs-identifier hs-var">xD</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075643"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075641"><span class="hs-identifier hs-var">yD</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075643"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075640"><span class="hs-identifier hs-var">zD</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075643"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-278"></span><span>
</span><span id="line-279"></span><span class="hs-comment">-- -- Modulo</span><span>
</span><span id="line-280"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Elem3D.html#modd"><span class="hs-pragma hs-type">modd</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-281"></span><span class="hs-comment">-- |Funci&#243;n auxiliar, dada una direcci&#243;n calcula su m&#243;dulo.</span><span>
</span><span id="line-282"></span><span class="annot"><a href="Elem3D.html#modd"><span class="hs-identifier hs-type">modd</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elem3D.html#Direction"><span class="hs-identifier hs-type">Direction</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span>
</span><span id="line-283"></span><span id="modd"><span class="annot"><span class="annottext">modd :: Direction -&gt; Float
</span><a href="Elem3D.html#modd"><span class="hs-identifier hs-var hs-var">modd</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elem3D.html#Direction"><span class="hs-identifier hs-type">Direction</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679075637"><span id="local-6989586621679075638"><span id="local-6989586621679075639"><span class="annot"><span class="annottext">Float
zD :: Float
yD :: Float
xD :: Float
zD :: Direction -&gt; Float
yD :: Direction -&gt; Float
xD :: Direction -&gt; Float
</span><a href="#local-6989586621679075637"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sqrt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075639"><span class="hs-identifier hs-var">xD</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075639"><span class="hs-identifier hs-var">xD</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075638"><span class="hs-identifier hs-var">yD</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075638"><span class="hs-identifier hs-var">yD</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075637"><span class="hs-identifier hs-var">zD</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075637"><span class="hs-identifier hs-var">zD</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-284"></span><span>
</span><span id="line-285"></span><span class="hs-comment">-- Normalizaci&#243;n</span><span>
</span><span id="line-286"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Elem3D.html#normal"><span class="hs-pragma hs-type">normal</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-287"></span><span class="hs-comment">-- |Funci&#243;n auxiliar, dada una direcci&#243;n la normaliza.</span><span>
</span><span id="line-288"></span><span class="annot"><a href="Elem3D.html#normal"><span class="hs-identifier hs-type">normal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elem3D.html#Direction"><span class="hs-identifier hs-type">Direction</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elem3D.html#Direction"><span class="hs-identifier hs-type">Direction</span></a></span><span>
</span><span id="line-289"></span><span id="normal"><span class="annot"><span class="annottext">normal :: Direction -&gt; Direction
</span><a href="Elem3D.html#normal"><span class="hs-identifier hs-var hs-var">normal</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elem3D.html#Direction"><span class="hs-identifier hs-type">Direction</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679075633"><span id="local-6989586621679075634"><span id="local-6989586621679075635"><span class="annot"><span class="annottext">Float
zD :: Float
yD :: Float
xD :: Float
zD :: Direction -&gt; Float
yD :: Direction -&gt; Float
xD :: Direction -&gt; Float
</span><a href="#local-6989586621679075633"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679075624"><span class="annot"><span class="annottext">invLen :: Float
</span><a href="#local-6989586621679075624"><span class="hs-identifier hs-var hs-var">invLen</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">1.0</span></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sqrt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075635"><span class="hs-identifier hs-var">xD</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075635"><span class="hs-identifier hs-var">xD</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075634"><span class="hs-identifier hs-var">yD</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075634"><span class="hs-identifier hs-var">yD</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075633"><span class="hs-identifier hs-var">zD</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075633"><span class="hs-identifier hs-var">zD</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float -&gt; Direction
</span><a href="Elem3D.html#Direction"><span class="hs-identifier hs-var">Direction</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075635"><span class="hs-identifier hs-var">xD</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075624"><span class="hs-identifier hs-var">invLen</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075634"><span class="hs-identifier hs-var">yD</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075624"><span class="hs-identifier hs-var">invLen</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075633"><span class="hs-identifier hs-var">zD</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075624"><span class="hs-identifier hs-var">invLen</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-290"></span><span>
</span><span id="line-291"></span><span class="hs-comment">-----------------------------------------------------------------------------------------------------------------------------------------------</span><span>
</span><span id="line-292"></span><span class="hs-comment">--RGB</span><span>
</span><span id="line-293"></span><span>
</span><span id="line-294"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Elem3D.html#elevateRGBPoint"><span class="hs-pragma hs-type">elevateRGBPoint</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-295"></span><span class="hs-comment">-- |Funci&#243;n auxiliar, calcula el valor de un RGB elevado a 1/x.</span><span>
</span><span id="line-296"></span><span class="annot"><a href="Elem3D.html#elevateRGBPoint"><span class="hs-identifier hs-type">elevateRGBPoint</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elem3D.html#RGB"><span class="hs-identifier hs-type">RGB</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elem3D.html#RGB"><span class="hs-identifier hs-type">RGB</span></a></span><span>
</span><span id="line-297"></span><span id="elevateRGBPoint"><span class="annot"><span class="annottext">elevateRGBPoint :: Float -&gt; RGB -&gt; RGB
</span><a href="Elem3D.html#elevateRGBPoint"><span class="hs-identifier hs-var hs-var">elevateRGBPoint</span></a></span></span><span> </span><span id="local-6989586621679075622"><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075622"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elem3D.html#RGB"><span class="hs-identifier hs-type">RGB</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679075619"><span id="local-6989586621679075620"><span id="local-6989586621679075621"><span class="annot"><span class="annottext">Float
blue :: Float
green :: Float
red :: Float
blue :: RGB -&gt; Float
green :: RGB -&gt; Float
red :: RGB -&gt; Float
</span><a href="#local-6989586621679075619"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-298"></span><span>    </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float -&gt; RGB
</span><a href="Elem3D.html#RGB"><span class="hs-identifier hs-var">RGB</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075621"><span class="hs-identifier hs-var">red</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Floating a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">**</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">1.0</span></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075622"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-299"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075620"><span class="hs-identifier hs-var">green</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Floating a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">**</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">1.0</span></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075622"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-300"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075619"><span class="hs-identifier hs-var">blue</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Floating a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">**</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">1.0</span></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075622"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-301"></span><span>
</span><span id="line-302"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679075614"><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="Elem3D.html#RGB"><span class="hs-identifier hs-type">RGB</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-303"></span><span>
</span><span id="line-304"></span><span> </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">+</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-305"></span><span> </span><span class="annot"><span class="hs-operator hs-type">(+)</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elem3D.html#RGB"><span class="hs-identifier hs-type">RGB</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elem3D.html#RGB"><span class="hs-identifier hs-type">RGB</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elem3D.html#RGB"><span class="hs-identifier hs-type">RGB</span></a></span><span>
</span><span id="line-306"></span><span> </span><span id="local-6989586621679075607"><span class="annot"><span class="annottext">RGB
</span><a href="#local-6989586621679075607"><span class="hs-identifier hs-var">rgb</span></a></span></span><span> </span><span id="local-6989586621679075606"><span class="annot"><span class="annottext">+ :: RGB -&gt; RGB -&gt; RGB
</span><a href="#local-6989586621679075606"><span class="hs-operator hs-var hs-var hs-var hs-var">+</span></a></span></span><span> </span><span id="local-6989586621679075605"><span class="annot"><span class="annottext">RGB
</span><a href="#local-6989586621679075605"><span class="hs-identifier hs-var">rgb'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float -&gt; RGB
</span><a href="Elem3D.html#RGB"><span class="hs-identifier hs-var">RGB</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RGB -&gt; Float
</span><a href="Elem3D.html#red"><span class="hs-identifier hs-var hs-var">red</span></a></span><span> </span><span class="annot"><span class="annottext">RGB
</span><a href="#local-6989586621679075607"><span class="hs-identifier hs-var">rgb</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">RGB -&gt; Float
</span><a href="Elem3D.html#red"><span class="hs-identifier hs-var hs-var">red</span></a></span><span> </span><span class="annot"><span class="annottext">RGB
</span><a href="#local-6989586621679075605"><span class="hs-identifier hs-var">rgb'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RGB -&gt; Float
</span><a href="Elem3D.html#green"><span class="hs-identifier hs-var hs-var">green</span></a></span><span> </span><span class="annot"><span class="annottext">RGB
</span><a href="#local-6989586621679075607"><span class="hs-identifier hs-var">rgb</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">RGB -&gt; Float
</span><a href="Elem3D.html#green"><span class="hs-identifier hs-var hs-var">green</span></a></span><span> </span><span class="annot"><span class="annottext">RGB
</span><a href="#local-6989586621679075605"><span class="hs-identifier hs-var">rgb'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RGB -&gt; Float
</span><a href="Elem3D.html#blue"><span class="hs-identifier hs-var hs-var">blue</span></a></span><span> </span><span class="annot"><span class="annottext">RGB
</span><a href="#local-6989586621679075607"><span class="hs-identifier hs-var">rgb</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">RGB -&gt; Float
</span><a href="Elem3D.html#blue"><span class="hs-identifier hs-var hs-var">blue</span></a></span><span> </span><span class="annot"><span class="annottext">RGB
</span><a href="#local-6989586621679075605"><span class="hs-identifier hs-var">rgb'</span></a></span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-307"></span><span>
</span><span id="line-308"></span><span> </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">-</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-309"></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elem3D.html#RGB"><span class="hs-identifier hs-type">RGB</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elem3D.html#RGB"><span class="hs-identifier hs-type">RGB</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elem3D.html#RGB"><span class="hs-identifier hs-type">RGB</span></a></span><span>
</span><span id="line-310"></span><span> </span><span id="local-6989586621679075601"><span class="annot"><span class="annottext">RGB
</span><a href="#local-6989586621679075601"><span class="hs-identifier hs-var">rgb</span></a></span></span><span> </span><span id="local-6989586621679075600"><span class="annot"><span class="annottext">- :: RGB -&gt; RGB -&gt; RGB
</span><span class="hs-glyph hs-var hs-var hs-var hs-var">-</span></span></span><span> </span><span id="local-6989586621679075599"><span class="annot"><span class="annottext">RGB
</span><a href="#local-6989586621679075599"><span class="hs-identifier hs-var">rgb'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float -&gt; RGB
</span><a href="Elem3D.html#RGB"><span class="hs-identifier hs-var">RGB</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RGB -&gt; Float
</span><a href="Elem3D.html#red"><span class="hs-identifier hs-var hs-var">red</span></a></span><span> </span><span class="annot"><span class="annottext">RGB
</span><a href="#local-6989586621679075601"><span class="hs-identifier hs-var">rgb</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">RGB -&gt; Float
</span><a href="Elem3D.html#red"><span class="hs-identifier hs-var hs-var">red</span></a></span><span> </span><span class="annot"><span class="annottext">RGB
</span><a href="#local-6989586621679075599"><span class="hs-identifier hs-var">rgb'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RGB -&gt; Float
</span><a href="Elem3D.html#green"><span class="hs-identifier hs-var hs-var">green</span></a></span><span> </span><span class="annot"><span class="annottext">RGB
</span><a href="#local-6989586621679075601"><span class="hs-identifier hs-var">rgb</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">RGB -&gt; Float
</span><a href="Elem3D.html#green"><span class="hs-identifier hs-var hs-var">green</span></a></span><span> </span><span class="annot"><span class="annottext">RGB
</span><a href="#local-6989586621679075599"><span class="hs-identifier hs-var">rgb'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RGB -&gt; Float
</span><a href="Elem3D.html#blue"><span class="hs-identifier hs-var hs-var">blue</span></a></span><span> </span><span class="annot"><span class="annottext">RGB
</span><a href="#local-6989586621679075601"><span class="hs-identifier hs-var">rgb</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">RGB -&gt; Float
</span><a href="Elem3D.html#blue"><span class="hs-identifier hs-var hs-var">blue</span></a></span><span> </span><span class="annot"><span class="annottext">RGB
</span><a href="#local-6989586621679075599"><span class="hs-identifier hs-var">rgb'</span></a></span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-311"></span><span>
</span><span id="line-312"></span><span> </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">*</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-313"></span><span> </span><span class="annot"><span class="hs-operator hs-type">(*)</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elem3D.html#RGB"><span class="hs-identifier hs-type">RGB</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elem3D.html#RGB"><span class="hs-identifier hs-type">RGB</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elem3D.html#RGB"><span class="hs-identifier hs-type">RGB</span></a></span><span>
</span><span id="line-314"></span><span> </span><span id="local-6989586621679075595"><span class="annot"><span class="annottext">RGB
</span><a href="#local-6989586621679075595"><span class="hs-identifier hs-var">rgb</span></a></span></span><span> </span><span id="local-6989586621679075594"><span class="annot"><span class="annottext">* :: RGB -&gt; RGB -&gt; RGB
</span><a href="#local-6989586621679075594"><span class="hs-operator hs-var hs-var hs-var hs-var">*</span></a></span></span><span> </span><span id="local-6989586621679075593"><span class="annot"><span class="annottext">RGB
</span><a href="#local-6989586621679075593"><span class="hs-identifier hs-var">rgb'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float -&gt; RGB
</span><a href="Elem3D.html#RGB"><span class="hs-identifier hs-var">RGB</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RGB -&gt; Float
</span><a href="Elem3D.html#red"><span class="hs-identifier hs-var hs-var">red</span></a></span><span> </span><span class="annot"><span class="annottext">RGB
</span><a href="#local-6989586621679075595"><span class="hs-identifier hs-var">rgb</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">RGB -&gt; Float
</span><a href="Elem3D.html#red"><span class="hs-identifier hs-var hs-var">red</span></a></span><span> </span><span class="annot"><span class="annottext">RGB
</span><a href="#local-6989586621679075593"><span class="hs-identifier hs-var">rgb'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RGB -&gt; Float
</span><a href="Elem3D.html#green"><span class="hs-identifier hs-var hs-var">green</span></a></span><span> </span><span class="annot"><span class="annottext">RGB
</span><a href="#local-6989586621679075595"><span class="hs-identifier hs-var">rgb</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">RGB -&gt; Float
</span><a href="Elem3D.html#green"><span class="hs-identifier hs-var hs-var">green</span></a></span><span> </span><span class="annot"><span class="annottext">RGB
</span><a href="#local-6989586621679075593"><span class="hs-identifier hs-var">rgb'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RGB -&gt; Float
</span><a href="Elem3D.html#blue"><span class="hs-identifier hs-var hs-var">blue</span></a></span><span> </span><span class="annot"><span class="annottext">RGB
</span><a href="#local-6989586621679075595"><span class="hs-identifier hs-var">rgb</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">RGB -&gt; Float
</span><a href="Elem3D.html#blue"><span class="hs-identifier hs-var hs-var">blue</span></a></span><span> </span><span class="annot"><span class="annottext">RGB
</span><a href="#local-6989586621679075593"><span class="hs-identifier hs-var">rgb'</span></a></span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-315"></span><span>
</span><span id="line-316"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">./</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-317"></span><span class="hs-comment">-- |Funci&#243;n auxiliar, dados dos RGB, calcula su divisi&#243;n.</span><span>
</span><span id="line-318"></span><span class="annot"><a href="Elem3D.html#.%2F"><span class="hs-operator hs-type">(./)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elem3D.html#RGB"><span class="hs-identifier hs-type">RGB</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elem3D.html#RGB"><span class="hs-identifier hs-type">RGB</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elem3D.html#RGB"><span class="hs-identifier hs-type">RGB</span></a></span><span>
</span><span id="line-319"></span><span id="local-6989586621679075591"><span class="annot"><span class="annottext">RGB
</span><a href="#local-6989586621679075591"><span class="hs-identifier hs-var">rgb</span></a></span></span><span> </span><span id=".%2F"><span class="annot"><span class="annottext">./ :: RGB -&gt; RGB -&gt; RGB
</span><a href="Elem3D.html#.%2F"><span class="hs-operator hs-var hs-var">./</span></a></span></span><span> </span><span id="local-6989586621679075590"><span class="annot"><span class="annottext">RGB
</span><a href="#local-6989586621679075590"><span class="hs-identifier hs-var">rgb'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float -&gt; RGB
</span><a href="Elem3D.html#RGB"><span class="hs-identifier hs-var">RGB</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RGB -&gt; Float
</span><a href="Elem3D.html#red"><span class="hs-identifier hs-var hs-var">red</span></a></span><span> </span><span class="annot"><span class="annottext">RGB
</span><a href="#local-6989586621679075591"><span class="hs-identifier hs-var">rgb</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">RGB -&gt; Float
</span><a href="Elem3D.html#red"><span class="hs-identifier hs-var hs-var">red</span></a></span><span> </span><span class="annot"><span class="annottext">RGB
</span><a href="#local-6989586621679075590"><span class="hs-identifier hs-var">rgb'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RGB -&gt; Float
</span><a href="Elem3D.html#green"><span class="hs-identifier hs-var hs-var">green</span></a></span><span> </span><span class="annot"><span class="annottext">RGB
</span><a href="#local-6989586621679075591"><span class="hs-identifier hs-var">rgb</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">RGB -&gt; Float
</span><a href="Elem3D.html#green"><span class="hs-identifier hs-var hs-var">green</span></a></span><span> </span><span class="annot"><span class="annottext">RGB
</span><a href="#local-6989586621679075590"><span class="hs-identifier hs-var">rgb'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RGB -&gt; Float
</span><a href="Elem3D.html#blue"><span class="hs-identifier hs-var hs-var">blue</span></a></span><span> </span><span class="annot"><span class="annottext">RGB
</span><a href="#local-6989586621679075591"><span class="hs-identifier hs-var">rgb</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">RGB -&gt; Float
</span><a href="Elem3D.html#blue"><span class="hs-identifier hs-var hs-var">blue</span></a></span><span> </span><span class="annot"><span class="annottext">RGB
</span><a href="#local-6989586621679075590"><span class="hs-identifier hs-var">rgb'</span></a></span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-320"></span><span>
</span><span id="line-321"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Elem3D.html#modRGB"><span class="hs-pragma hs-type">modRGB</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-322"></span><span class="hs-comment">-- |Funci&#243;n auxiliar, dado un RGB y un valor, multiplica el RGB por este.</span><span>
</span><span id="line-323"></span><span class="annot"><a href="Elem3D.html#modRGB"><span class="hs-identifier hs-type">modRGB</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elem3D.html#RGB"><span class="hs-identifier hs-type">RGB</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elem3D.html#RGB"><span class="hs-identifier hs-type">RGB</span></a></span><span>
</span><span id="line-324"></span><span id="modRGB"><span class="annot"><span class="annottext">modRGB :: RGB -&gt; Float -&gt; RGB
</span><a href="Elem3D.html#modRGB"><span class="hs-identifier hs-var hs-var">modRGB</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elem3D.html#RGB"><span class="hs-identifier hs-type">RGB</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679075586"><span id="local-6989586621679075587"><span id="local-6989586621679075588"><span class="annot"><span class="annottext">Float
blue :: Float
green :: Float
red :: Float
blue :: RGB -&gt; Float
green :: RGB -&gt; Float
red :: RGB -&gt; Float
</span><a href="#local-6989586621679075586"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679075585"><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075585"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-325"></span><span>    </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float -&gt; RGB
</span><a href="Elem3D.html#RGB"><span class="hs-identifier hs-var">RGB</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075588"><span class="hs-identifier hs-var">red</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075585"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-326"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075587"><span class="hs-identifier hs-var">green</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075585"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-327"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075586"><span class="hs-identifier hs-var">blue</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075585"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-328"></span><span>
</span><span id="line-329"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Elem3D.html#divRGB"><span class="hs-pragma hs-type">divRGB</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-330"></span><span class="hs-comment">-- |Funci&#243;n auxiliar, dado un RGB y un valor, divide el RGB por este.</span><span>
</span><span id="line-331"></span><span class="annot"><a href="Elem3D.html#divRGB"><span class="hs-identifier hs-type">divRGB</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elem3D.html#RGB"><span class="hs-identifier hs-type">RGB</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elem3D.html#RGB"><span class="hs-identifier hs-type">RGB</span></a></span><span>
</span><span id="line-332"></span><span id="divRGB"><span class="annot"><span class="annottext">divRGB :: RGB -&gt; Float -&gt; RGB
</span><a href="Elem3D.html#divRGB"><span class="hs-identifier hs-var hs-var">divRGB</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elem3D.html#RGB"><span class="hs-identifier hs-type">RGB</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679075581"><span id="local-6989586621679075582"><span id="local-6989586621679075583"><span class="annot"><span class="annottext">Float
blue :: Float
green :: Float
red :: Float
blue :: RGB -&gt; Float
green :: RGB -&gt; Float
red :: RGB -&gt; Float
</span><a href="#local-6989586621679075581"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679075580"><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075580"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-333"></span><span>    </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float -&gt; RGB
</span><a href="Elem3D.html#RGB"><span class="hs-identifier hs-var">RGB</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075583"><span class="hs-identifier hs-var">red</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075580"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-334"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075582"><span class="hs-identifier hs-var">green</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075580"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-335"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075581"><span class="hs-identifier hs-var">blue</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075580"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-336"></span><span>
</span><span id="line-337"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Elem3D.html#scale"><span class="hs-pragma hs-type">scale</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-338"></span><span class="annot"><a href="Elem3D.html#scale"><span class="hs-identifier hs-type">scale</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elem3D.html#RGB"><span class="hs-identifier hs-type">RGB</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elem3D.html#RGB"><span class="hs-identifier hs-type">RGB</span></a></span><span>
</span><span id="line-339"></span><span class="hs-comment">-- |Funci&#243;n auxiliar, dado un RGB(255) lo reescala al rango[0,1].</span><span>
</span><span id="line-340"></span><span id="scale"><span class="annot"><span class="annottext">scale :: RGB -&gt; RGB
</span><a href="Elem3D.html#scale"><span class="hs-identifier hs-var hs-var">scale</span></a></span></span><span> </span><span id="local-6989586621679075578"><span class="annot"><span class="annottext">RGB
</span><a href="#local-6989586621679075578"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RGB
</span><a href="#local-6989586621679075578"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">RGB -&gt; RGB -&gt; RGB
</span><a href="Elem3D.html#.%2F"><span class="hs-operator hs-var">./</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float -&gt; RGB
</span><a href="Elem3D.html#RGB"><span class="hs-identifier hs-var">RGB</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">255</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">255</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">255</span></span><span>
</span><span id="line-341"></span><span>
</span><span id="line-342"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Elem3D.html#prodRGB"><span class="hs-pragma hs-type">prodRGB</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-343"></span><span class="hs-comment">-- |Funci&#243;n auxiliar, dados dos RGBs, los multiplica  y reescala.</span><span>
</span><span id="line-344"></span><span class="annot"><a href="Elem3D.html#prodRGB"><span class="hs-identifier hs-type">prodRGB</span></a></span><span> </span><span class="hs-glyph">::</span><span>  </span><span class="annot"><a href="Elem3D.html#RGB"><span class="hs-identifier hs-type">RGB</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elem3D.html#RGB"><span class="hs-identifier hs-type">RGB</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elem3D.html#RGB"><span class="hs-identifier hs-type">RGB</span></a></span><span>
</span><span id="line-345"></span><span id="prodRGB"><span class="annot"><span class="annottext">prodRGB :: RGB -&gt; RGB -&gt; Float -&gt; RGB
</span><a href="Elem3D.html#prodRGB"><span class="hs-identifier hs-var hs-var">prodRGB</span></a></span></span><span> </span><span id="local-6989586621679075576"><span class="annot"><span class="annottext">RGB
</span><a href="#local-6989586621679075576"><span class="hs-identifier hs-var">r0</span></a></span></span><span> </span><span id="local-6989586621679075575"><span class="annot"><span class="annottext">RGB
</span><a href="#local-6989586621679075575"><span class="hs-identifier hs-var">r1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RGB -&gt; Float -&gt; RGB
</span><a href="Elem3D.html#modRGB"><span class="hs-identifier hs-var">modRGB</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RGB -&gt; RGB
</span><a href="Elem3D.html#scale"><span class="hs-identifier hs-var">scale</span></a></span><span> </span><span class="annot"><span class="annottext">RGB
</span><a href="#local-6989586621679075576"><span class="hs-identifier hs-var">r0</span></a></span><span> </span><span class="annot"><span class="annottext">RGB -&gt; RGB -&gt; RGB
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">RGB
</span><a href="#local-6989586621679075575"><span class="hs-identifier hs-var">r1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-346"></span><span>
</span><span id="line-347"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Elem3D.html#nanRGB"><span class="hs-pragma hs-type">nanRGB</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-348"></span><span class="hs-comment">-- |Funci&#243;n auxiliar, comprueba la validez de los valores internos de un RGB.</span><span>
</span><span id="line-349"></span><span class="annot"><a href="Elem3D.html#nanRGB"><span class="hs-identifier hs-type">nanRGB</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elem3D.html#RGB"><span class="hs-identifier hs-type">RGB</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-350"></span><span id="nanRGB"><span class="annot"><span class="annottext">nanRGB :: RGB -&gt; Bool
</span><a href="Elem3D.html#nanRGB"><span class="hs-identifier hs-var hs-var">nanRGB</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elem3D.html#RGB"><span class="hs-identifier hs-type">RGB</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679075571"><span id="local-6989586621679075572"><span id="local-6989586621679075573"><span class="annot"><span class="annottext">Float
blue :: Float
green :: Float
red :: Float
blue :: RGB -&gt; Float
green :: RGB -&gt; Float
red :: RGB -&gt; Float
</span><a href="#local-6989586621679075571"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Bool
forall a. RealFloat a =&gt; a -&gt; Bool
</span><span class="hs-identifier hs-var">isNaN</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075573"><span class="hs-identifier hs-var">red</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Bool
forall a. RealFloat a =&gt; a -&gt; Bool
</span><span class="hs-identifier hs-var">isNaN</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075572"><span class="hs-identifier hs-var">green</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Bool
forall a. RealFloat a =&gt; a -&gt; Bool
</span><span class="hs-identifier hs-var">isNaN</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075571"><span class="hs-identifier hs-var">blue</span></a></span><span>
</span><span id="line-351"></span><span>
</span><span id="line-352"></span><span>
</span><span id="line-353"></span><span class="hs-comment">-----------------------------------------------------------------------------------------------------------------------------------------------</span><span>
</span><span id="line-354"></span><span class="hs-comment">--Bases y Matrices</span><span>
</span><span id="line-355"></span><span>
</span><span id="line-356"></span><span>
</span><span id="line-357"></span><span class="hs-comment">-- Punto a Vector</span><span>
</span><span id="line-358"></span><span class="hs-comment">-- |Funci&#243;n auxiliar, convierte de punto a vector.</span><span>
</span><span id="line-359"></span><span class="annot"><a href="Elem3D.html#pointToVector"><span class="hs-identifier hs-type">pointToVector</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-type">Point3D</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span class="hs-special">]</span><span>
</span><span id="line-360"></span><span id="pointToVector"><span class="annot"><span class="annottext">pointToVector :: Point3D -&gt; [Float]
</span><a href="Elem3D.html#pointToVector"><span class="hs-identifier hs-var hs-var">pointToVector</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-type">Point3D</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679075565"><span id="local-6989586621679075566"><span id="local-6989586621679075567"><span class="annot"><span class="annottext">Float
zP :: Float
yP :: Float
xP :: Float
zP :: Point3D -&gt; Float
yP :: Point3D -&gt; Float
xP :: Point3D -&gt; Float
</span><a href="#local-6989586621679075565"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075567"><span class="hs-identifier hs-var">xP</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075566"><span class="hs-identifier hs-var">yP</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075565"><span class="hs-identifier hs-var">zP</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-361"></span><span>
</span><span id="line-362"></span><span class="hs-comment">-- Vector a Punto</span><span>
</span><span id="line-363"></span><span class="hs-comment">-- |Funci&#243;n auxiliar, convierte de vector a punto.</span><span>
</span><span id="line-364"></span><span class="annot"><a href="Elem3D.html#vectorToPoint"><span class="hs-identifier hs-type">vectorToPoint</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-type">Point3D</span></a></span><span>
</span><span id="line-365"></span><span id="vectorToPoint"><span class="annot"><span class="annottext">vectorToPoint :: [Float] -&gt; Point3D
</span><a href="Elem3D.html#vectorToPoint"><span class="hs-identifier hs-var hs-var">vectorToPoint</span></a></span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679075563"><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075563"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679075562"><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075562"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679075561"><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075561"><span class="hs-identifier hs-var">z</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float -&gt; Point3D
</span><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-var">Point3D</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075563"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075562"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075561"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-366"></span><span>
</span><span id="line-367"></span><span class="hs-comment">--Generar Base con 3 Direcciones dadas(No comprueba que sean perpendiculares)</span><span>
</span><span id="line-368"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Elem3D.html#generateBase"><span class="hs-pragma hs-type">generateBase</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-369"></span><span class="hs-comment">-- |Funci&#243;n auxiliar, dadas 3 direcciones genera la base correspondiente(no comprueba que sean perpendiculares).</span><span>
</span><span id="line-370"></span><span class="annot"><a href="Elem3D.html#generateBase"><span class="hs-identifier hs-type">generateBase</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elem3D.html#Direction"><span class="hs-identifier hs-type">Direction</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elem3D.html#Direction"><span class="hs-identifier hs-type">Direction</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elem3D.html#Direction"><span class="hs-identifier hs-type">Direction</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elem3D.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span>
</span><span id="line-371"></span><span id="generateBase"><span class="annot"><span class="annottext">generateBase :: Direction -&gt; Direction -&gt; Direction -&gt; Base
</span><a href="Elem3D.html#generateBase"><span class="hs-identifier hs-var hs-var">generateBase</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Direction -&gt; Direction -&gt; Direction -&gt; Base
</span><a href="Elem3D.html#Base"><span class="hs-identifier hs-var">Base</span></a></span><span>
</span><span id="line-372"></span><span>
</span><span id="line-373"></span><span class="hs-comment">-- Base + Punto a Matriz</span><span>
</span><span id="line-374"></span><span class="hs-comment">-- |Funci&#243;n auxiliar, convierte de base a matriz.</span><span>
</span><span id="line-375"></span><span class="annot"><a href="Elem3D.html#basePointMatrix"><span class="hs-identifier hs-type">basePointMatrix</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elem3D.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-376"></span><span id="basePointMatrix"><span class="annot"><span class="annottext">basePointMatrix :: Base -&gt; [[Float]]
</span><a href="Elem3D.html#basePointMatrix"><span class="hs-identifier hs-var hs-var">basePointMatrix</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elem3D.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679075556"><span id="local-6989586621679075557"><span id="local-6989586621679075558"><span class="annot"><span class="annottext">Direction
d2 :: Direction
d1 :: Direction
d0 :: Direction
d2 :: Base -&gt; Direction
d1 :: Base -&gt; Direction
d0 :: Base -&gt; Direction
</span><a href="#local-6989586621679075556"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-377"></span><span>  </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Direction -&gt; Float
</span><a href="Elem3D.html#xD"><span class="hs-identifier hs-var hs-var">xD</span></a></span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679075558"><span class="hs-identifier hs-var">d0</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Direction -&gt; Float
</span><a href="Elem3D.html#xD"><span class="hs-identifier hs-var hs-var">xD</span></a></span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679075557"><span class="hs-identifier hs-var">d1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Direction -&gt; Float
</span><a href="Elem3D.html#xD"><span class="hs-identifier hs-var hs-var">xD</span></a></span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679075556"><span class="hs-identifier hs-var">d2</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-378"></span><span>   </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Direction -&gt; Float
</span><a href="Elem3D.html#yD"><span class="hs-identifier hs-var hs-var">yD</span></a></span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679075558"><span class="hs-identifier hs-var">d0</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Direction -&gt; Float
</span><a href="Elem3D.html#yD"><span class="hs-identifier hs-var hs-var">yD</span></a></span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679075557"><span class="hs-identifier hs-var">d1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Direction -&gt; Float
</span><a href="Elem3D.html#yD"><span class="hs-identifier hs-var hs-var">yD</span></a></span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679075556"><span class="hs-identifier hs-var">d2</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-379"></span><span>   </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Direction -&gt; Float
</span><a href="Elem3D.html#zD"><span class="hs-identifier hs-var hs-var">zD</span></a></span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679075558"><span class="hs-identifier hs-var">d0</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Direction -&gt; Float
</span><a href="Elem3D.html#zD"><span class="hs-identifier hs-var hs-var">zD</span></a></span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679075557"><span class="hs-identifier hs-var">d1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Direction -&gt; Float
</span><a href="Elem3D.html#zD"><span class="hs-identifier hs-var hs-var">zD</span></a></span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679075556"><span class="hs-identifier hs-var">d2</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-380"></span><span>
</span><span id="line-381"></span><span class="hs-comment">--Cambio de Base con punto y matriz en Global, devuelve punto visto en local</span><span>
</span><span id="line-382"></span><span class="hs-comment">-- |Funci&#243;n auxiliar, realiza un cambio de base de global a local para un punto, con un nuevo origen.</span><span>
</span><span id="line-383"></span><span class="annot"><a href="Elem3D.html#cambioBase"><span class="hs-identifier hs-type">cambioBase</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-type">Point3D</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elem3D.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-type">Point3D</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-type">Point3D</span></a></span><span>
</span><span id="line-384"></span><span id="cambioBase"><span class="annot"><span class="annottext">cambioBase :: Point3D -&gt; Base -&gt; Point3D -&gt; Point3D
</span><a href="Elem3D.html#cambioBase"><span class="hs-identifier hs-var hs-var">cambioBase</span></a></span></span><span> </span><span id="local-6989586621679075554"><span class="annot"><span class="annottext">Point3D
</span><a href="#local-6989586621679075554"><span class="hs-identifier hs-var">nuevoOrigen</span></a></span></span><span> </span><span id="local-6989586621679075553"><span class="annot"><span class="annottext">Base
</span><a href="#local-6989586621679075553"><span class="hs-identifier hs-var">baseACambiar</span></a></span></span><span> </span><span id="local-6989586621679075552"><span class="annot"><span class="annottext">Point3D
</span><a href="#local-6989586621679075552"><span class="hs-identifier hs-var">puntoACambiarDeBase</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Direction -&gt; Point3D -&gt; Point3D
</span><a href="Elem3D.html#movePoint"><span class="hs-identifier hs-var">movePoint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point3D
</span><a href="#local-6989586621679075554"><span class="hs-identifier hs-var">nuevoOrigen</span></a></span><span> </span><span class="annot"><span class="annottext">Point3D -&gt; Point3D -&gt; Direction
</span><a href="Elem3D.html#%23%3C"><span class="hs-operator hs-var">#&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float -&gt; Point3D
</span><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-var">Point3D</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Point3D
</span><a href="#local-6989586621679075551"><span class="hs-identifier hs-var">puntoDeBaseCambiada</span></a></span><span>
</span><span id="line-385"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-386"></span><span>        </span><span id="local-6989586621679075551"><span class="annot"><span class="annottext">puntoDeBaseCambiada :: Point3D
</span><a href="#local-6989586621679075551"><span class="hs-identifier hs-var hs-var">puntoDeBaseCambiada</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Float] -&gt; Point3D
</span><a href="Elem3D.html#vectorToPoint"><span class="hs-identifier hs-var">vectorToPoint</span></a></span><span> </span><span class="annot"><span class="annottext">[Float]
</span><a href="#local-6989586621679075550"><span class="hs-identifier hs-var">vectorDeBaseCambiada</span></a></span><span>
</span><span id="line-387"></span><span>        </span><span id="local-6989586621679075550"><span class="annot"><span class="annottext">vectorDeBaseCambiada :: [Float]
</span><a href="#local-6989586621679075550"><span class="hs-identifier hs-var hs-var">vectorDeBaseCambiada</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[Float]] -&gt; [Float] -&gt; [Float]
</span><a href="Elem3D.html#matrixVectorProduct"><span class="hs-identifier hs-var">matrixVectorProduct</span></a></span><span> </span><span class="annot"><span class="annottext">[[Float]]
</span><a href="#local-6989586621679075548"><span class="hs-identifier hs-var">baseNueva</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point3D -&gt; [Float]
</span><a href="Elem3D.html#pointToVector"><span class="hs-identifier hs-var">pointToVector</span></a></span><span> </span><span class="annot"><span class="annottext">Point3D
</span><a href="#local-6989586621679075552"><span class="hs-identifier hs-var">puntoACambiarDeBase</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-388"></span><span>        </span><span id="local-6989586621679075548"><span class="annot"><span class="annottext">baseNueva :: [[Float]]
</span><a href="#local-6989586621679075548"><span class="hs-identifier hs-var hs-var">baseNueva</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Base -&gt; [[Float]]
</span><a href="Elem3D.html#basePointMatrix"><span class="hs-identifier hs-var">basePointMatrix</span></a></span><span> </span><span class="annot"><span class="annottext">Base
</span><a href="#local-6989586621679075553"><span class="hs-identifier hs-var">baseACambiar</span></a></span><span>
</span><span id="line-389"></span><span>
</span><span id="line-390"></span><span class="hs-comment">--Cambio de Base con punto y matriz en Local, devuelve punto visto en global</span><span>
</span><span id="line-391"></span><span class="hs-comment">-- |Funci&#243;n auxiliar, realiza un cambio de base de local a global para un punto, con el origen previo.</span><span>
</span><span id="line-392"></span><span class="annot"><a href="Elem3D.html#cambioBase%27"><span class="hs-identifier hs-type">cambioBase'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-type">Point3D</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elem3D.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-type">Point3D</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-type">Point3D</span></a></span><span>
</span><span id="line-393"></span><span id="cambioBase%27"><span class="annot"><span class="annottext">cambioBase' :: Point3D -&gt; Base -&gt; Point3D -&gt; Point3D
</span><a href="Elem3D.html#cambioBase%27"><span class="hs-identifier hs-var hs-var">cambioBase'</span></a></span></span><span> </span><span id="local-6989586621679075546"><span class="annot"><span class="annottext">Point3D
</span><a href="#local-6989586621679075546"><span class="hs-identifier hs-var">nuevoOrigen</span></a></span></span><span> </span><span id="local-6989586621679075545"><span class="annot"><span class="annottext">Base
</span><a href="#local-6989586621679075545"><span class="hs-identifier hs-var">baseACambiar</span></a></span></span><span> </span><span id="local-6989586621679075544"><span class="annot"><span class="annottext">Point3D
</span><a href="#local-6989586621679075544"><span class="hs-identifier hs-var">puntoACambiarDeBase</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Direction -&gt; Point3D -&gt; Point3D
</span><a href="Elem3D.html#movePoint"><span class="hs-identifier hs-var">movePoint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point3D
</span><a href="#local-6989586621679075546"><span class="hs-identifier hs-var">nuevoOrigen</span></a></span><span> </span><span class="annot"><span class="annottext">Point3D -&gt; Point3D -&gt; Direction
</span><a href="Elem3D.html#%23%3C"><span class="hs-operator hs-var">#&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float -&gt; Point3D
</span><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-var">Point3D</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Point3D
</span><a href="#local-6989586621679075543"><span class="hs-identifier hs-var">puntoDeBaseCambiada</span></a></span><span>
</span><span id="line-394"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-395"></span><span>        </span><span id="local-6989586621679075543"><span class="annot"><span class="annottext">puntoDeBaseCambiada :: Point3D
</span><a href="#local-6989586621679075543"><span class="hs-identifier hs-var hs-var">puntoDeBaseCambiada</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Point3D -&gt; Point3D
</span><a href="Elem3D.html#roundTo"><span class="hs-identifier hs-var">roundTo</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span> </span><span class="annot"><span class="annottext">(Point3D -&gt; Point3D) -&gt; Point3D -&gt; Point3D
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Float] -&gt; Point3D
</span><a href="Elem3D.html#vectorToPoint"><span class="hs-identifier hs-var">vectorToPoint</span></a></span><span> </span><span class="annot"><span class="annottext">[Float]
</span><a href="#local-6989586621679075542"><span class="hs-identifier hs-var">vectorDeBaseCambiada</span></a></span><span>
</span><span id="line-396"></span><span>        </span><span id="local-6989586621679075542"><span class="annot"><span class="annottext">vectorDeBaseCambiada :: [Float]
</span><a href="#local-6989586621679075542"><span class="hs-identifier hs-var hs-var">vectorDeBaseCambiada</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[Float]] -&gt; [Float] -&gt; [Float]
</span><a href="Elem3D.html#matrixVectorProduct"><span class="hs-identifier hs-var">matrixVectorProduct</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[[Float]] -&gt; [[Float]]
forall a. [[a]] -&gt; [[a]]
</span><a href="Elem3D.html#transposeMatrix"><span class="hs-identifier hs-var">transposeMatrix</span></a></span><span> </span><span class="annot"><span class="annottext">[[Float]]
</span><a href="#local-6989586621679075540"><span class="hs-identifier hs-var">baseNueva</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Point3D -&gt; [Float]
</span><a href="Elem3D.html#pointToVector"><span class="hs-identifier hs-var">pointToVector</span></a></span><span> </span><span class="annot"><span class="annottext">Point3D
</span><a href="#local-6989586621679075544"><span class="hs-identifier hs-var">puntoACambiarDeBase</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-397"></span><span>        </span><span id="local-6989586621679075540"><span class="annot"><span class="annottext">baseNueva :: [[Float]]
</span><a href="#local-6989586621679075540"><span class="hs-identifier hs-var hs-var">baseNueva</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[Float]] -&gt; [[Float]]
</span><a href="Elem3D.html#invertMatrix"><span class="hs-identifier hs-var">invertMatrix</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Base -&gt; [[Float]]
</span><a href="Elem3D.html#basePointMatrix"><span class="hs-identifier hs-var">basePointMatrix</span></a></span><span> </span><span class="annot"><span class="annottext">Base
</span><a href="#local-6989586621679075545"><span class="hs-identifier hs-var">baseACambiar</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-398"></span><span>
</span><span id="line-399"></span><span class="hs-comment">-- Producto de matriz por vector</span><span>
</span><span id="line-400"></span><span class="hs-comment">-- |Funci&#243;n auxiliar, calcula el producto de la matriz por el vector.</span><span>
</span><span id="line-401"></span><span class="annot"><a href="Elem3D.html#matrixVectorProduct"><span class="hs-identifier hs-type">matrixVectorProduct</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span class="hs-special">]</span><span>
</span><span id="line-402"></span><span id="matrixVectorProduct"><span class="annot"><span class="annottext">matrixVectorProduct :: [[Float]] -&gt; [Float] -&gt; [Float]
</span><a href="Elem3D.html#matrixVectorProduct"><span class="hs-identifier hs-var hs-var">matrixVectorProduct</span></a></span></span><span> </span><span id="local-6989586621679075538"><span class="annot"><span class="annottext">[[Float]]
</span><a href="#local-6989586621679075538"><span class="hs-identifier hs-var">mat</span></a></span></span><span> </span><span id="local-6989586621679075537"><span class="annot"><span class="annottext">[Float]
</span><a href="#local-6989586621679075537"><span class="hs-identifier hs-var">vec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-403"></span><span>  </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Float] -&gt; Float
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">sum</span></span><span> </span><span class="annot"><span class="annottext">([Float] -&gt; Float) -&gt; [Float] -&gt; Float
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Float -&gt; Float -&gt; Float) -&gt; [Float] -&gt; [Float] -&gt; [Float]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(*)</span></span><span> </span><span class="annot"><span class="annottext">[Float]
</span><a href="#local-6989586621679075534"><span class="hs-identifier hs-var">row</span></a></span><span> </span><span class="annot"><span class="annottext">[Float]
</span><a href="#local-6989586621679075537"><span class="hs-identifier hs-var">vec</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679075534"><span class="annot"><span class="annottext">[Float]
</span><a href="#local-6989586621679075534"><span class="hs-identifier hs-var">row</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[[Float]]
</span><a href="#local-6989586621679075538"><span class="hs-identifier hs-var">mat</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-404"></span><span>
</span><span id="line-405"></span><span class="hs-comment">-- Funci&#243;n de transposici&#243;n de una matriz</span><span>
</span><span id="line-406"></span><span class="hs-comment">-- |Funci&#243;n auxiliar, realiza una transposici&#243;n de matriz.</span><span>
</span><span id="line-407"></span><span id="local-6989586621679076349"><span class="annot"><a href="Elem3D.html#transposeMatrix"><span class="hs-identifier hs-type">transposeMatrix</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679076349"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679076349"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span></span><span>
</span><span id="line-408"></span><span id="transposeMatrix"><span class="annot"><span class="annottext">transposeMatrix :: forall a. [[a]] -&gt; [[a]]
</span><a href="Elem3D.html#transposeMatrix"><span class="hs-identifier hs-var hs-var">transposeMatrix</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[[a]]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-409"></span><span class="annot"><a href="Elem3D.html#transposeMatrix"><span class="hs-identifier hs-var">transposeMatrix</span></a></span><span> </span><span id="local-6989586621679075533"><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679075533"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([a] -&gt; a) -&gt; [[a]] -&gt; [a]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; a
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679075533"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [[a]] -&gt; [[a]]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[[a]] -&gt; [[a]]
forall a. [[a]] -&gt; [[a]]
</span><a href="Elem3D.html#transposeMatrix"><span class="hs-identifier hs-var">transposeMatrix</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([a] -&gt; [a]) -&gt; [[a]] -&gt; [[a]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679075533"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-410"></span><span>
</span><span id="line-411"></span><span class="hs-comment">-- |Funci&#243;n auxiliar, invierte una matriz.</span><span>
</span><span id="line-412"></span><span class="annot"><a href="Elem3D.html#invertMatrix"><span class="hs-identifier hs-type">invertMatrix</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-413"></span><span id="invertMatrix"><span class="annot"><span class="annottext">invertMatrix :: [[Float]] -&gt; [[Float]]
</span><a href="Elem3D.html#invertMatrix"><span class="hs-identifier hs-var hs-var">invertMatrix</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span id="local-6989586621679075530"><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075530"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679075529"><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075529"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679075528"><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075528"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span id="local-6989586621679075527"><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075527"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679075526"><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075526"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679075525"><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075525"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span id="local-6989586621679075524"><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075524"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679075523"><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075523"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679075522"><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075522"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-414"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679075507"><span class="annot"><span class="annottext">det :: Float
</span><a href="#local-6989586621679075507"><span class="hs-identifier hs-var hs-var">det</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075530"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075526"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075522"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075525"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075523"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075529"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075527"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075522"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075525"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075524"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075528"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075527"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075523"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075526"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075524"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-415"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075526"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075522"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075525"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075523"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075507"><span class="hs-identifier hs-var">det</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075528"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075523"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075529"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075522"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075507"><span class="hs-identifier hs-var">det</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075529"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075525"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075528"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075526"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075507"><span class="hs-identifier hs-var">det</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-416"></span><span>      </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075525"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075524"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075527"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075522"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075507"><span class="hs-identifier hs-var">det</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075530"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075522"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075528"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075524"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075507"><span class="hs-identifier hs-var">det</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075528"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075527"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075530"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075525"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075507"><span class="hs-identifier hs-var">det</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-417"></span><span>      </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075527"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075523"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075526"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075524"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075507"><span class="hs-identifier hs-var">det</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075524"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075529"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075530"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075523"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075507"><span class="hs-identifier hs-var">det</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075530"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075526"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075529"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075527"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679075507"><span class="hs-identifier hs-var">det</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span></pre></body></html>