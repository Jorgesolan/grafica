<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE BangPatterns #-}</span><span>
</span><span id="line-2"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Escena.html"><span class="hs-identifier">Escena</span></a></span><span>
</span><span id="line-3"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elem3D.html"><span class="hs-identifier">Elem3D</span></a></span><span>
</span><span id="line-4"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Elem3D.html#Foton"><span class="hs-identifier">Foton</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-5"></span><span>      </span><span class="annot"><a href="Elem3D.html#Luz"><span class="hs-identifier">Luz</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-6"></span><span>      </span><span class="annot"><a href="Elem3D.html#RGB"><span class="hs-identifier">RGB</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-7"></span><span>      </span><span class="annot"><a href="Elem3D.html#Base"><span class="hs-identifier">Base</span></a></span><span class="hs-special">(</span><span class="annot"><a href="Elem3D.html#Base"><span class="hs-identifier">Base</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-8"></span><span>      </span><span class="annot"><a href="Elem3D.html#Ray"><span class="hs-identifier">Ray</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-9"></span><span>      </span><span class="annot"><a href="Elem3D.html#Direction"><span class="hs-identifier">Direction</span></a></span><span class="hs-special">(</span><span class="annot"><a href="Elem3D.html#Direction"><span class="hs-identifier">Direction</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-10"></span><span>      </span><span class="annot"><a href="Elem3D.html#Point3D"><span class="hs-identifier">Point3D</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-11"></span><span>      </span><span class="annot"><a href="Elem3D.html#escalatePoint"><span class="hs-identifier">escalatePoint</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Elem3D.html#escalatePointt"><span class="hs-identifier">escalatePointt</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-12"></span><span>      </span><span class="annot"><a href="Elem3D.html#degToRad"><span class="hs-identifier">degToRad</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-13"></span><span>      </span><span class="annot"><a href="Elem3D.html#rotatePoint"><span class="hs-identifier">rotatePoint</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Elem3D.html#movePoint"><span class="hs-identifier">movePoint</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elem3D.html#divRGB"><span class="hs-identifier">divRGB</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Elem3D.html#rotatePointt"><span class="hs-identifier">rotatePointt</span></a></span><span>
</span><span id="line-14"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Figuras.html"><span class="hs-identifier">Figuras</span></a></span><span>
</span><span id="line-16"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Figuras.html#Obj"><span class="hs-identifier">Obj</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-17"></span><span>      </span><span class="annot"><a href="Figuras.html#Shape"><span class="hs-identifier">Shape</span></a></span><span class="hs-special">(</span><span class="annot"><a href="Figuras.html#Sphere"><span class="hs-identifier">Sphere</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Figuras.html#Plane"><span class="hs-identifier">Plane</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Figuras.html#Cylinder"><span class="hs-identifier">Cylinder</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Figuras.html#Rectangle"><span class="hs-identifier">Rectangle</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Figuras.html#Acelerator"><span class="hs-identifier">Acelerator</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>      </span><span class="annot"><a href="Figuras.html#Plano"><span class="hs-identifier">Plano</span></a></span><span class="hs-special">(</span><span class="annot"><a href="Figuras.html#Plano"><span class="hs-identifier">Plano</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>      </span><span class="annot"><a href="Figuras.html#Esfera"><span class="hs-identifier">Esfera</span></a></span><span class="hs-special">(</span><span class="annot"><a href="Figuras.html#Esfera"><span class="hs-identifier">Esfera</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>      </span><span class="annot"><a href="Figuras.html#Cilindro"><span class="hs-identifier">Cilindro</span></a></span><span class="hs-special">(</span><span class="annot"><a href="Figuras.html#Cilindro"><span class="hs-identifier">Cilindro</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>      </span><span class="annot"><a href="Figuras.html#Rectangulo"><span class="hs-identifier">Rectangulo</span></a></span><span class="hs-special">(</span><span class="annot"><a href="Figuras.html#Rectangulo"><span class="hs-identifier">Rectangulo</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>      </span><span class="annot"><a href="Figuras.html#Camara"><span class="hs-identifier">Camara</span></a></span><span class="hs-special">(</span><span class="annot"><a href="Figuras.html#Camara"><span class="hs-identifier">Camara</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>      </span><span class="annot"><a href="Figuras.html#BVH"><span class="hs-identifier">BVH</span></a></span><span class="hs-special">(</span><span class="annot"><a href="Figuras.html#BVH"><span class="hs-identifier">BVH</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>      </span><span class="annot"><a href="Figuras.html#addFigMult"><span class="hs-identifier">addFigMult</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>      </span><span class="annot"><a href="Figuras.html#parametricShapeCollision"><span class="hs-identifier">parametricShapeCollision</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>      </span><span class="annot"><a href="Figuras.html#loadObjFile"><span class="hs-identifier">loadObjFile</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>      </span><span class="annot"><a href="Figuras.html#convertToCustomFormat"><span class="hs-identifier">convertToCustomFormat</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Figuras.html#encenderShape"><span class="hs-identifier">encenderShape</span></a></span><span> </span><span class="hs-special">,</span><span class="annot"><a href="Figuras.html#encenderShapes"><span class="hs-identifier">encenderShapes</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Figuras.html#buildBVH"><span class="hs-identifier">buildBVH</span></a></span><span>
</span><span id="line-28"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Files.html"><span class="hs-identifier">Files</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Files.html#writePPM"><span class="hs-identifier">writePPM</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Files.html#rgbToString"><span class="hs-identifier">rgbToString</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Files.html#readObject"><span class="hs-identifier">readObject</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Tone_map.html"><span class="hs-identifier">Tone_map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Tone_map.html#gammaFunc"><span class="hs-identifier">gammaFunc</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Tone_map.html#clamp"><span class="hs-identifier">clamp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Funciones.html"><span class="hs-identifier">Funciones</span></a></span><span>
</span><span id="line-32"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Funciones.html#mediaLRGB"><span class="hs-identifier">mediaLRGB</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>      </span><span class="annot"><a href="Funciones.html#generateRaysForPixels"><span class="hs-identifier">generateRaysForPixels</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>      </span><span class="annot"><a href="Funciones.html#obtenerPrimeraColision"><span class="hs-identifier">obtenerPrimeraColision</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>      </span><span class="annot"><a href="Funciones.html#listRay"><span class="hs-identifier">listRay</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>      </span><span class="annot"><a href="Funciones.html#chunksOf"><span class="hs-identifier">chunksOf</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Funciones.html#mulCam"><span class="hs-identifier">mulCam</span></a></span><span> </span><span class="hs-special">,</span><span class="annot"><a href="Funciones.html#brdf"><span class="hs-identifier">brdf</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Funciones.html#sumFlLuz"><span class="hs-identifier">sumFlLuz</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PathTracer.html"><span class="hs-identifier">PathTracer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PathTracer.html#pathTracer"><span class="hs-identifier">pathTracer</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PathTracer.html#luzDirecta"><span class="hs-identifier">luzDirecta</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PathTracer.html#luzArea"><span class="hs-identifier">luzArea</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="KdT.html"><span class="hs-identifier">KdT</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="KdT.html#createKD"><span class="hs-identifier">createKD</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PhotonMap.html"><span class="hs-identifier">PhotonMap</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="PhotonMap.html#photonMap"><span class="hs-identifier">photonMap</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.KdTree.Static</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">KdTree</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Files.html"><span class="hs-identifier">Files</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Files.html#writeObject"><span class="hs-identifier">writeObject</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Debug.Trace</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">trace</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">traceEventIO</span></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Random</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">StdGen</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">newStdGen</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">split</span></span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">transpose</span></span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.CPUTime</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">getCPUTime</span></span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Environment</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">getArgs</span></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Exit</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">exitFailure</span></span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Text.Read</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">readMaybe</span></span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PhotonMap.html"><span class="hs-identifier">PhotonMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PhotonMap.html#createPhoton"><span class="hs-identifier">createPhoton</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.DList</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">DL</span></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span class="hs-comment">-- make clean &amp;&amp; make simulacion &amp;&amp; cd ./tmp &amp;&amp; ./simulacion &amp;&amp; ./run.sh &amp;&amp; cd .. &amp;&amp; convert ./tmp/output.ppm a.bmp</span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Main.html#antialiasing"><span class="hs-pragma hs-type">antialiasing</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-56"></span><span class="annot"><a href="Main.html#antialiasing"><span class="hs-identifier hs-type">antialiasing</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Figuras.html#Obj"><span class="hs-identifier hs-type">Obj</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Figuras.html#Obj"><span class="hs-identifier hs-type">Obj</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-57"></span><span id="antialiasing"><span class="annot"><span class="annottext">antialiasing :: Int -&gt; [Obj] -&gt; [Obj]
</span><a href="Main.html#antialiasing"><span class="hs-identifier hs-var hs-var">antialiasing</span></a></span></span><span> </span><span id="local-6989586621679079565"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679079565"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679079564"><span class="annot"><span class="annottext">[Obj]
</span><a href="#local-6989586621679079564"><span class="hs-identifier hs-var">rayos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Set Obj -&gt; Obj) -&gt; [Set Obj] -&gt; [Obj]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Set Obj -&gt; Obj
</span><a href="Funciones.html#obtenerPrimeraColision"><span class="hs-identifier hs-var">obtenerPrimeraColision</span></a></span><span> </span><span class="annot"><span class="annottext">([Set Obj] -&gt; [Obj]) -&gt; [Set Obj] -&gt; [Obj]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">([Obj] -&gt; Set Obj) -&gt; [[Obj]] -&gt; [Set Obj]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">[Obj] -&gt; Set Obj
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">Set.fromList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; [Obj] -&gt; [[Obj]]
forall e. Int -&gt; [e] -&gt; [[e]]
</span><a href="Funciones.html#chunksOf"><span class="hs-identifier hs-var">chunksOf</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679079565"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[Obj]
</span><a href="#local-6989586621679079564"><span class="hs-identifier hs-var">rayos</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Obtiene la colision mas cercana de cada lista de colisiones dependiendo del numero de rayos del antialiasing</span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Main.html#listRayToRGB"><span class="hs-pragma hs-type">listRayToRGB</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-60"></span><span class="annot"><a href="Main.html#listRayToRGB"><span class="hs-identifier hs-type">listRayToRGB</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Elem3D.html#Luz"><span class="hs-identifier hs-type">Luz</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set.Set</span></span><span> </span><span class="annot"><a href="Figuras.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Elem3D.html#Ray"><span class="hs-identifier hs-type">Ray</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">StdGen</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Elem3D.html#RGB"><span class="hs-identifier hs-type">RGB</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-61"></span><span id="listRayToRGB"><span class="annot"><span class="annottext">listRayToRGB :: [Luz] -&gt; Set Shape -&gt; [Ray] -&gt; StdGen -&gt; Int -&gt; [RGB]
</span><a href="Main.html#listRayToRGB"><span class="hs-identifier hs-var hs-var">listRayToRGB</span></a></span></span><span> </span><span id="local-6989586621679079561"><span class="annot"><span class="annottext">[Luz]
</span><a href="#local-6989586621679079561"><span class="hs-identifier hs-var">luz</span></a></span></span><span> </span><span id="local-6989586621679079560"><span class="annot"><span class="annottext">Set Shape
</span><a href="#local-6989586621679079560"><span class="hs-identifier hs-var">figuras</span></a></span></span><span> </span><span id="local-6989586621679079559"><span class="annot"><span class="annottext">[Ray]
</span><a href="#local-6989586621679079559"><span class="hs-identifier hs-var">rayos</span></a></span></span><span> </span><span id="local-6989586621679079558"><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679079558"><span class="hs-identifier hs-var">gen</span></a></span></span><span> </span><span id="local-6989586621679079557"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679079557"><span class="hs-identifier hs-var">nRay</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(RGB -&gt; RGB -&gt; RGB) -&gt; [RGB] -&gt; [RGB] -&gt; [RGB]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="annot"><span class="annottext">RGB -&gt; RGB -&gt; RGB
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(+)</span></span><span> </span><span class="annot"><span class="annottext">[RGB]
</span><a href="#local-6989586621679079554"><span class="hs-identifier hs-var">colorDirecto</span></a></span><span> </span><span class="annot"><span class="annottext">([RGB] -&gt; [RGB]) -&gt; [RGB] -&gt; [RGB]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(RGB -&gt; RGB) -&gt; [RGB] -&gt; [RGB]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RGB -&gt; Float -&gt; RGB
</span><a href="Elem3D.html#divRGB"><span class="hs-operator hs-var">`divRGB`</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Float
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679079553"><span class="hs-identifier hs-var">ppp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[RGB]
</span><a href="#local-6989586621679079552"><span class="hs-identifier hs-var">colorIndirecto</span></a></span><span>
</span><span id="line-62"></span><span>  </span><span class="hs-comment">-- map (`divRGB` fromIntegral ppp) colorArea --zipWith (+) colorDirecto $ map (`divRGB` fromIntegral ppp) colorIndirecto</span><span>
</span><span id="line-63"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-64"></span><span>    </span><span id="local-6989586621679079551"><span class="annot"><span class="annottext">antial :: [Obj]
</span><a href="#local-6989586621679079551"><span class="hs-identifier hs-var hs-var">antial</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Set Obj -&gt; Obj) -&gt; [Set Obj] -&gt; [Obj]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Set Obj -&gt; Obj
</span><a href="Funciones.html#listRay"><span class="hs-identifier hs-var">listRay</span></a></span><span> </span><span class="annot"><span class="annottext">([Set Obj] -&gt; [Obj]) -&gt; [Set Obj] -&gt; [Obj]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Set Shape -&gt; [Ray] -&gt; [Set Obj]
</span><a href="Figuras.html#parametricShapeCollision"><span class="hs-identifier hs-var">parametricShapeCollision</span></a></span><span> </span><span class="annot"><span class="annottext">Set Shape
</span><a href="#local-6989586621679079560"><span class="hs-identifier hs-var">figuras</span></a></span><span> </span><span class="annot"><span class="annottext">[Ray]
</span><a href="#local-6989586621679079559"><span class="hs-identifier hs-var">rayos</span></a></span><span>
</span><span id="line-65"></span><span>    </span><span id="local-6989586621679079550"><span class="annot"><span class="annottext">rayColisions :: [Obj]
</span><a href="#local-6989586621679079550"><span class="hs-identifier hs-var hs-var">rayColisions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Obj] -&gt; [Obj]
</span><a href="Main.html#antialiasing"><span class="hs-identifier hs-var">antialiasing</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679079557"><span class="hs-identifier hs-var">nRay</span></a></span><span> </span><span class="annot"><span class="annottext">[Obj]
</span><a href="#local-6989586621679079551"><span class="hs-identifier hs-var">antial</span></a></span><span>
</span><span id="line-66"></span><span>    </span><span>
</span><span id="line-67"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679079543"><span class="annot"><span class="annottext">[StdGen]
</span><a href="#local-6989586621679079543"><span class="hs-identifier hs-var">gens</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[StdGen]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [StdGen] -&gt; ([StdGen], [StdGen])
forall a. Int -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">splitAt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Obj] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Obj]
</span><a href="#local-6989586621679079550"><span class="hs-identifier hs-var">rayColisions</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679079553"><span class="hs-identifier hs-var">ppp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([StdGen] -&gt; ([StdGen], [StdGen]))
-&gt; [StdGen] -&gt; ([StdGen], [StdGen])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [StdGen] -&gt; [StdGen]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">([StdGen] -&gt; [StdGen]) -&gt; [StdGen] -&gt; [StdGen]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(StdGen -&gt; StdGen) -&gt; StdGen -&gt; [StdGen]
forall a. (a -&gt; a) -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">iterate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(StdGen, StdGen) -&gt; StdGen
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((StdGen, StdGen) -&gt; StdGen)
-&gt; (StdGen -&gt; (StdGen, StdGen)) -&gt; StdGen -&gt; StdGen
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">StdGen -&gt; (StdGen, StdGen)
forall g. RandomGen g =&gt; g -&gt; (g, g)
</span><span class="hs-identifier hs-var">split</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679079558"><span class="hs-identifier hs-var">gen</span></a></span><span>  </span><span class="hs-comment">-- Semillas</span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span>    </span><span id="local-6989586621679079553"><span class="annot"><span class="annottext">ppp :: Int
</span><a href="#local-6989586621679079553"><span class="hs-identifier hs-var hs-var">ppp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span> </span><span class="hs-comment">-- Caminos por pixel</span><span>
</span><span id="line-70"></span><span>    </span><span id="local-6989586621679079552"><span class="annot"><span class="annottext">colorIndirecto :: [RGB]
</span><a href="#local-6989586621679079552"><span class="hs-identifier hs-var hs-var">colorIndirecto</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Obj -&gt; StdGen -&gt; RGB) -&gt; [Obj] -&gt; [StdGen] -&gt; [RGB]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float -&gt; [Luz] -&gt; Set Shape -&gt; Int -&gt; Obj -&gt; StdGen -&gt; RGB
</span><a href="PathTracer.html#pathTracer"><span class="hs-identifier hs-var">pathTracer</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">[Luz]
</span><a href="#local-6989586621679079561"><span class="hs-identifier hs-var">luz</span></a></span><span> </span><span class="annot"><span class="annottext">Set Shape
</span><a href="#local-6989586621679079560"><span class="hs-identifier hs-var">figuras</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679079553"><span class="hs-identifier hs-var">ppp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Obj]
</span><a href="#local-6989586621679079550"><span class="hs-identifier hs-var">rayColisions</span></a></span><span> </span><span class="annot"><span class="annottext">[StdGen]
</span><a href="#local-6989586621679079543"><span class="hs-identifier hs-var">gens</span></a></span><span>
</span><span id="line-71"></span><span>    </span><span id="local-6989586621679079554"><span class="annot"><span class="annottext">colorDirecto :: [RGB]
</span><a href="#local-6989586621679079554"><span class="hs-identifier hs-var hs-var">colorDirecto</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Obj -&gt; RGB) -&gt; [Obj] -&gt; [RGB]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Luz] -&gt; Set Shape -&gt; Obj -&gt; RGB
</span><a href="PathTracer.html#luzDirecta"><span class="hs-identifier hs-var">luzDirecta</span></a></span><span> </span><span class="annot"><span class="annottext">[Luz]
</span><a href="#local-6989586621679079561"><span class="hs-identifier hs-var">luz</span></a></span><span> </span><span class="annot"><span class="annottext">Set Shape
</span><a href="#local-6989586621679079560"><span class="hs-identifier hs-var">figuras</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Obj]
</span><a href="#local-6989586621679079550"><span class="hs-identifier hs-var">rayColisions</span></a></span><span>
</span><span id="line-72"></span><span>    </span><span id="local-6989586621679079535"><span class="annot"><span class="annottext">colorArea :: [RGB]
</span><a href="#local-6989586621679079535"><span class="hs-identifier hs-var hs-var">colorArea</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Obj -&gt; StdGen -&gt; RGB) -&gt; [Obj] -&gt; [StdGen] -&gt; [RGB]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set Shape -&gt; Int -&gt; Obj -&gt; StdGen -&gt; RGB
</span><a href="PathTracer.html#luzArea"><span class="hs-identifier hs-var">luzArea</span></a></span><span> </span><span class="annot"><span class="annottext">Set Shape
</span><a href="#local-6989586621679079560"><span class="hs-identifier hs-var">figuras</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679079553"><span class="hs-identifier hs-var">ppp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Obj]
</span><a href="#local-6989586621679079550"><span class="hs-identifier hs-var">rayColisions</span></a></span><span> </span><span class="annot"><span class="annottext">[StdGen]
</span><a href="#local-6989586621679079543"><span class="hs-identifier hs-var">gens</span></a></span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span class="annot"><a href="Main.html#listRayPhoton"><span class="hs-identifier hs-type">listRayPhoton</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KdTree</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span> </span><span class="annot"><a href="Elem3D.html#Foton"><span class="hs-identifier hs-type">Foton</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Elem3D.html#Luz"><span class="hs-identifier hs-type">Luz</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span class="annot"><a href="Elem3D.html#Point3D"><span class="hs-identifier hs-type">Point3D</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set.Set</span></span><span> </span><span class="annot"><a href="Figuras.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Elem3D.html#Ray"><span class="hs-identifier hs-type">Ray</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Elem3D.html#RGB"><span class="hs-identifier hs-type">RGB</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-76"></span><span id="listRayPhoton"><span class="annot"><span class="annottext">listRayPhoton :: KdTree Float Foton
-&gt; [Luz] -&gt; Point3D -&gt; Set Shape -&gt; [Ray] -&gt; Int -&gt; [RGB]
</span><a href="Main.html#listRayPhoton"><span class="hs-identifier hs-var hs-var">listRayPhoton</span></a></span></span><span> </span><span id="local-6989586621679079533"><span class="annot"><span class="annottext">KdTree Float Foton
</span><a href="#local-6989586621679079533"><span class="hs-identifier hs-var">kdt</span></a></span></span><span> </span><span id="local-6989586621679079532"><span class="annot"><span class="annottext">[Luz]
</span><a href="#local-6989586621679079532"><span class="hs-identifier hs-var">luces</span></a></span></span><span> </span><span id="local-6989586621679079531"><span class="annot"><span class="annottext">Point3D
</span><a href="#local-6989586621679079531"><span class="hs-identifier hs-var">cam</span></a></span></span><span> </span><span id="local-6989586621679079530"><span class="annot"><span class="annottext">Set Shape
</span><a href="#local-6989586621679079530"><span class="hs-identifier hs-var">figuras</span></a></span></span><span> </span><span id="local-6989586621679079529"><span class="annot"><span class="annottext">[Ray]
</span><a href="#local-6989586621679079529"><span class="hs-identifier hs-var">rayos</span></a></span></span><span> </span><span id="local-6989586621679079528"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679079528"><span class="hs-identifier hs-var">nRay</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Obj -&gt; RGB) -&gt; [Obj] -&gt; [RGB]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KdTree Float Foton -&gt; [Luz] -&gt; Float -&gt; Set Shape -&gt; Obj -&gt; RGB
</span><a href="PhotonMap.html#photonMap"><span class="hs-identifier hs-var">photonMap</span></a></span><span> </span><span class="annot"><span class="annottext">KdTree Float Foton
</span><a href="#local-6989586621679079533"><span class="hs-identifier hs-var">kdt</span></a></span><span> </span><span class="annot"><span class="annottext">[Luz]
</span><a href="#local-6989586621679079532"><span class="hs-identifier hs-var">luces</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679079527"><span class="hs-identifier hs-var">radio</span></a></span><span> </span><span class="annot"><span class="annottext">Set Shape
</span><a href="#local-6989586621679079530"><span class="hs-identifier hs-var">figuras</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Obj]
</span><a href="#local-6989586621679079526"><span class="hs-identifier hs-var">rayColisions</span></a></span><span>
</span><span id="line-77"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-78"></span><span>    </span><span class="hs-glyph">!</span><span id="local-6989586621679079525"><span class="annot"><span class="annottext">raySMPP :: [Obj]
</span><a href="#local-6989586621679079525"><span class="hs-identifier hs-var hs-var">raySMPP</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Set Obj -&gt; Obj) -&gt; [Set Obj] -&gt; [Obj]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Set Obj -&gt; Obj
</span><a href="Funciones.html#listRay"><span class="hs-identifier hs-var">listRay</span></a></span><span> </span><span class="annot"><span class="annottext">([Set Obj] -&gt; [Obj]) -&gt; [Set Obj] -&gt; [Obj]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Set Shape -&gt; [Ray] -&gt; [Set Obj]
</span><a href="Figuras.html#parametricShapeCollision"><span class="hs-identifier hs-var">parametricShapeCollision</span></a></span><span> </span><span class="annot"><span class="annottext">Set Shape
</span><a href="#local-6989586621679079530"><span class="hs-identifier hs-var">figuras</span></a></span><span> </span><span class="annot"><span class="annottext">[Ray]
</span><a href="#local-6989586621679079529"><span class="hs-identifier hs-var">rayos</span></a></span><span>
</span><span id="line-79"></span><span>    </span><span id="local-6989586621679079526"><span class="annot"><span class="annottext">rayColisions :: [Obj]
</span><a href="#local-6989586621679079526"><span class="hs-identifier hs-var hs-var">rayColisions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Obj] -&gt; [Obj]
</span><a href="Main.html#antialiasing"><span class="hs-identifier hs-var">antialiasing</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679079528"><span class="hs-identifier hs-var">nRay</span></a></span><span> </span><span class="annot"><span class="annottext">[Obj]
</span><a href="#local-6989586621679079525"><span class="hs-identifier hs-var">raySMPP</span></a></span><span>
</span><span id="line-80"></span><span>    </span><span id="local-6989586621679079527"><span class="annot"><span class="annottext">radio :: Float
</span><a href="#local-6989586621679079527"><span class="hs-identifier hs-var hs-var">radio</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">3</span></span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span class="annot"><a href="Main.html#main"><span class="hs-identifier hs-type">main</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span id="main"><span class="annot"><span class="annottext">IO ()
</span><a href="Main.html#main"><span class="hs-identifier hs-var hs-var hs-var">main</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679079522"><span class="annot"><span class="annottext">[Point3D]
</span><a href="#local-6989586621679079522"><span class="hs-identifier hs-var">vertices1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679079521"><span class="annot"><span class="annottext">[TrianglePos]
</span><a href="#local-6989586621679079521"><span class="hs-identifier hs-var">triangles7</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO ([Point3D], [TrianglePos])
</span><a href="Figuras.html#loadObjFile"><span class="hs-identifier hs-var">loadObjFile</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;../meshes/simple/palace7.obj&quot;</span></span><span>  </span><span>
</span><span id="line-87"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Point3D]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679079520"><span class="annot"><span class="annottext">[TrianglePos]
</span><a href="#local-6989586621679079520"><span class="hs-identifier hs-var">triangles6</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO ([Point3D], [TrianglePos])
</span><a href="Figuras.html#loadObjFile"><span class="hs-identifier hs-var">loadObjFile</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;../meshes/simple/palace6.obj&quot;</span></span><span> </span><span>
</span><span id="line-88"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Point3D]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679079519"><span class="annot"><span class="annottext">[TrianglePos]
</span><a href="#local-6989586621679079519"><span class="hs-identifier hs-var">triangles5</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO ([Point3D], [TrianglePos])
</span><a href="Figuras.html#loadObjFile"><span class="hs-identifier hs-var">loadObjFile</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;../meshes/simple/palace5.obj&quot;</span></span><span> </span><span>
</span><span id="line-89"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Point3D]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679079518"><span class="annot"><span class="annottext">[TrianglePos]
</span><a href="#local-6989586621679079518"><span class="hs-identifier hs-var">triangles4</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO ([Point3D], [TrianglePos])
</span><a href="Figuras.html#loadObjFile"><span class="hs-identifier hs-var">loadObjFile</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;../meshes/simple/palace4.obj&quot;</span></span><span> </span><span>
</span><span id="line-90"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Point3D]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679079517"><span class="annot"><span class="annottext">[TrianglePos]
</span><a href="#local-6989586621679079517"><span class="hs-identifier hs-var">triangles3</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO ([Point3D], [TrianglePos])
</span><a href="Figuras.html#loadObjFile"><span class="hs-identifier hs-var">loadObjFile</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;../meshes/simple/palace3.obj&quot;</span></span><span> </span><span>
</span><span id="line-91"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Point3D]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679079516"><span class="annot"><span class="annottext">[TrianglePos]
</span><a href="#local-6989586621679079516"><span class="hs-identifier hs-var">triangles2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO ([Point3D], [TrianglePos])
</span><a href="Figuras.html#loadObjFile"><span class="hs-identifier hs-var">loadObjFile</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;../meshes/simple/palace2.obj&quot;</span></span><span> </span><span>
</span><span id="line-92"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Point3D]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679079515"><span class="annot"><span class="annottext">[TrianglePos]
</span><a href="#local-6989586621679079515"><span class="hs-identifier hs-var">triangles1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO ([Point3D], [TrianglePos])
</span><a href="Figuras.html#loadObjFile"><span class="hs-identifier hs-var">loadObjFile</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;../meshes/simple/palace1.obj&quot;</span></span><span> </span><span>
</span><span id="line-93"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Point3D]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679079514"><span class="annot"><span class="annottext">[TrianglePos]
</span><a href="#local-6989586621679079514"><span class="hs-identifier hs-var">triangles0</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO ([Point3D], [TrianglePos])
</span><a href="Figuras.html#loadObjFile"><span class="hs-identifier hs-var">loadObjFile</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;../meshes/simple/palace0.obj&quot;</span></span><span> </span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679079508"><span class="annot"><span class="annottext">vertices1' :: [Point3D]
</span><a href="#local-6989586621679079508"><span class="hs-identifier hs-var hs-var">vertices1'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Point3D -&gt; Point3D) -&gt; [Point3D] -&gt; [Point3D]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float -&gt; Point3D -&gt; Point3D
</span><a href="Elem3D.html#escalatePointt"><span class="hs-identifier hs-var">escalatePointt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">4</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(Point3D -&gt; Point3D) -&gt; (Point3D -&gt; Point3D) -&gt; Point3D -&gt; Point3D
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">Direction -&gt; Point3D -&gt; Point3D
</span><a href="Elem3D.html#movePoint"><span class="hs-identifier hs-var">movePoint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float -&gt; Direction
</span><a href="Elem3D.html#Direction"><span class="hs-identifier hs-var">Direction</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">7.5</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">2.5</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">9.75</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="annot"><span class="annottext">(Point3D -&gt; Point3D) -&gt; (Point3D -&gt; Point3D) -&gt; Point3D -&gt; Point3D
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Float -&gt; Point3D -&gt; Point3D
</span><a href="Elem3D.html#rotatePointt"><span class="hs-identifier hs-var">rotatePointt</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'Y'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">287.5</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Point3D]
</span><a href="#local-6989586621679079522"><span class="hs-identifier hs-var">vertices1</span></a></span><span>
</span><span id="line-96"></span><span>      </span><span class="hs-glyph">!</span><span id="local-6989586621679079507"><span class="annot"><span class="annottext">customTriangles7 :: [Triangulo]
</span><a href="#local-6989586621679079507"><span class="hs-identifier hs-var hs-var">customTriangles7</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RGB
-&gt; (Float, Float, Float)
-&gt; Float
-&gt; ([Point3D], [TrianglePos])
-&gt; [Triangulo]
</span><a href="Figuras.html#convertToCustomFormat"><span class="hs-identifier hs-var">convertToCustomFormat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float -&gt; RGB
</span><a href="Elem3D.html#RGB"><span class="hs-identifier hs-var">RGB</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">220</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">120</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">50</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0.85</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Point3D]
</span><a href="#local-6989586621679079508"><span class="hs-identifier hs-var">vertices1'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[TrianglePos]
</span><a href="#local-6989586621679079521"><span class="hs-identifier hs-var">triangles7</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span>      </span><span class="hs-glyph">!</span><span id="local-6989586621679079505"><span class="annot"><span class="annottext">customTriangles6 :: [Triangulo]
</span><a href="#local-6989586621679079505"><span class="hs-identifier hs-var hs-var">customTriangles6</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RGB
-&gt; (Float, Float, Float)
-&gt; Float
-&gt; ([Point3D], [TrianglePos])
-&gt; [Triangulo]
</span><a href="Figuras.html#convertToCustomFormat"><span class="hs-identifier hs-var">convertToCustomFormat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float -&gt; RGB
</span><a href="Elem3D.html#RGB"><span class="hs-identifier hs-var">RGB</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">220</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">120</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">50</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0.85</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Point3D]
</span><a href="#local-6989586621679079508"><span class="hs-identifier hs-var">vertices1'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[TrianglePos]
</span><a href="#local-6989586621679079520"><span class="hs-identifier hs-var">triangles6</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span>      </span><span class="hs-glyph">!</span><span id="local-6989586621679079504"><span class="annot"><span class="annottext">customTriangles5 :: [Triangulo]
</span><a href="#local-6989586621679079504"><span class="hs-identifier hs-var hs-var">customTriangles5</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RGB
-&gt; (Float, Float, Float)
-&gt; Float
-&gt; ([Point3D], [TrianglePos])
-&gt; [Triangulo]
</span><a href="Figuras.html#convertToCustomFormat"><span class="hs-identifier hs-var">convertToCustomFormat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float -&gt; RGB
</span><a href="Elem3D.html#RGB"><span class="hs-identifier hs-var">RGB</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">220</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">120</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">50</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0.85</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Point3D]
</span><a href="#local-6989586621679079508"><span class="hs-identifier hs-var">vertices1'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[TrianglePos]
</span><a href="#local-6989586621679079519"><span class="hs-identifier hs-var">triangles5</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span>      </span><span class="hs-glyph">!</span><span id="local-6989586621679079503"><span class="annot"><span class="annottext">customTriangles4 :: [Triangulo]
</span><a href="#local-6989586621679079503"><span class="hs-identifier hs-var hs-var">customTriangles4</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RGB
-&gt; (Float, Float, Float)
-&gt; Float
-&gt; ([Point3D], [TrianglePos])
-&gt; [Triangulo]
</span><a href="Figuras.html#convertToCustomFormat"><span class="hs-identifier hs-var">convertToCustomFormat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float -&gt; RGB
</span><a href="Elem3D.html#RGB"><span class="hs-identifier hs-var">RGB</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">220</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">120</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">50</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0.85</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Point3D]
</span><a href="#local-6989586621679079508"><span class="hs-identifier hs-var">vertices1'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[TrianglePos]
</span><a href="#local-6989586621679079518"><span class="hs-identifier hs-var">triangles4</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span>      </span><span class="hs-glyph">!</span><span id="local-6989586621679079502"><span class="annot"><span class="annottext">customTriangles3 :: [Triangulo]
</span><a href="#local-6989586621679079502"><span class="hs-identifier hs-var hs-var">customTriangles3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RGB
-&gt; (Float, Float, Float)
-&gt; Float
-&gt; ([Point3D], [TrianglePos])
-&gt; [Triangulo]
</span><a href="Figuras.html#convertToCustomFormat"><span class="hs-identifier hs-var">convertToCustomFormat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float -&gt; RGB
</span><a href="Elem3D.html#RGB"><span class="hs-identifier hs-var">RGB</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">220</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">120</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">50</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0.85</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Point3D]
</span><a href="#local-6989586621679079508"><span class="hs-identifier hs-var">vertices1'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[TrianglePos]
</span><a href="#local-6989586621679079517"><span class="hs-identifier hs-var">triangles3</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span>      </span><span class="hs-glyph">!</span><span id="local-6989586621679079501"><span class="annot"><span class="annottext">customTriangles2 :: [Triangulo]
</span><a href="#local-6989586621679079501"><span class="hs-identifier hs-var hs-var">customTriangles2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RGB
-&gt; (Float, Float, Float)
-&gt; Float
-&gt; ([Point3D], [TrianglePos])
-&gt; [Triangulo]
</span><a href="Figuras.html#convertToCustomFormat"><span class="hs-identifier hs-var">convertToCustomFormat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float -&gt; RGB
</span><a href="Elem3D.html#RGB"><span class="hs-identifier hs-var">RGB</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">220</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">120</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">50</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0.85</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Point3D]
</span><a href="#local-6989586621679079508"><span class="hs-identifier hs-var">vertices1'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[TrianglePos]
</span><a href="#local-6989586621679079516"><span class="hs-identifier hs-var">triangles2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span>      </span><span class="hs-glyph">!</span><span id="local-6989586621679079500"><span class="annot"><span class="annottext">customTriangles1 :: [Triangulo]
</span><a href="#local-6989586621679079500"><span class="hs-identifier hs-var hs-var">customTriangles1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RGB
-&gt; (Float, Float, Float)
-&gt; Float
-&gt; ([Point3D], [TrianglePos])
-&gt; [Triangulo]
</span><a href="Figuras.html#convertToCustomFormat"><span class="hs-identifier hs-var">convertToCustomFormat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float -&gt; RGB
</span><a href="Elem3D.html#RGB"><span class="hs-identifier hs-var">RGB</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">220</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">120</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">50</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0.85</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Point3D]
</span><a href="#local-6989586621679079508"><span class="hs-identifier hs-var">vertices1'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[TrianglePos]
</span><a href="#local-6989586621679079515"><span class="hs-identifier hs-var">triangles1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span>      </span><span class="hs-glyph">!</span><span id="local-6989586621679079499"><span class="annot"><span class="annottext">customTriangles0 :: [Triangulo]
</span><a href="#local-6989586621679079499"><span class="hs-identifier hs-var hs-var">customTriangles0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RGB
-&gt; (Float, Float, Float)
-&gt; Float
-&gt; ([Point3D], [TrianglePos])
-&gt; [Triangulo]
</span><a href="Figuras.html#convertToCustomFormat"><span class="hs-identifier hs-var">convertToCustomFormat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float -&gt; RGB
</span><a href="Elem3D.html#RGB"><span class="hs-identifier hs-var">RGB</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">220</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">120</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">50</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0.85</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Point3D]
</span><a href="#local-6989586621679079508"><span class="hs-identifier hs-var">vertices1'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[TrianglePos]
</span><a href="#local-6989586621679079514"><span class="hs-identifier hs-var">triangles0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-104"></span><span>      </span><span class="hs-glyph">!</span><span id="local-6989586621679079498"><span class="annot"><span class="annottext">boundingVol7 :: BVH
</span><a href="#local-6989586621679079498"><span class="hs-identifier hs-var hs-var">boundingVol7</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Triangulo] -&gt; BVH
</span><a href="Figuras.html#buildBVH"><span class="hs-identifier hs-var">buildBVH</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1000</span></span><span> </span><span class="annot"><span class="annottext">[Triangulo]
</span><a href="#local-6989586621679079507"><span class="hs-identifier hs-var">customTriangles7</span></a></span><span>
</span><span id="line-105"></span><span>      </span><span class="hs-glyph">!</span><span id="local-6989586621679079497"><span class="annot"><span class="annottext">boundingVol6 :: BVH
</span><a href="#local-6989586621679079497"><span class="hs-identifier hs-var hs-var">boundingVol6</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Triangulo] -&gt; BVH
</span><a href="Figuras.html#buildBVH"><span class="hs-identifier hs-var">buildBVH</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2000</span></span><span> </span><span class="annot"><span class="annottext">[Triangulo]
</span><a href="#local-6989586621679079505"><span class="hs-identifier hs-var">customTriangles6</span></a></span><span>
</span><span id="line-106"></span><span>      </span><span class="hs-glyph">!</span><span id="local-6989586621679079496"><span class="annot"><span class="annottext">boundingVol5 :: BVH
</span><a href="#local-6989586621679079496"><span class="hs-identifier hs-var hs-var">boundingVol5</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Triangulo] -&gt; BVH
</span><a href="Figuras.html#buildBVH"><span class="hs-identifier hs-var">buildBVH</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3000</span></span><span> </span><span class="annot"><span class="annottext">[Triangulo]
</span><a href="#local-6989586621679079504"><span class="hs-identifier hs-var">customTriangles5</span></a></span><span>
</span><span id="line-107"></span><span>      </span><span class="hs-glyph">!</span><span id="local-6989586621679079495"><span class="annot"><span class="annottext">boundingVol4 :: BVH
</span><a href="#local-6989586621679079495"><span class="hs-identifier hs-var hs-var">boundingVol4</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Triangulo] -&gt; BVH
</span><a href="Figuras.html#buildBVH"><span class="hs-identifier hs-var">buildBVH</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4000</span></span><span> </span><span class="annot"><span class="annottext">[Triangulo]
</span><a href="#local-6989586621679079503"><span class="hs-identifier hs-var">customTriangles4</span></a></span><span>
</span><span id="line-108"></span><span>      </span><span class="hs-glyph">!</span><span id="local-6989586621679079494"><span class="annot"><span class="annottext">boundingVol3 :: BVH
</span><a href="#local-6989586621679079494"><span class="hs-identifier hs-var hs-var">boundingVol3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Triangulo] -&gt; BVH
</span><a href="Figuras.html#buildBVH"><span class="hs-identifier hs-var">buildBVH</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5000</span></span><span> </span><span class="annot"><span class="annottext">[Triangulo]
</span><a href="#local-6989586621679079502"><span class="hs-identifier hs-var">customTriangles3</span></a></span><span>
</span><span id="line-109"></span><span>      </span><span class="hs-glyph">!</span><span id="local-6989586621679079493"><span class="annot"><span class="annottext">boundingVol2 :: BVH
</span><a href="#local-6989586621679079493"><span class="hs-identifier hs-var hs-var">boundingVol2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Triangulo] -&gt; BVH
</span><a href="Figuras.html#buildBVH"><span class="hs-identifier hs-var">buildBVH</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">6000</span></span><span> </span><span class="annot"><span class="annottext">[Triangulo]
</span><a href="#local-6989586621679079501"><span class="hs-identifier hs-var">customTriangles2</span></a></span><span>
</span><span id="line-110"></span><span>      </span><span class="hs-glyph">!</span><span id="local-6989586621679079492"><span class="annot"><span class="annottext">boundingVol1 :: BVH
</span><a href="#local-6989586621679079492"><span class="hs-identifier hs-var hs-var">boundingVol1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Triangulo] -&gt; BVH
</span><a href="Figuras.html#buildBVH"><span class="hs-identifier hs-var">buildBVH</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">7000</span></span><span> </span><span class="annot"><span class="annottext">[Triangulo]
</span><a href="#local-6989586621679079500"><span class="hs-identifier hs-var">customTriangles1</span></a></span><span>
</span><span id="line-111"></span><span>      </span><span class="hs-glyph">!</span><span id="local-6989586621679079491"><span class="annot"><span class="annottext">boundingVol0 :: BVH
</span><a href="#local-6989586621679079491"><span class="hs-identifier hs-var hs-var">boundingVol0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Triangulo] -&gt; BVH
</span><a href="Figuras.html#buildBVH"><span class="hs-identifier hs-var">buildBVH</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8000</span></span><span> </span><span class="annot"><span class="annottext">[Triangulo]
</span><a href="#local-6989586621679079499"><span class="hs-identifier hs-var">customTriangles0</span></a></span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span>      </span><span id="local-6989586621679079488"><span class="annot"><span class="annottext">figuras' :: Set Shape
</span><a href="#local-6989586621679079488"><span class="hs-identifier hs-var hs-var">figuras'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">[Shape] -&gt; Set Shape
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">Set.fromList</span></span><span> </span><span class="annot"><span class="annottext">([Shape] -&gt; Set Shape) -&gt; [Shape] -&gt; Set Shape
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Shape] -&gt; [Shape] -&gt; [Shape]
</span><a href="Figuras.html#addFigMult"><span class="hs-identifier hs-var">addFigMult</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">BVH -&gt; Shape
</span><a href="Figuras.html#Acelerator"><span class="hs-identifier hs-var">Acelerator</span></a></span><span> </span><span class="annot"><span class="annottext">BVH
</span><a href="#local-6989586621679079491"><span class="hs-identifier hs-var">boundingVol0</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">BVH -&gt; Shape
</span><a href="Figuras.html#Acelerator"><span class="hs-identifier hs-var">Acelerator</span></a></span><span> </span><span class="annot"><span class="annottext">BVH
</span><a href="#local-6989586621679079492"><span class="hs-identifier hs-var">boundingVol1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">BVH -&gt; Shape
</span><a href="Figuras.html#Acelerator"><span class="hs-identifier hs-var">Acelerator</span></a></span><span> </span><span class="annot"><span class="annottext">BVH
</span><a href="#local-6989586621679079493"><span class="hs-identifier hs-var">boundingVol2</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">BVH -&gt; Shape
</span><a href="Figuras.html#Acelerator"><span class="hs-identifier hs-var">Acelerator</span></a></span><span> </span><span class="annot"><span class="annottext">BVH
</span><a href="#local-6989586621679079494"><span class="hs-identifier hs-var">boundingVol3</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">BVH -&gt; Shape
</span><a href="Figuras.html#Acelerator"><span class="hs-identifier hs-var">Acelerator</span></a></span><span> </span><span class="annot"><span class="annottext">BVH
</span><a href="#local-6989586621679079495"><span class="hs-identifier hs-var">boundingVol4</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">BVH -&gt; Shape
</span><a href="Figuras.html#Acelerator"><span class="hs-identifier hs-var">Acelerator</span></a></span><span> </span><span class="annot"><span class="annottext">BVH
</span><a href="#local-6989586621679079496"><span class="hs-identifier hs-var">boundingVol5</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">BVH -&gt; Shape
</span><a href="Figuras.html#Acelerator"><span class="hs-identifier hs-var">Acelerator</span></a></span><span> </span><span class="annot"><span class="annottext">BVH
</span><a href="#local-6989586621679079497"><span class="hs-identifier hs-var">boundingVol6</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">BVH -&gt; Shape
</span><a href="Figuras.html#Acelerator"><span class="hs-identifier hs-var">Acelerator</span></a></span><span> </span><span class="annot"><span class="annottext">BVH
</span><a href="#local-6989586621679079498"><span class="hs-identifier hs-var">boundingVol7</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">([Shape] -&gt; [Shape]) -&gt; [Shape] -&gt; [Shape]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Set Shape -&gt; [Shape]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">Set.toList</span></span><span> </span><span class="annot"><span class="annottext">Set Shape
</span><a href="Escena.html#figuras"><span class="hs-identifier hs-var">figuras</span></a></span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679079485"><span class="annot"><span class="annottext">[Point3D]
</span><a href="#local-6989586621679079485"><span class="hs-identifier hs-var">verticesB1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679079484"><span class="annot"><span class="annottext">[TrianglePos]
</span><a href="#local-6989586621679079484"><span class="hs-identifier hs-var">trianglesB0</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO ([Point3D], [TrianglePos])
</span><a href="Figuras.html#loadObjFile"><span class="hs-identifier hs-var">loadObjFile</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;../meshes/simple/botijo0.obj&quot;</span></span><span>  </span><span>
</span><span id="line-116"></span><span>  </span><span>
</span><span id="line-117"></span><span>
</span><span id="line-118"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679079481"><span class="annot"><span class="annottext">verticesB1' :: [Point3D]
</span><a href="#local-6989586621679079481"><span class="hs-identifier hs-var hs-var">verticesB1'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Point3D -&gt; Point3D) -&gt; [Point3D] -&gt; [Point3D]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float -&gt; Point3D -&gt; Point3D
</span><a href="Elem3D.html#escalatePointt"><span class="hs-identifier hs-var">escalatePointt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">4</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(Point3D -&gt; Point3D) -&gt; (Point3D -&gt; Point3D) -&gt; Point3D -&gt; Point3D
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">Direction -&gt; Point3D -&gt; Point3D
</span><a href="Elem3D.html#movePoint"><span class="hs-identifier hs-var">movePoint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float -&gt; Direction
</span><a href="Elem3D.html#Direction"><span class="hs-identifier hs-var">Direction</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="annot"><span class="annottext">(Point3D -&gt; Point3D) -&gt; (Point3D -&gt; Point3D) -&gt; Point3D -&gt; Point3D
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Float -&gt; Point3D -&gt; Point3D
</span><a href="Elem3D.html#rotatePointt"><span class="hs-identifier hs-var">rotatePointt</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'Y'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Point3D]
</span><a href="#local-6989586621679079485"><span class="hs-identifier hs-var">verticesB1</span></a></span><span>
</span><span id="line-119"></span><span>      </span><span class="hs-glyph">!</span><span id="local-6989586621679079480"><span class="annot"><span class="annottext">customTrianglesB0 :: [Triangulo]
</span><a href="#local-6989586621679079480"><span class="hs-identifier hs-var hs-var">customTrianglesB0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RGB
-&gt; (Float, Float, Float)
-&gt; Float
-&gt; ([Point3D], [TrianglePos])
-&gt; [Triangulo]
</span><a href="Figuras.html#convertToCustomFormat"><span class="hs-identifier hs-var">convertToCustomFormat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float -&gt; RGB
</span><a href="Elem3D.html#RGB"><span class="hs-identifier hs-var">RGB</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">220</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">120</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">50</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0.85</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Point3D]
</span><a href="#local-6989586621679079481"><span class="hs-identifier hs-var">verticesB1'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[TrianglePos]
</span><a href="#local-6989586621679079484"><span class="hs-identifier hs-var">trianglesB0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span>      </span><span class="hs-glyph">!</span><span id="local-6989586621679079479"><span class="annot"><span class="annottext">boundingVolB0 :: BVH
</span><a href="#local-6989586621679079479"><span class="hs-identifier hs-var hs-var">boundingVolB0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Triangulo] -&gt; BVH
</span><a href="Figuras.html#buildBVH"><span class="hs-identifier hs-var">buildBVH</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1000</span></span><span> </span><span class="annot"><span class="annottext">[Triangulo]
</span><a href="#local-6989586621679079480"><span class="hs-identifier hs-var">customTrianglesB0</span></a></span><span>
</span><span id="line-121"></span><span>      </span><span class="hs-glyph">!</span><span id="local-6989586621679079476"><span class="annot"><span class="annottext">customTrianglesB1 :: [Triangulo]
</span><a href="#local-6989586621679079476"><span class="hs-identifier hs-var hs-var">customTrianglesB1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RGB
-&gt; (Float, Float, Float)
-&gt; Float
-&gt; ([Point3D], [TrianglePos])
-&gt; [Triangulo]
</span><a href="Figuras.html#convertToCustomFormat"><span class="hs-identifier hs-var">convertToCustomFormat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float -&gt; RGB
</span><a href="Elem3D.html#RGB"><span class="hs-identifier hs-var">RGB</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">220</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">120</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">50</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0.85</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Point3D -&gt; Point3D) -&gt; [Point3D] -&gt; [Point3D]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Direction -&gt; Point3D -&gt; Point3D
</span><a href="Elem3D.html#movePoint"><span class="hs-identifier hs-var">movePoint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float -&gt; Direction
</span><a href="Elem3D.html#Direction"><span class="hs-identifier hs-var">Direction</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Point3D]
</span><a href="#local-6989586621679079481"><span class="hs-identifier hs-var">verticesB1'</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[TrianglePos]
</span><a href="#local-6989586621679079484"><span class="hs-identifier hs-var">trianglesB0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-122"></span><span>      </span><span class="hs-glyph">!</span><span id="local-6989586621679079475"><span class="annot"><span class="annottext">boundingVolB1 :: BVH
</span><a href="#local-6989586621679079475"><span class="hs-identifier hs-var hs-var">boundingVolB1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Triangulo] -&gt; BVH
</span><a href="Figuras.html#buildBVH"><span class="hs-identifier hs-var">buildBVH</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1000</span></span><span> </span><span class="annot"><span class="annottext">[Triangulo]
</span><a href="#local-6989586621679079476"><span class="hs-identifier hs-var">customTrianglesB1</span></a></span><span>
</span><span id="line-123"></span><span>      </span><span class="hs-glyph">!</span><span id="local-6989586621679079472"><span class="annot"><span class="annottext">customTrianglesB2 :: [Triangulo]
</span><a href="#local-6989586621679079472"><span class="hs-identifier hs-var hs-var">customTrianglesB2</span></a></span></span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RGB
-&gt; (Float, Float, Float)
-&gt; Float
-&gt; ([Point3D], [TrianglePos])
-&gt; [Triangulo]
</span><a href="Figuras.html#convertToCustomFormat"><span class="hs-identifier hs-var">convertToCustomFormat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float -&gt; RGB
</span><a href="Elem3D.html#RGB"><span class="hs-identifier hs-var">RGB</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">20</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">120</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">220</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0.85</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Point3D -&gt; Point3D) -&gt; [Point3D] -&gt; [Point3D]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Direction -&gt; Point3D -&gt; Point3D
</span><a href="Elem3D.html#movePoint"><span class="hs-identifier hs-var">movePoint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float -&gt; Direction
</span><a href="Elem3D.html#Direction"><span class="hs-identifier hs-var">Direction</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Point3D]
</span><a href="#local-6989586621679079481"><span class="hs-identifier hs-var">verticesB1'</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[TrianglePos]
</span><a href="#local-6989586621679079484"><span class="hs-identifier hs-var">trianglesB0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span>      </span><span class="hs-glyph">!</span><span id="local-6989586621679079471"><span class="annot"><span class="annottext">boundingVolB2 :: BVH
</span><a href="#local-6989586621679079471"><span class="hs-identifier hs-var hs-var">boundingVolB2</span></a></span></span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Triangulo] -&gt; BVH
</span><a href="Figuras.html#buildBVH"><span class="hs-identifier hs-var">buildBVH</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1000</span></span><span> </span><span class="annot"><span class="annottext">[Triangulo]
</span><a href="#local-6989586621679079472"><span class="hs-identifier hs-var">customTrianglesB2</span></a></span><span>
</span><span id="line-125"></span><span>      </span><span class="hs-glyph">!</span><span id="local-6989586621679079468"><span class="annot"><span class="annottext">customTrianglesB3 :: [Triangulo]
</span><a href="#local-6989586621679079468"><span class="hs-identifier hs-var hs-var">customTrianglesB3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RGB
-&gt; (Float, Float, Float)
-&gt; Float
-&gt; ([Point3D], [TrianglePos])
-&gt; [Triangulo]
</span><a href="Figuras.html#convertToCustomFormat"><span class="hs-identifier hs-var">convertToCustomFormat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float -&gt; RGB
</span><a href="Elem3D.html#RGB"><span class="hs-identifier hs-var">RGB</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">120</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">220</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">50</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0.85</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Point3D -&gt; Point3D) -&gt; [Point3D] -&gt; [Point3D]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Direction -&gt; Point3D -&gt; Point3D
</span><a href="Elem3D.html#movePoint"><span class="hs-identifier hs-var">movePoint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float -&gt; Direction
</span><a href="Elem3D.html#Direction"><span class="hs-identifier hs-var">Direction</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">4</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span class="annot"><span class="annottext">[Point3D]
</span><a href="#local-6989586621679079481"><span class="hs-identifier hs-var">verticesB1'</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[TrianglePos]
</span><a href="#local-6989586621679079484"><span class="hs-identifier hs-var">trianglesB0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span>      </span><span class="hs-glyph">!</span><span id="local-6989586621679079467"><span class="annot"><span class="annottext">boundingVolB3 :: BVH
</span><a href="#local-6989586621679079467"><span class="hs-identifier hs-var hs-var">boundingVolB3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Triangulo] -&gt; BVH
</span><a href="Figuras.html#buildBVH"><span class="hs-identifier hs-var">buildBVH</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1000</span></span><span> </span><span class="annot"><span class="annottext">[Triangulo]
</span><a href="#local-6989586621679079468"><span class="hs-identifier hs-var">customTrianglesB3</span></a></span><span>
</span><span id="line-127"></span><span>      </span><span class="hs-glyph">!</span><span id="local-6989586621679079464"><span class="annot"><span class="annottext">customTrianglesB4 :: [Triangulo]
</span><a href="#local-6989586621679079464"><span class="hs-identifier hs-var hs-var">customTrianglesB4</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RGB
-&gt; (Float, Float, Float)
-&gt; Float
-&gt; ([Point3D], [TrianglePos])
-&gt; [Triangulo]
</span><a href="Figuras.html#convertToCustomFormat"><span class="hs-identifier hs-var">convertToCustomFormat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float -&gt; RGB
</span><a href="Elem3D.html#RGB"><span class="hs-identifier hs-var">RGB</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">100</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">120</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">200</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0.85</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Point3D -&gt; Point3D) -&gt; [Point3D] -&gt; [Point3D]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Direction -&gt; Point3D -&gt; Point3D
</span><a href="Elem3D.html#movePoint"><span class="hs-identifier hs-var">movePoint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float -&gt; Direction
</span><a href="Elem3D.html#Direction"><span class="hs-identifier hs-var">Direction</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">5</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span class="annot"><span class="annottext">[Point3D]
</span><a href="#local-6989586621679079481"><span class="hs-identifier hs-var">verticesB1'</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[TrianglePos]
</span><a href="#local-6989586621679079484"><span class="hs-identifier hs-var">trianglesB0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-128"></span><span>      </span><span class="hs-glyph">!</span><span id="local-6989586621679079463"><span class="annot"><span class="annottext">boundingVolB4 :: BVH
</span><a href="#local-6989586621679079463"><span class="hs-identifier hs-var hs-var">boundingVolB4</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Triangulo] -&gt; BVH
</span><a href="Figuras.html#buildBVH"><span class="hs-identifier hs-var">buildBVH</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1000</span></span><span> </span><span class="annot"><span class="annottext">[Triangulo]
</span><a href="#local-6989586621679079464"><span class="hs-identifier hs-var">customTrianglesB4</span></a></span><span>
</span><span id="line-129"></span><span>      </span><span class="hs-glyph">!</span><span id="local-6989586621679079460"><span class="annot"><span class="annottext">customTrianglesB5 :: [Triangulo]
</span><a href="#local-6989586621679079460"><span class="hs-identifier hs-var hs-var">customTrianglesB5</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RGB
-&gt; (Float, Float, Float)
-&gt; Float
-&gt; ([Point3D], [TrianglePos])
-&gt; [Triangulo]
</span><a href="Figuras.html#convertToCustomFormat"><span class="hs-identifier hs-var">convertToCustomFormat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float -&gt; RGB
</span><a href="Elem3D.html#RGB"><span class="hs-identifier hs-var">RGB</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">220</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0.85</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Point3D -&gt; Point3D) -&gt; [Point3D] -&gt; [Point3D]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Direction -&gt; Point3D -&gt; Point3D
</span><a href="Elem3D.html#movePoint"><span class="hs-identifier hs-var">movePoint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float -&gt; Direction
</span><a href="Elem3D.html#Direction"><span class="hs-identifier hs-var">Direction</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">15</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span class="annot"><span class="annottext">[Point3D]
</span><a href="#local-6989586621679079481"><span class="hs-identifier hs-var">verticesB1'</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[TrianglePos]
</span><a href="#local-6989586621679079484"><span class="hs-identifier hs-var">trianglesB0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-130"></span><span>      </span><span class="hs-glyph">!</span><span id="local-6989586621679079459"><span class="annot"><span class="annottext">boundingVolB5 :: BVH
</span><a href="#local-6989586621679079459"><span class="hs-identifier hs-var hs-var">boundingVolB5</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Triangulo] -&gt; BVH
</span><a href="Figuras.html#buildBVH"><span class="hs-identifier hs-var">buildBVH</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1000</span></span><span> </span><span class="annot"><span class="annottext">[Triangulo]
</span><a href="#local-6989586621679079460"><span class="hs-identifier hs-var">customTrianglesB5</span></a></span><span>
</span><span id="line-131"></span><span>      </span><span id="local-6989586621679079457"><span class="annot"><span class="annottext">figuras'' :: Set Shape
</span><a href="#local-6989586621679079457"><span class="hs-identifier hs-var hs-var">figuras''</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">[Shape] -&gt; Set Shape
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">Set.fromList</span></span><span> </span><span class="annot"><span class="annottext">([Shape] -&gt; Set Shape) -&gt; [Shape] -&gt; Set Shape
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Shape] -&gt; [Shape] -&gt; [Shape]
</span><a href="Figuras.html#addFigMult"><span class="hs-identifier hs-var">addFigMult</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">BVH -&gt; Shape
</span><a href="Figuras.html#Acelerator"><span class="hs-identifier hs-var">Acelerator</span></a></span><span> </span><span class="annot"><span class="annottext">BVH
</span><a href="#local-6989586621679079479"><span class="hs-identifier hs-var">boundingVolB0</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">BVH -&gt; Shape
</span><a href="Figuras.html#Acelerator"><span class="hs-identifier hs-var">Acelerator</span></a></span><span> </span><span class="annot"><span class="annottext">BVH
</span><a href="#local-6989586621679079475"><span class="hs-identifier hs-var">boundingVolB1</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">BVH -&gt; Shape
</span><a href="Figuras.html#Acelerator"><span class="hs-identifier hs-var">Acelerator</span></a></span><span> </span><span class="annot"><span class="annottext">BVH
</span><a href="#local-6989586621679079471"><span class="hs-identifier hs-var">boundingVolB2</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">BVH -&gt; Shape
</span><a href="Figuras.html#Acelerator"><span class="hs-identifier hs-var">Acelerator</span></a></span><span> </span><span class="annot"><span class="annottext">BVH
</span><a href="#local-6989586621679079467"><span class="hs-identifier hs-var">boundingVolB3</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">BVH -&gt; Shape
</span><a href="Figuras.html#Acelerator"><span class="hs-identifier hs-var">Acelerator</span></a></span><span> </span><span class="annot"><span class="annottext">BVH
</span><a href="#local-6989586621679079463"><span class="hs-identifier hs-var">boundingVolB4</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">BVH -&gt; Shape
</span><a href="Figuras.html#Acelerator"><span class="hs-identifier hs-var">Acelerator</span></a></span><span> </span><span class="annot"><span class="annottext">BVH
</span><a href="#local-6989586621679079459"><span class="hs-identifier hs-var">boundingVolB5</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">([Shape] -&gt; [Shape]) -&gt; [Shape] -&gt; [Shape]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Set Shape -&gt; [Shape]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">Set.toList</span></span><span> </span><span class="annot"><span class="annottext">Set Shape
</span><a href="#local-6989586621679079488"><span class="hs-identifier hs-var">figuras'</span></a></span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679079456"><span class="annot"><span class="annottext">objFilePath2 :: FilePath
</span><a href="#local-6989586621679079456"><span class="hs-identifier hs-var hs-var">objFilePath2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;../meshes/simplehaskell.obj&quot;</span></span><span>  </span><span>
</span><span id="line-134"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679079455"><span class="annot"><span class="annottext">[Point3D]
</span><a href="#local-6989586621679079455"><span class="hs-identifier hs-var">vertices2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679079454"><span class="annot"><span class="annottext">[TrianglePos]
</span><a href="#local-6989586621679079454"><span class="hs-identifier hs-var">trianglesH2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO ([Point3D], [TrianglePos])
</span><a href="Figuras.html#loadObjFile"><span class="hs-identifier hs-var">loadObjFile</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679079456"><span class="hs-identifier hs-var">objFilePath2</span></a></span><span>
</span><span id="line-135"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679079447"><span class="annot"><span class="annottext">vertices2' :: [Point3D]
</span><a href="#local-6989586621679079447"><span class="hs-identifier hs-var hs-var">vertices2'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Point3D -&gt; Point3D) -&gt; [Point3D] -&gt; [Point3D]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float -&gt; Point3D -&gt; Point3D
</span><a href="Elem3D.html#escalatePointt"><span class="hs-identifier hs-var">escalatePointt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(Point3D -&gt; Point3D) -&gt; (Point3D -&gt; Point3D) -&gt; Point3D -&gt; Point3D
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">Direction -&gt; Point3D -&gt; Point3D
</span><a href="Elem3D.html#movePoint"><span class="hs-identifier hs-var">movePoint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float -&gt; Direction
</span><a href="Elem3D.html#Direction"><span class="hs-identifier hs-var">Direction</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">5</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">5</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">28</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="annot"><span class="annottext">(Point3D -&gt; Point3D) -&gt; (Point3D -&gt; Point3D) -&gt; Point3D -&gt; Point3D
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Float -&gt; Point3D -&gt; Point3D
</span><a href="Elem3D.html#rotatePointt"><span class="hs-identifier hs-var">rotatePointt</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'Y'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">90</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Point3D]
</span><a href="#local-6989586621679079455"><span class="hs-identifier hs-var">vertices2</span></a></span><span>
</span><span id="line-136"></span><span>      </span><span id="local-6989586621679079446"><span class="annot"><span class="annottext">customTrianglesH2 :: [Triangulo]
</span><a href="#local-6989586621679079446"><span class="hs-identifier hs-var hs-var">customTrianglesH2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RGB
-&gt; (Float, Float, Float)
-&gt; Float
-&gt; ([Point3D], [TrianglePos])
-&gt; [Triangulo]
</span><a href="Figuras.html#convertToCustomFormat"><span class="hs-identifier hs-var">convertToCustomFormat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float -&gt; RGB
</span><a href="Elem3D.html#RGB"><span class="hs-identifier hs-var">RGB</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">122</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">255</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0.85</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Point3D]
</span><a href="#local-6989586621679079447"><span class="hs-identifier hs-var">vertices2'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[TrianglePos]
</span><a href="#local-6989586621679079454"><span class="hs-identifier hs-var">trianglesH2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span>      </span><span id="local-6989586621679079445"><span class="annot"><span class="annottext">boundingVol'' :: BVH
</span><a href="#local-6989586621679079445"><span class="hs-identifier hs-var hs-var">boundingVol''</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Triangulo] -&gt; BVH
</span><a href="Figuras.html#buildBVH"><span class="hs-identifier hs-var">buildBVH</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4000</span></span><span> </span><span class="annot"><span class="annottext">[Triangulo]
</span><a href="#local-6989586621679079446"><span class="hs-identifier hs-var">customTrianglesH2</span></a></span><span>
</span><span id="line-138"></span><span>      </span><span id="local-6989586621679079443"><span class="annot"><span class="annottext">figuras''' :: Set Shape
</span><a href="#local-6989586621679079443"><span class="hs-identifier hs-var hs-var">figuras'''</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">[Shape] -&gt; Set Shape
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">Set.fromList</span></span><span> </span><span class="annot"><span class="annottext">([Shape] -&gt; Set Shape) -&gt; [Shape] -&gt; Set Shape
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Shape] -&gt; [Shape] -&gt; [Shape]
</span><a href="Figuras.html#addFigMult"><span class="hs-identifier hs-var">addFigMult</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">BVH -&gt; Shape
</span><a href="Figuras.html#Acelerator"><span class="hs-identifier hs-var">Acelerator</span></a></span><span> </span><span class="annot"><span class="annottext">BVH
</span><a href="#local-6989586621679079445"><span class="hs-identifier hs-var">boundingVol''</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set Shape -&gt; [Shape]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">Set.toList</span></span><span> </span><span class="annot"><span class="annottext">Set Shape
</span><a href="#local-6989586621679079457"><span class="hs-identifier hs-var">figuras''</span></a></span><span class="hs-special">)</span><span>    </span><span>
</span><span id="line-139"></span><span>    </span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span>  </span><span>
</span><span id="line-142"></span><span>  </span><span id="local-6989586621679079442"><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679079442"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO [FilePath]
</span><span class="hs-identifier hs-var">getArgs</span></span><span>
</span><span id="line-143"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; Maybe Int) -&gt; [FilePath] -&gt; [Maybe Int]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Maybe Int
forall a. Read a =&gt; FilePath -&gt; Maybe a
</span><span class="hs-identifier hs-var">readMaybe</span></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679079442"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-144"></span><span>    </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679079441"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679079441"><span class="hs-identifier hs-var">nStr</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679079440"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679079440"><span class="hs-identifier hs-var">mStr</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679079439"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679079439"><span class="hs-identifier hs-var">oStr</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-145"></span><span>      </span><span id="local-6989586621679079438"><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679079438"><span class="hs-identifier hs-var">gen</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO StdGen
forall (m :: * -&gt; *). MonadIO m =&gt; m StdGen
</span><span class="hs-identifier hs-var">newStdGen</span></span><span>
</span><span id="line-146"></span><span>      </span><span id="local-6989586621679079437"><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679079437"><span class="hs-identifier hs-var">gen'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO StdGen
forall (m :: * -&gt; *). MonadIO m =&gt; m StdGen
</span><span class="hs-identifier hs-var">newStdGen</span></span><span>
</span><span id="line-147"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679079436"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679079436"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679079441"><span class="hs-identifier hs-var">nStr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-148"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679079435"><span class="annot"><span class="annottext">etapaY :: Int
</span><a href="#local-6989586621679079435"><span class="hs-identifier hs-var hs-var">etapaY</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679079440"><span class="hs-identifier hs-var">mStr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-149"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679079434"><span class="annot"><span class="annottext">etapaX :: Int
</span><a href="#local-6989586621679079434"><span class="hs-identifier hs-var hs-var">etapaX</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679079439"><span class="hs-identifier hs-var">oStr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-150"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679079431"><span class="annot"><span class="annottext">n' :: Int
</span><a href="#local-6989586621679079431"><span class="hs-identifier hs-var hs-var">n'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679079436"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679079435"><span class="hs-identifier hs-var">etapaY</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Escena.html#maxN"><span class="hs-identifier hs-var">maxN</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span>      </span><span class="annot"><span class="annottext">FilePath -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO ()) -&gt; FilePath -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;The value of 'n' is: &quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679079431"><span class="hs-identifier hs-var">n'</span></a></span><span>
</span><span id="line-152"></span><span>      </span><span id="local-6989586621679079427"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679079427"><span class="hs-identifier hs-var">start</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO Integer
</span><span class="hs-identifier hs-var">getCPUTime</span></span><span>
</span><span id="line-153"></span><span>      </span><span>
</span><span id="line-154"></span><span>      </span><span>
</span><span id="line-155"></span><span>      </span><span id="local-6989586621679079426"><span class="annot"><span class="annottext">[Foton]
</span><a href="#local-6989586621679079426"><span class="hs-identifier hs-var">notkdt</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO [Foton]
forall a. Binary a =&gt; FilePath -&gt; IO a
</span><a href="Files.html#readObject"><span class="hs-identifier hs-var">readObject</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;./kd.bin&quot;</span></span><span> </span><span class="hs-comment">-- Carga la lista de fotones del binario</span><span>
</span><span id="line-156"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679079425"><span class="annot"><span class="annottext">kdt :: KdTree Float Foton
</span><a href="#local-6989586621679079425"><span class="hs-identifier hs-var hs-var">kdt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Foton] -&gt; KdTree Float Foton
</span><a href="KdT.html#createKD"><span class="hs-identifier hs-var">createKD</span></a></span><span> </span><span class="annot"><span class="annottext">[Foton]
</span><a href="#local-6989586621679079426"><span class="hs-identifier hs-var">notkdt</span></a></span><span> </span><span class="hs-comment">-- Crea el kdtree</span><span>
</span><span id="line-157"></span><span>
</span><span id="line-158"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679079424"><span class="annot"><span class="annottext">cams :: [Camara]
</span><a href="#local-6989586621679079424"><span class="hs-identifier hs-var hs-var">cams</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Camara -&gt; Int -&gt; Float -&gt; [Camara]
</span><a href="Funciones.html#mulCam"><span class="hs-identifier hs-var">mulCam</span></a></span><span> </span><span class="annot"><span class="annottext">Camara
</span><a href="Escena.html#camara"><span class="hs-identifier hs-var">camara</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">0.75</span></span><span class="hs-comment">-- El primer n&#250;mero indica el n&#250;mero de muestras que se toman desde la c&#225;mara, el segundo el radio de apertura</span><span>
</span><span id="line-159"></span><span>          </span><span id="local-6989586621679079420"><span class="annot"><span class="annottext">rayitos :: [[Ray]]
</span><a href="#local-6989586621679079420"><span class="hs-identifier hs-var hs-var">rayitos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Camara -&gt; [Ray]) -&gt; [Camara] -&gt; [[Ray]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679079419"><span class="annot"><span class="annottext">Camara
</span><a href="#local-6989586621679079419"><span class="hs-identifier hs-var">camara</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; Int
-&gt; Int
-&gt; Int
-&gt; Camara
-&gt; Float
-&gt; Float
-&gt; Int
-&gt; StdGen
-&gt; [Ray]
</span><a href="Funciones.html#generateRaysForPixels"><span class="hs-identifier hs-var">generateRaysForPixels</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="Escena.html#maxN"><span class="hs-identifier hs-var">maxN</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Int
</span><a href="Escena.html#etapasY"><span class="hs-identifier hs-var">etapasY</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Escena.html#etapasX"><span class="hs-identifier hs-var">etapasX</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679079431"><span class="hs-identifier hs-var">n'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679079434"><span class="hs-identifier hs-var">etapaX</span></a></span><span> </span><span class="annot"><span class="annottext">Camara
</span><a href="#local-6989586621679079419"><span class="hs-identifier hs-var">camara</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><a href="Escena.html#pix"><span class="hs-identifier hs-var">pix</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Float
</span><a href="Escena.html#aspectR"><span class="hs-identifier hs-var">aspectR</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="Escena.html#pix"><span class="hs-identifier hs-var">pix</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Escena.html#nRay"><span class="hs-identifier hs-var">nRay</span></a></span><span> </span><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679079438"><span class="hs-identifier hs-var">gen</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Camara]
</span><a href="#local-6989586621679079424"><span class="hs-identifier hs-var">cams</span></a></span><span> </span><span class="hs-comment">-- Genera los rayos para cada pixel</span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span>          </span><span id="local-6989586621679079413"><span class="annot"><span class="annottext">a :: [[RGB]]
</span><a href="#local-6989586621679079413"><span class="hs-identifier hs-var hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Ray] -&gt; [RGB]) -&gt; [[Ray]] -&gt; [[RGB]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679079412"><span class="annot"><span class="annottext">[Ray]
</span><a href="#local-6989586621679079412"><span class="hs-identifier hs-var">rayos</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">KdTree Float Foton
-&gt; [Luz] -&gt; Point3D -&gt; Set Shape -&gt; [Ray] -&gt; Int -&gt; [RGB]
</span><a href="Main.html#listRayPhoton"><span class="hs-identifier hs-var">listRayPhoton</span></a></span><span> </span><span class="annot"><span class="annottext">KdTree Float Foton
</span><a href="#local-6989586621679079425"><span class="hs-identifier hs-var">kdt</span></a></span><span> </span><span class="annot"><span class="annottext">[Luz]
</span><a href="Escena.html#luces"><span class="hs-identifier hs-var">luces</span></a></span><span> </span><span class="annot"><span class="annottext">Point3D
</span><a href="Escena.html#cam"><span class="hs-identifier hs-var">cam</span></a></span><span> </span><span class="annot"><span class="annottext">Set Shape
</span><a href="#local-6989586621679079443"><span class="hs-identifier hs-var">figuras'''</span></a></span><span> </span><span class="annot"><span class="annottext">[Ray]
</span><a href="#local-6989586621679079412"><span class="hs-identifier hs-var">rayos</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Escena.html#nRay"><span class="hs-identifier hs-var">nRay</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[[Ray]]
</span><a href="#local-6989586621679079420"><span class="hs-identifier hs-var">rayitos</span></a></span><span> </span><span class="hs-comment">-- Photon mapping</span><span>
</span><span id="line-162"></span><span>          </span><span class="hs-comment">-- a = map (\rayos -&gt; listRayToRGB luces figuras'' rayos gen' nRay) rayitos -- Path tracing</span><span>
</span><span id="line-163"></span><span>          </span><span>
</span><span id="line-164"></span><span>          </span><span id="local-6989586621679079409"><span class="annot"><span class="annottext">c :: [RGB]
</span><a href="#local-6989586621679079409"><span class="hs-identifier hs-var hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[RGB]] -&gt; [RGB]
</span><a href="Funciones.html#mediaLRGB"><span class="hs-identifier hs-var">mediaLRGB</span></a></span><span> </span><span class="annot"><span class="annottext">[[RGB]]
</span><a href="#local-6989586621679079413"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-165"></span><span>          </span><span id="local-6989586621679079407"><span class="annot"><span class="annottext">fin :: FilePath
</span><a href="#local-6989586621679079407"><span class="hs-identifier hs-var hs-var">fin</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(RGB -&gt; FilePath) -&gt; [RGB] -&gt; FilePath
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">RGB -&gt; FilePath
</span><a href="Files.html#rgbToString"><span class="hs-identifier hs-var">rgbToString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; [RGB] -&gt; [RGB]
</span><a href="Tone_map.html#gammaFunc"><span class="hs-identifier hs-var">gammaFunc</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="Escena.html#fmx"><span class="hs-identifier hs-var">fmx</span></a></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="Escena.html#gamma"><span class="hs-identifier hs-var">gamma</span></a></span><span> </span><span class="annot"><span class="annottext">[RGB]
</span><a href="#local-6989586621679079409"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-166"></span><span>      </span><span class="annot"><span class="annottext">FilePath -&gt; Int -&gt; Int -&gt; FilePath -&gt; IO ()
</span><a href="Files.html#writePPM"><span class="hs-identifier hs-var">writePPM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;a&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679079436"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;_&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679079435"><span class="hs-identifier hs-var">etapaY</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;_&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679079434"><span class="hs-identifier hs-var">etapaX</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;.ppm&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float -&gt; Int
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">round</span></span><span> </span><span class="annot"><span class="annottext">(Float -&gt; Int) -&gt; Float -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="Escena.html#pix"><span class="hs-identifier hs-var">pix</span></a></span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Float
</span><a href="Escena.html#aspectR"><span class="hs-identifier hs-var">aspectR</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float -&gt; Int
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">round</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="Escena.html#pix"><span class="hs-identifier hs-var">pix</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679079407"><span class="hs-identifier hs-var">fin</span></a></span><span>
</span><span id="line-167"></span><span>
</span><span id="line-168"></span><span>      </span><span id="local-6989586621679079402"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679079402"><span class="hs-identifier hs-var">end</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO Integer
</span><span class="hs-identifier hs-var">getCPUTime</span></span><span>
</span><span id="line-169"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679079391"><span class="annot"><span class="annottext">diff :: Float
</span><a href="#local-6989586621679079391"><span class="hs-identifier hs-var hs-var">diff</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Float
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679079402"><span class="hs-identifier hs-var">end</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679079427"><span class="hs-identifier hs-var">start</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">10</span></span><span class="annot"><span class="annottext">Float -&gt; Integer -&gt; Float
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">12</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span>
</span><span id="line-170"></span><span>      </span><span class="annot"><span class="annottext">FilePath -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO ()) -&gt; FilePath -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;Tiempo de procesado de la imagen: &quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Float -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679079391"><span class="hs-identifier hs-var">diff</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot; segundos&quot;</span></span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span>      </span><span class="annot"><span class="annottext">FilePath -&gt; IO ()
</span><span class="hs-identifier hs-var">traceEventIO</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;END&quot;</span></span><span>
</span><span id="line-173"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-174"></span><span>      </span><span id="local-6989586621679079388"><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679079388"><span class="hs-identifier hs-var">gen</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO StdGen
forall (m :: * -&gt; *). MonadIO m =&gt; m StdGen
</span><span class="hs-identifier hs-var">newStdGen</span></span><span>
</span><span id="line-175"></span><span>      </span><span id="local-6989586621679079387"><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679079387"><span class="hs-identifier hs-var">gen'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO StdGen
forall (m :: * -&gt; *). MonadIO m =&gt; m StdGen
</span><span class="hs-identifier hs-var">newStdGen</span></span><span>
</span><span id="line-176"></span><span>      </span><span id="local-6989586621679079386"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679079386"><span class="hs-identifier hs-var">start</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO Integer
</span><span class="hs-identifier hs-var">getCPUTime</span></span><span>
</span><span id="line-177"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679079383"><span class="annot"><span class="annottext">kdt :: DList Foton
</span><a href="#local-6989586621679079383"><span class="hs-identifier hs-var hs-var">kdt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">Float
-&gt; DList Foton
-&gt; Int
-&gt; Int
-&gt; Set Shape
-&gt; [Luz]
-&gt; StdGen
-&gt; Int
-&gt; DList Foton
</span><a href="PhotonMap.html#createPhoton"><span class="hs-identifier hs-var">createPhoton</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Luz] -&gt; Float
</span><a href="Funciones.html#sumFlLuz"><span class="hs-identifier hs-var">sumFlLuz</span></a></span><span> </span><span class="annot"><span class="annottext">[Luz]
</span><a href="Escena.html#luces"><span class="hs-identifier hs-var">luces</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Foton] -&gt; DList Foton
forall a. [a] -&gt; DList a
</span><span class="hs-identifier hs-var">DL.fromList</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float -&gt; Int
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">round</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="Escena.html#n"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set Shape
</span><a href="#local-6989586621679079443"><span class="hs-identifier hs-var">figuras'''</span></a></span><span> </span><span class="annot"><span class="annottext">[Luz]
</span><a href="Escena.html#luces"><span class="hs-identifier hs-var">luces</span></a></span><span> </span><span class="annot"><span class="annottext">StdGen
</span><a href="#local-6989586621679079387"><span class="hs-identifier hs-var">gen'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Escena.html#nRebotes"><span class="hs-identifier hs-var">nRebotes</span></a></span><span>
</span><span id="line-178"></span><span>      </span><span class="annot"><span class="annottext">Int -&gt; IO ()
forall a. Show a =&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">print</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; IO ()) -&gt; Int -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DList Foton -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">DList Foton
</span><a href="#local-6989586621679079383"><span class="hs-identifier hs-var">kdt</span></a></span><span>
</span><span id="line-179"></span><span>      </span><span id="local-6989586621679079379"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679079379"><span class="hs-identifier hs-var">end</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO Integer
</span><span class="hs-identifier hs-var">getCPUTime</span></span><span>
</span><span id="line-180"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679079370"><span class="annot"><span class="annottext">diff :: Float
</span><a href="#local-6989586621679079370"><span class="hs-identifier hs-var hs-var">diff</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Float
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679079379"><span class="hs-identifier hs-var">end</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679079386"><span class="hs-identifier hs-var">start</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Float -&gt; Float -&gt; Float
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Float
</span><span class="hs-number">10</span></span><span class="annot"><span class="annottext">Float -&gt; Integer -&gt; Float
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">12</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Float</span></span><span>
</span><span id="line-181"></span><span>      </span><span class="annot"><span class="annottext">FilePath -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO ()) -&gt; FilePath -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;Tiempo de creacion del kdt: &quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Float -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Float
</span><a href="#local-6989586621679079370"><span class="hs-identifier hs-var">diff</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot; segundos&quot;</span></span><span>
</span><span id="line-182"></span><span>      </span><span class="annot"><span class="annottext">FilePath -&gt; DList Foton -&gt; IO ()
forall a. Binary a =&gt; FilePath -&gt; DList a -&gt; IO ()
</span><a href="Files.html#writeObject"><span class="hs-identifier hs-var">writeObject</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;./kd.bin&quot;</span></span><span> </span><span class="annot"><span class="annottext">DList Foton
</span><a href="#local-6989586621679079383"><span class="hs-identifier hs-var">kdt</span></a></span><span>
</span><span id="line-183"></span><span>    </span><span class="annot"><span class="annottext">[Maybe Int]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-184"></span><span>      </span><span class="annot"><span class="annottext">FilePath -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;Please provide an integer as the first argument.&quot;</span></span><span>
</span><span id="line-185"></span><span>      </span><span class="annot"><span class="annottext">IO ()
forall a. IO a
</span><span class="hs-identifier hs-var">exitFailure</span></span><span>
</span><span id="line-186"></span></pre></body></html>